<extend name="@app:general/view/install/layout"/>
<block name="content">
    <div class="panel panel-default">
        <div class="panel-heading">服务器信息</div>
        <table class="table table-striped">
            <tr>
                <th style="width:150px;">参数</th>
                <th>值</th>
                <th></th>
            </tr>
            <tr class="{$ret['server']['os']['class']}">
                <td>服务器操作系统</td>
                <td>{$ret['server']['os']['value']}</td>
                <td>{$ret['server']['os']['remark']}</td>
            </tr>
            <tr class="{$ret['server']['sapi']['class']}">
                <td>Web服务器环境</td>
                <td>{$ret['server']['sapi']['value']}</td>
                <td>{$ret['server']['sapi']['remark']}</td>
            </tr>
            <tr class="{$ret['server']['php']['class']}">
                <td>PHP版本</td>
                <td>{$ret['server']['php']['value']}</td>
                <td>{$ret['server']['php']['remark']}</td>
            </tr>
            <tr class="{$ret['server']['upload']['class']}">
                <td>上传限制</td>
                <td>{$ret['server']['upload']['value']}</td>
                <td>{$ret['server']['upload']['remark']}</td>
            </tr>
        </table>
    </div>

    <div class="alert alert-info">PHP环境要求必须满足下列所有条件，否则系统或系统部份功能将无法使用。</div>
    <div class="panel panel-default">
        <div class="panel-heading">PHP环境要求</div>
        <table class="table table-striped">
            <tr>
                <th style="width:150px;">选项</th>
                <th style="width:250px;">要求</th>
                <th style="width:50px;">状态</th>
                <th>说明及帮助</th>
            </tr>
            <tr class="{$ret['php']['version']['class']}">
                <td>PHP版本</td>
                <td>大于等于7.1.0</td>
                <td>{$ret['php']['version']['value']}</td>
                <td>{$ret['php']['version']['remark']}</td>
            </tr>
            <tr class="{$ret['php']['pdo']['class']}">
                <td>MySQL</td>
                <td>支持(建议支持PDO)</td>
                <td>{$ret['php']['mysql']['value']}</td>
                <td rowspan="2">{$ret['php']['pdo']['remark']}</td>
            </tr>
            <tr class="{$ret['php']['pdo']['class']}">
                <td>PDO_MYSQL</td>
                <td>支持(强烈建议支持)</td>
                <td>{$ret['php']['pdo']['value']}</td>
            </tr>
            <tr class="{$ret['php']['curl']['class']}">
                <td>allow_url_fopen</td>
                <td>支持(建议支持cURL)</td>
                <td>{$ret['php']['fopen']['value']}</td>
                <td rowspan="2">{$ret['php']['curl']['remark']}</td>
            </tr>
            <tr class="{$ret['php']['curl']['class']}">
                <td>cURL</td>
                <td>支持(强烈建议支持)</td>
                <td>{$ret['php']['curl']['value']}</td>
            </tr>
            <tr class="{$ret['php']['gd']['class']}">
                <td>GD2</td>
                <td>支持</td>
                <td>{$ret['php']['gd']['value']}</td>
                <td>{$ret['php']['gd']['remark']}</td>
            </tr>
            <tr class="{$ret['php']['openssl']['class']}">
                <td>openssl</td>
                <td>支持</td>
                <td>{$ret['php']['openssl']['value']}</td>
                <td>{$ret['php']['openssl']['remark']}</td>
            </tr>
            <tr class="{$ret['php']['session']['class']}">
                <td>session.auto_start</td>
                <td>关闭</td>
                <td>{$ret['php']['session']['value']}</td>
                <td>{$ret['php']['session']['remark']}</td>
            </tr>
        </table>
    </div>

    <div class="alert alert-info">系统要求BusyPHP开源框架目录下的runtime和data/file必须可写, 才能使用BusyPHP开源框架的所有功能。</div>
    <div class="panel panel-default">
        <div class="panel-heading">目录权限监测</div>
        <table class="table table-striped">
            <tr>
                <th style="width:150px;">目录</th>
                <th style="width:250px;">要求</th>
                <th style="width:50px;">状态</th>
                <th>说明及帮助</th>
            </tr>
            <tr class="{$ret['write']['root']['class']}">
                <td>/</td>
                <td>public/uploads 目录可写</td>
                <td>{$ret['write']['root']['value']}</td>
                <td>{$ret['write']['root']['remark']}</td>
            </tr>
            <tr class="{$ret['write']['install']['class']}">
                <td>/</td>
                <td>public/install 目录可写</td>
                <td>{$ret['write']['install']['value']}</td>
                <td>{$ret['write']['install']['remark']}</td>
            </tr>
            <tr class="{$ret['write']['data']['class']}">
                <td>/</td>
                <td>runtime 目录可写</td>
                <td>{$ret['write']['data']['value']}</td>
                <td>{$ret['write']['data']['remark']}</td>
            </tr>
            <tr class="{$ret['write']['database']['class']}">
                <td>/</td>
                <td>.env 文件可写</td>
                <td>{$ret['write']['database']['value']}</td>
                <td>{$ret['write']['database']['remark']}</td>
            </tr>
        </table>
    </div>
    <form class="form-inline" role="form" action="{:url('general/install/db')}" method="post">
        <ul class="pager">
            <li class="previous">
                <a href="javascript:void(0)" onclick="$('#do').val('back');$('form')[0].submit();">
                    <span class="glyphicon glyphicon-chevron-left"></span>
                    返回
                </a>
            </li>

            <eq name="ret.continue" value="1">
                <li class="previous">
                    <a href="javascript:void(0)" onclick="$('#do').val('continue');$('form')[0].submit();">
                        继续
                        <span class="glyphicon glyphicon-chevron-right"></span>
                    </a>
                </li>
                <else/>
                <li class="previous disabled"><a href="javascript:;">请先解决环境问题后继续</a></li>
            </eq>
        </ul>
    </form>
</block>