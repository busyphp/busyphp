<extend name="@admin:layout"/>
<block name="content">
    <div class="panel panel-default">
        <div class="panel-heading">
            <h3 class="panel-title">{$system.page_title}</h3>
        </div>
        <div class="panel-body no-padding-bottom">
            <script type="text/x-markdown" id="markdown">
### 开始

本组件属于内置组件，无需引用即可使用

### 使用

通过在标签上加上自定义属性 `data-toggle="busy-modal"` 来触发

```html
<a data-toggle="busy-modal">打开对话框</a>
```

### 注意

- `close()` 和 `hide()` 均会关闭模态框，不同的是：使用 `close()` 方法不会触发 `onCancel` 事件
- 内容与对象交互，一般在根元素指定一个唯一的id，使用 `$.fn.closetGetModal()` 来获取当前模态框对象，支持`:modal_id`变量由系统生成一个唯一的ID

**交互示例**

```
// 模态框HTML
<div id="testModal">
    ...模态框的内容
    
    // 加上 data-dismiss="modal" 为modal绑定关闭按钮
    <a data-dismiss="modal">关闭</a>
    
    // 加上 data-primary="modal" 为modal绑定确定按钮
    <a data-primary="modal">确定</a>
    
    // 加上 data-click="false" 点击确定按钮不会触发onOk事件
    <a data-primary="modal" data-click="false">确定</a>
</div>

// 模态框脚本
<\script id=":modal_id">
var modal = $('#:modal_id').closetGetModal()
modal.close()
<\/script>

// 更多请参考 完全自定义对话框 示例
```

### 标签属性

| 属性:240 | 类型:100 | 必须: 100 | 默认值: 100 | 描述 |
| - | :-: | :--: | :-: | - |
| 基本:title |  |  |  |  |
| data-type | string | 否 | `form` | 对话框类型，支持以下类型：<br />`form`：表单<br />`page`：页面 |
| data-fade | boolean | 否 | `true` | 是否关闭对话框动画 |
| data-move | boolean | 否 | `false` | 是否支持拖拽移动 |
| data-backdrop | boolean,string | 否 | `true` | 是否显示背景遮罩，指定`static`则点击背景遮罩不会关闭对话框 |
| data-size | string | 否 | - | 对话框大小，留空则默认大小，支持以下类型：<br />`sm`：小对话框<br />`lg`：大对话框<br />`xl`：超大对话框<br />`百分比，带单位的宽度` |
| data-title | boolean,string | 否 | - | 设置对话框标题，`false`则不显示对话框标题栏，远端加载可以输出`<title>`标签指定标题 |
| data-footer | boolean | 否 | `true` | 设置是否显示footer栏 |
| data-footer-align | string | 否 | `right` | 设置footer按钮对齐方式，支持`left`,`center`,`right` |
| data-content | string | 否 | - | 设置对话框内容的jQuery选择器 |
| data-url | string | 否 | - | 设置远程加载的页面，设置后`content`无效，`a`节点支持`href`指定 |
| data-class-name | string | 否 | - | 自定义对话框css类名 |
| data-padding | string | 否 | - | 设置内容区域的填充值 |
| data-border-top | boolean | 否 | `true` | 设置是否显示上边框 |
| data-border-bottom | boolean | 否 | `true` | 设置是否显示下边框 |
| data-height | number | 否 | - | 设置对话框内容高度，超出后将显示滚动条 |
| data-buttons | string | 否 | - | 自定义按钮`window全局变量名称` |
| data-zindex | number | 否 | `auto` | 定义modal层级 |
| 数据选择:title |  |  |  |  |
| data-select | string | 否 | - | 定义选择modal内的数据，可选：`baTable` - 选择baTable表格的选项 |
| data-select-tip | string | 否 | - | 未选择时的提示 |
| data-select-min | number | 否 | `1` | 至少选择多少项 |
| data-select-min-tip | string | 否 | - | 至少选择多少项提示 |
| data-select-max | number | 否 | `0` | 最多允许选择多少项 |
| data-select-max-tip | string | 否 | `0` | 最多允许选择多少项提示 |
| 确认按钮:title |  |  |  |  |
| data-ok | boolean,string | 否 | `确定` | 设置确认按钮的文本内容，`false`则不显示 |
| data-ok-skin | string | 否 | `btn-primary` | 确定按钮css类名 |
| data-ok-icon | string | 否 | - | 确定按钮图标css类名称，如：`fa fa-check` |
| data-on-ok | string | 否 | - | 确定按钮点击事件，不指定的情况下：<br /> `data-type=form` 执行 `submit()`<br /> `data-type=page` 为 `close()` |
| 取消按钮:title |  |  |  |  |
| data-cancel | boolean,string | 否 | `取消` | 设置确认按钮的文本内容，`false`则不显示 |
| data-cancel-skin | string | 否 | `btn-default` | 取消按钮css类名 |
| data-cancel-icon | string | 否 | - | 取消按钮图标css类名称，如：`fa fa-close` |
| data-on-cancel | string | 否 | - | 取消按钮点击事件，不指定的情况下执行 `hide()` |
| `data-type="form"` 自动表单，扩展自 [自动表单]({:url('form')}) 组件，请使用 `data-form-*` 进行配置:title |  |  |  |  |
| data-form-on-success | string | 否 | `@modal.close` | 表单提交成功操作回调，支持`原组件`语法及`本组件`语法如下：<br />`@modal.close`：关闭模态框<br />`@modal.reload`：重载模态框(针对远程页面有效)<br />`@table.reload`：关闭模态框，并刷新表格(针对 `data-toggle="busy-modal"` 在[数据表格]({:url('table')})内) |
| `data-type="form"` 表单验证，扩展自 [自动验证]({:url('form_verify')}) 组件，请使用 `data-validate-*` 进行验证配置 :title |  |  |  |  |

### 自定义按钮结构
```js
var buttons = [
    {
        align: 'left|right', // 按钮位置
        classes: 'btn-danger', // 按钮样式
        text: '<i class="fa fa-check"></i> 按钮文本', // 按钮文本
        events: function(api) { // 直接指定回调函数则默认为按钮绑定点击事件
            $(this) // 当前按钮
        }
    },
    {
        classes: 'btn-danger', // 按钮样式
        text: '<i class="fa fa-check"></i> 按钮文本', // 按钮文本
        events: { // 可以绑定各种事件
            'click' : function(api) {
                $(this) // 当前按钮
            },
            'hover' : function(api) {
                $(this) // 当前按钮
            },
        }
    },
];
```

### 使用示例

#### 基本示例
```demo:实例
#demo1
```

#### 加载远程表单
```demo:实例
#demo2
```

#### 加载远程页面(选择)
```demo:实例
#demo3
```

#### 完全自定义对话框
```demo:实例
#demo6
```

#### 静态内容转表单
```demo:实例
#demo4
```

#### 自定义按钮
```demo:实例
#demo5
```
            </script>
        </div>
    </div>

    <template class="hide" id="demo1">
        <a class="btn btn-primary" data-toggle="busy-modal" data-type="page" data-content="#demo1_template" data-move="true">打开模态框</a>
        <script type="text/html" id="demo1_template">
            <div>这是对话框内容，通过<code>data-content="#demo1_template"</code>实现</div>
        </script>
    </template>

    <template class="hide" id="demo2">
        <a class="btn btn-primary" data-toggle="busy-modal" data-url="{:url('?action=demo2')}">打开表单</a>
    </template>

    <template class="hide" id="demo3">
        <a class="btn btn-primary"
           data-toggle="busy-modal"
           data-padding="0"
           data-border-top="false"
           data-border-bottom="false"
           data-type="page"
           data-on-ok="getSelects"
           data-select="baTable"
           data-select-min="2"
           data-select-max="2"
           data-url="{:url('?action=demo3')}">打开页面</a>
        <script>
            busyAdmin.data.getSelects  = function (modal, result){
                var ids = [];
                result.map(function (item) {
                    ids.push(item.id)
                });
                console.log(result);
                busyAdmin.dialog.alert('已选择：' + ids.join(','))
            }
        </script>
    </template>

    <template class="hide" id="demo4">
        <a class="btn btn-primary"
           data-toggle="busy-modal"
           data-content="#demo4_template">打开静态表单</a>
        <script type="text/html" id="demo4_template">
            <div class="form-group">
                <div class="input-group">
                    <div class="input-group-addon">账号</div>
                    <input type="text" class="form-control" required placeholder="请输入账号"/>
                    <div class="input-group-btn">
                        <a class="btn btn-secondary"
                           data-toggle="busy-modal"
                           data-size="sm"
                           data-content="#demo4_template">继续打开</a>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="input-group">
                    <div class="input-group-addon">密码</div>
                    <input type="password" class="form-control" placeholder="请输入密码"/>
                </div>
            </div>
            <div class="form-group no-margin-bottom">
                <input type="checkbox" title="记住密码" data-toggle="busy-checkbox"/>
            </div>
        </script>
    </template>

    <template class="hide" id="demo5">
        <a class="btn btn-primary"
           data-toggle="busy-modal"
           data-ok="false"
           data-cancel="false"
           data-buttons="buttons"
           data-footer-align="center"
           data-content="<div>通过自定义<code>data-buttons</code>来扩展按钮</div>">打开模态框</a>
        <script>
            busyAdmin.data.buttons = [
                {
                    align   : 'left',
                    classes : 'btn-danger',
                    text    : '按钮1',
                    events  : function (api) {
                        busyAdmin.dialog.toast('点击了按钮：' + $(this).text());
                    }
                },
                {
                    classes : 'btn-warning',
                    text    : '按钮2',
                    events  : function (api) {
                        busyAdmin.dialog.toast('点击了按钮：' + $(this).text());
                    }
                },
                {
                    classes : 'btn-info',
                    text    : '按钮3',
                    events  : function (api) {
                        busyAdmin.dialog.toast('点击了按钮：' + $(this).text());
                        api.hide();
                    }
                }
            ];
        </script>
    </template>

    <template class="hide" id="demo6">
        <p>页面内容中包含 <code>.modal-content</code> 即可完全自定义</p>
        
        <a class="btn btn-primary"
           id="demo6Modal"
           href="aaa"
           data-toggle="busy-modal"
           data-type="page"
           data-url="{:url('?action=demo4')}">打开页面</a>
    </template>
</block>