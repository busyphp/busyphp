<extend name="@admin:layout"/>
<block name="content">
    <div class="panel panel-default">
        <include file="system_manager/nav"/>
        <div class="panel-body">
            <div data-toggle="busy-table"
                 data-pagination="false"
                 data-toolbar="@"
                 data-bordered="true"
                 data-show-columns="true"
                 data-url="__URL__">

                <template data-template="toolbar" class="hide">
                    <div id="tableToolbar">
                        <a class="btn btn-success"
                           data-toggle="busy-modal"
                           data-url="{:url('file_class_add')}"
                           data-size="lg"
                           data-form-on-success="@table.reload|@modal.close">
                            <i class="fa fa-plus"></i>
                            添加
                        </a>
                        <a class="btn btn-danger"
                           data-url="{:url('file_class_delete')}"
                           data-confirm="确认要删除选中的%s个分类吗？"
                           data-checked="true"
                           data-disabled="true"
                           data-method="post"
                           data-on-success="@table.reload">
                            <i class="fa fa-trash"></i>
                            删除
                        </a>
                        <a class="btn btn-default"
                           data-url="{:url('file_class_sort')}"
                           data-confirm="确认要排序吗？"
                           data-method="post"
                           data-field="id,sort"
                           data-on-success="@table.reload">
                            <i class="fa fa-sort"></i>
                            排序
                        </a>
                    </div>
                </template>
                
                <table class="table table-hover table-striped">
                    <thead>
                        <tr>
                            <th data-checkbox="true" data-fixed="true"></th>

                            <th class="text-center"
                                width="60"
                                data-field="sort"
                                data-title="排序"
                                data-formatter="@">
                                <script type="text/html">
                                    <input type="text" class="form-control input-xs text-center" value="{{value}}" data-bind="int"/>
                                </script>
                            </th>

                            <th width="60"
                                class="text-center"
                                data-field="id"
                                data-title="ID"
                                data-show-overflow="true"
                                data-searchable="false"></th>
                            
                            <th data-field="name"
                                data-title="分类名称"
                                data-show-overflow="true"
                                width="100"></th>
                            
                            <th data-field="var"
                                data-title="分类标识"
                                width="100"
                                data-show-overflow="true"
                                data-formatter="@">
                                <script type="text/html">
                                    <span class="badge badge-primary">{{value}}</span>
                                </script>
                            </th>
                            
                            <th data-field="extensions"
                                data-min-width="300"
                                data-title="格式限制"
                                data-show-overflow="true"
                                data-formatter="@">
                                <script type="text/html">
                                    <ba-if value="value">
                                        {{value}}
                                        <ba-else></ba-else>
                                        <kbd>继承</kbd>
                                    </ba-if>
                                </script>
                            </th>

                            <th data-field="mimetype"
                                data-title="MimeType限制"
                                width="150"
                                data-show-overflow="true">
                            </th>

                            <th data-field="max_size"
                                data-title="大小限制"
                                width="100"
                                data-align="right"
                                data-show-overflow="true"
                                data-formatter="@">
                                <script type="text/html">
                                    <ba-if value="value > 0">
                                        {{value}}MB
                                        <ba-else></ba-else>
                                        <kbd>继承</kbd>
                                    </ba-if>
                                </script>
                            </th>

                            <th data-title="操作"
                                data-align="center"
                                data-formatter="@"
                                data-fixed-right="true"
                                width="80">
                                <script type="text/html">
                                    <a class="btn btn-success btn-xs"
                                       data-toggle="busy-modal"
                                       data-ok="修改"
                                       data-url="{:url('file_class_edit?id=')}{{item.id}}"
                                       data-size="lg"
                                       data-form-on-success="@table.reload|@modal.close">
                                        <i class="fa fa-pencil"></i>
                                    </a>

                                    <a class="btn btn-danger btn-xs"
                                       href="{:url('file_class_delete?id=')}{{item.id}}"
                                       data-toggle="busy-request"
                                       data-confirm="确认要删除该分类吗？"
                                       data-on-success="@table.reload"><i class="fa fa-trash"></i></a>
                                </script>
                            </th>
                        </tr>
                    </thead>
                </table>
            </div>
        </div>
    </div>
</block>