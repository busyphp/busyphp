"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(){}window.console||(window.console={log:e,error:e,warn:e,assert:e,clear:e,count:e,group:e,groupCollapsed:e,groupEnd:e,info:e,table:e,time:e,timeEnd:e,trace:e}),Object.keys||(Object.keys=function(e){if(e!==Object(e))throw new TypeError("Object.keys called on a non-object");var t,a=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&a.push(t);return a}),Array.prototype.map||(Array.prototype.map=function(e,t){var a,i,n;if(null==this)throw new TypeError("this is null or not defined");var r,o=new Object(this),s=o>>>0;if("[object Function]"!=Object.prototype.toString.call(e))throw new TypeError(e+"is not a function");for(t&&(a=t),i=new Array(s),n=0;n<s;)n in o&&(r=o[n],r=e.call(a,r,n,o),i[n]=r),n++;return i}),Array.prototype.del||(Array.prototype.del=function(e){return e<0?this:this.slice(0,e).concat(this.slice(e+1,this.length))});var s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function l(e){this.message=e}(l.prototype=new Error).name="InvalidCharacterError",window.btoa||(window.btoa=function(e){for(var t,a,i=String(e),n=0,r=s,o="";i.charAt(0|n)||(r="=",n%1);o+=r.charAt(63&t>>8-n%1*8)){if(255<(a=i.charCodeAt(n+=.75)))throw new l("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");t=t<<8|a}return o}),window.atob||(window.atob=function(e){var t=String(e).replace(/[=]+$/,"");if(t.length%4==1)throw new l("'atob' failed: The string to be decoded is not correctly encoded.");for(var a,i,n=0,r=0,o="";i=t.charAt(r++);~i&&(a=n%4?64*a+i:i,n++%4)&&(o+=String.fromCharCode(255&a>>(-2*n&6))))i=s.indexOf(i);return o})}(),function(e){var l,c=!1;function t(){var e=this;e.lib={},e.e={},e.plugins={},e.linkClickIgnore=[],e.formSubmitIgnore=[],e.autoInitList=[],e.helper=null,e.app=null,e.route=null,e.request=null,e.response=null,e.dialog=null,e.require=requirejs,e.requireQueue=function(e,r){!function t(a,i){var e,n;a.length?("object"===(void 0===(e=a.shift())?"undefined":_typeof(e))&&(n=e.exports,e=e.module),require([e],function(e){n&&("function"==typeof n?n(e):window[n]=e),i.push(e),t(a,i)})):r.apply(null,i)}(e,[])},e.define=define,e.locale={},e.config={root:"/",moduleRoot:"/",version:"1.0.0",configs:{}},e.data={},e.sugars={},e.requireShims={},e.requirePaths={},e.defaultZIndex=1e4}t.prototype={autoInit:function(e,t,a){this.autoInitList.push({name:e,selector:t,callback:a})},regSugar:function(e,t){this.sugars[e]=t},dispatchSugar:function(r,e,o,s,l){if("string"==typeof e&&e){var c=this,d="",u=/\((.*?)\)/gm;return e.split("|@").map(function(e){var t,a,i,n;(e=e.trim())&&(0===e.indexOf("@")&&(e=e.substring(1)),0!==e.indexOf(":")?((e.match(u)||[]).map(function(e){t=$.baStrToVar(e.slice(1).slice(0,-1))}),n=(e=e.replace(u,"")).indexOf("."),a=e,0<n&&(a=e.substring(0,n),i=e.substring(n+1)||void 0),n=c.sugars[a],a&&"function"==typeof n&&n.call(r,i,t,{api:o,args:s,event:l})):d=e.substring(1))}),d}},ee:function(e,t){return"ba:"+t+"-"+e.replace(/([A-Z])/g,"_$1").toLowerCase().replace(/_/g,"-").toLowerCase()},mod:function(e,t,a){return this.lib[e]=e,this.requirePaths[e]=t,a&&(this.requireShims[e]=a),this},init:function(e){var i=this;i.config=e||{},r=busyAdmin,e=r.moduleRoot(),r.root(),l.mod("jquery","jquery/jquery.min").mod("pace","pace/pace.min").mod("bootstrap","bootstrap/js/bootstrap.min").mod("layer","layer/layer.min",["css!"+e+"layer/theme/default/layer"]).mod("moment","moment/moment.min").mod("marked","marked/marked.min").mod("clipboard","clipboard/clipboard.min").mod("md5","md5/md5.min").mod("sticky","sticky/jquery.sticky.min").mod("jqueryUi","jquery-ui/jquery-ui.min").mod("ELEMENT","element-ui/index",["css!element-ui/index",l.config.debug?"vue/vue":"vue/vue.min"]).mod("toastr","toastr/toastr.min",["css!"+e+"toastr/toastr.min"]).mod("highlight","hijs/highlight.min",{deps:["css!hijs/css.min"],exports:"hljs"}).mod("colorPicker","bootstrap-colorpicker/js/bootstrap-colorpicker.min",["css!"+e+"bootstrap-colorpicker/css/bootstrap-colorpicker.min"]).mod("tree","tree/jstree.min",["css!"+e+"tree/themes/default/style.min"]).mod("uploadConfig",r.getConfig("upload",{}).configUrl).mod("webUploader","webuploader/webuploader.min",["css!"+e+"webuploader/webuploader"]).mod("videojs","video-js/video.min",["css!video-js/video.min"]).mod("APlayer","aplayer/APlayer.min",["css!"+e+"aplayer/APlayer.min"]).mod("hls","hls/hls.min").mod("imageViewer","image-viewer/viewer.min",["css!image-viewer/viewer.min"]).mod("sortable","sortable/sortable.min").mod("dragtable","dragtable/jquery-dragtable.min",["css!"+e+"dragtable/dragtable.min","jqueryUi"]).mod("bootstrapTable","bootstrap-table/bootstrap-table.min",["css!bootstrap-table/bootstrap-table.min"]).mod("bootstrapTableReorderColumns","bootstrap-table/reorder-columns/bootstrap-table-reorder-columns.min",["dragtable"]).mod("bootstrapTableReorderRows","bootstrap-table/reorder-rows/bootstrap-table-reorder-rows.min",["css!bootstrap-table/reorder-rows/bootstrap-table-reorder-rows.min","bootstrap-table/reorder-rows/jquery.tablednd.min"]).mod("bootstrapTableStickyHeader","bootstrap-table/sticky-header/bootstrap-table-sticky-header.min",["css!bootstrap-table/sticky-header/bootstrap-table-sticky-header.min"]).mod("bootstrapTablePrint","bootstrap-table/print/bootstrap-table-print.min").mod("bootstrapTableFixedColumns","bootstrap-table/fixed-columns/bootstrap-table-fixed-columns.min",["css!bootstrap-table/fixed-columns/bootstrap-table-fixed-columns.min"]).mod("bootstrapTableFilterControl","bootstrap-table/filter-control/bootstrap-table-filter-control.min",["css!bootstrap-table/filter-control/bootstrap-table-filter-control.min"]).mod("bootstrapTableExport","bootstrap-table/export/bootstrap-table-export.min",["bootstrap-table/export/tableExport.min"]).mod("xlsx","xlsx/xlsx.min").mod("ueditor","ueditor/ueditor.all.min",[r.getConfig("editor",{}).ueConfigUrl]).mod("zeroClipboard","ueditor/third-party/zeroclipboard/ZeroClipboard.min").mod("ckEditor5Classic","ckeditor/ckeditor5-build-classic/ckeditor").mod("select2","select2/select2.min",["css!"+e+"select2/select2.min","css!"+e+"select2/select2-ba.min"]).mod("pinyin","pinyin/js").mod("autocomplete","autocomplete/auto-complete.min",["css!"+e+"autocomplete/auto-complete.min"]).mod("artTemplate","art-template/template-web").mod("treeTable","tree-table/jquery.treetable.min").mod("validate","validate/jquery.validate.min").mod("socketio","socketio/socket.io.min").mod("gwm","gwm/gwm").mod("sparkMd5","spark-md5/spark-md5.min").mod("cryptoJs","crypto-js/crypto-js.min").mod("fxParser","fxparser/fxparser.min").mod("echarts","echarts/echarts.min").mod("echartsGl","echarts-gl/echarts-gl.min").mod("ionRangeSlider","ion-range-slider/ion.rangeSlider.min",["css!ion-range-slider/ion.rangeSlider.min"]).mod("bootstrapStarRatingCore","bootstrap-star-rating/js/star-rating.min",["css!bootstrap-star-rating/css/star-rating.min"]).mod("bootstrapStarRating","bootstrap-star-rating/themes/krajee-svg/theme.min",["bootstrapStarRatingCore","css!bootstrap-star-rating/themes/krajee-svg/theme.min"]).mod("fullcalendar","fullcalendar/locales-all.min",[e+"fullcalendar/main.min.js","css!"+e+"fullcalendar/main.min"]).mod("print","print/print.min",["css!"+e+"print/print.min"]).mod("html2canvas","html2canvas/html2canvas.min").mod("jspdf","pdf/jspdf.umd.min").mod("json","require/json.min").mod("depend","require/depend.min").mod("font","require/font.min").mod("goog","require/goog.min").mod("i18n","require/i18n.min").mod("image","require/image.min").mod("mdown","require/mdown.min").mod("noext","require/noext.min").mod("propertyParser","require/propertyParser.min").mod("text","require/text.min"),requirejs.config({baseUrl:e,urlArgs:"v="+r.config.version,waitSeconds:0,map:{"*":{css:"require/css"}},paths:l.requirePaths,shim:l.requireShims});for(var t=["modal","audio","audioViewer","autocomplete","catalog","changeVerify","checkboxRadio","checkedAll","colorPicker","copy","datePicker","editor","filePicker","form","validate","high","iconPicker","imageViewer","markdown","request","searchBar","selectPicker","shuttle","table","tree","upload","video","videoViewer","dialog","random","linkagePicker","rangeSlider","rate","calendar","print","consoleLog","template","tabs","vue","elementUi","appNotice","appWatermark"],a=[],n=0;n<t.length;n++)a.push("./ba/plug/"+t[n]);var r=i.config.requires||[];"string"==typeof r&&r?a.push(r):r.forEach(function(e){a.push(e)});var o=["pace","jquery","bootstrap"];["helper","route","request","response"].forEach(function(e){o.push("./ba/app/"+e)});var s=[];return i.config.vue&&(s.push(i.lib.vue),i.config.elementUi&&s.push(i.lib.ELEMENT)),s.push("./ba/app"),i.requireQueue(o,function(){c||(c=!0,busyAdmin.helper.extends($.fn.button.Constructor.prototype,{toggle:function(){var e=!0,t=this.$element.closest('[data-toggle="buttons"]'),a=t.data(),i=a.checkedClass||"btn-primary",a=a.defaultClass||"btn-default";t.length?(t=this.$element.find("input"),this.$element.hasClass("disabled")||(t.prop("disabled")&&this.$element.addClass("disabled").prop("disabled",!0),"radio"==t.prop("type")?(t.prop("checked")&&(e=!1),this.$element.siblings().removeClass(i).addClass(a),this.$element.removeClass(a).addClass(i)):"checkbox"==t.prop("type")&&(t.prop("checked")!==this.$element.hasClass(i)&&(e=!1),this.$element.toggleClass(i),this.$element.hasClass(i)?this.$element.removeClass(a).addClass(i):this.$element.removeClass(i).addClass(a)),t.prop("checked",this.$element.hasClass(i)),e&&t.baTriggerEvent("change"))):(this.$element.attr("aria-pressed",!this.$element.hasClass(i)),this.$element.toggleClass(i))}})),function(){l.lib.vue="vue",l.lib.elementUi=l.lib.ELEMENT;var a=l.helper,i={};["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","beforeDestroy","destroyed"].forEach(function(e){var t=l.ee(e,"vue");l.e[a.camel("vue_"+e)]=t,i[e]=function(){a.execCallback(this,null,this,[],$(document),$.Event(t,{vue:this,$vue:$(this.$el)}))}}),l.define(l.lib.vue,[l.config.debug?"vue/vue":"vue/vue.min"],function(e){return e.mixin(i),window.Vue=e,window._BaVue=e})}(),i.require(a,function(){i.requireQueue(s,function(e,t,a){i.config.elementUi&&(window._BaElementUI=t,window._BaVue.use(t)),i.app.start()})})}),this},root:function(){return this.config.root||"/"},moduleRoot:function(){return this.config.moduleRoot||"/"},skinRoot:function(){return this.config.skinRoot||"/"},cssRoot:function(){return this.config.cssRoot||"/"},jsRoot:function(){return this.config.jsRoot||"/"},imagesRoot:function(){return this.config.imagesRoot||"/"},getConfig:function(e,t){return this.config.configs[e]||t},ready:function(e,t){var a=2<arguments.length&&void 0!==arguments[2]&&arguments[2],i={};"function"==typeof e?i.callback=e:("string"==typeof e&&(e=[e]),i.callback=t,i.modules=e||[],i.queue=a);function n(e){e.modules?e.queue?r.requireQueue(e.modules,e.callback):r.require(e.modules,e.callback):e.callback()}var r=this;if(r.readyed)n(i);else{if(r._readyCallbacks=r._readyCallbacks||[],r._readyCallbacks.push(i),void 0!==r._readyIntervalId)return this;r._readyIntervalId=setInterval(function(){if(r.app&&r.app.isInit){r.readyed=!0,clearInterval(r._readyIntervalId),delete r._readyIntervalId;for(var e=0;e<r._readyCallbacks.length;e++)n(r._readyCallbacks[e]);r._readyCallbacks=[]}},1)}return this},zIndex:function(e){return this.defaultZIndex+=e||1,this.defaultZIndex}},e.busyAdmin=l=new t,e.ba=l,define("busyAdmin",function(){return l}),busyAdmin.autoInit("bsToolTip",'[data-toggle="tooltip"],[busy-tooltip]',function(){this.tooltip()}),busyAdmin.autoInit("bsPopover",'[data-toggle="popover"],[busy-popover]',function(){this.popover()}),busyAdmin.autoInit("bsButton",'[data-toggle^="button"]',function(){this.find(":checked,:disabled").each(function(){$(this).trigger({type:"click",target:this})})});var a="app",e="route";l.e={appReady:l.ee("ready",a),appBeforeDestroy:l.ee("before-destroy",a),appReadies:l.ee("readies",a),appReqBefore:l.ee("req-before",a),appReqComplete:l.ee("req-complete",a),appReqError:l.ee("req-error",a),appReqSuccess:l.ee("req-success",a),appRenderBefore:l.ee("render-before",a),appRenderSuccess:l.ee("render-success",a),appComplete:l.ee("complete",a),appPluginReady:l.ee("plugin-ready",a),appLoginSucceed:l.ee("login-succeed",a),appLoginOuted:l.ee("login-outed",a),appClearCache:l.ee("clear-cache",a),routeBeforeLeave:l.ee("before-leave",e),routePopState:l.ee("pop-state",e),routeNoDispatch:l.ee("no-dispatch",e)}}(window),define("./ba/app",["busyAdmin","jquery","bootstrap"],function(p,f){"use strict";var h=p.helper;function a(e,t){return e.find('[data-busy-id="'+t+'"]')}function m(e,t){return e.filter('[data-busy-id="'+t+'"]').add(e.find('[data-busy-id="'+t+'"]'))}function g(e,t){return e.filter(t).add(e.find(t))}function v(e){return f.parseHTML(e,document,true)}var i=function e(){var t=this;t.$doc=f(document);t.$win=f(window);t.inIframe=window.self!=window.top};i.prototype={start:function e(){var t=this;t.options=f.extend({},i.DEFAULTS,p.getConfig("app")||{});t._initResponse();t._initSinglePage();t.$doc.ready(f.proxy(t.init,t))},init:function e(){var i=this;if(i.isInit)return;i.isInit=true;i.$head=f(document.head);i.$body=f(document.body);i.$app=a(i.$body,"app");i._initApp();h.onDomChange(document,function(){p.autoInitList.map(function(t){var a="ba-"+t.name+"AutoInitialized";f(t.selector).each(function(){var e=f(this);if(e.data(a))return;t.callback.call(e.data(a,true))})})},true);document.addEventListener("error",function(e){if(e.target.tagName==="IMG"){var t=f(e.target);var a=t.data();if(a.baImagePlaceholderInitialized)return;t.data("baImagePlaceholderInitialized",true);if(a.placeholder)e.target.src=a.placeholder;else if(a.avatar)e.target.src=i.options.avatarPlaceholder;else e.target.src=i.options.imagePlaceholder}},true);window.addEventListener("beforeunload",function(e){i.trigger(p.e.appBeforeDestroy,[false,e])},false);i._vueMaps={};i.$doc.on(p.e.vueMounted,function(e){i._vueMaps[e.vue._uid]=e.vue});Pace.on("start",function(){if(!i.isFrame)return;clearTimeout(i._paceStartTimer);i._paceStartTimer=setTimeout(function(){i.$barRefreshIcon.addClass("ba-anim-rotate")})});Pace.on("done",function(){if(!i.isFrame)return;clearTimeout(i._paceStopTimer);i._paceStopTimer=setTimeout(function(){i.$barRefreshIcon.removeClass("ba-anim-rotate")})});i.$win.on("resize",function(){clearTimeout(i._resizeTimer);i._resizeTimer=setTimeout(function(){i._computeMenu()},50)})},closeSideNav:function e(){var t=this;if(!t.isMobileSize())return;t.$frame.removeClass("ba-nav-open");t._changeBarControlIcon(true);t.triggerResize()},openSideNav:function e(){var t=this;if(!t.isMobileSize())return;t.$frame.addClass("ba-nav-open");t._changeBarControlIcon(false);t.scrollToNav();t.triggerResize()},setToMiniNav:function e(t){var a=this;if(a.isMobileSize()||a.isMiniNav())return;a.$app.addClass("ba-mini-nav");a.$left.removeClass("ba-left-open");a._changeBarControlIcon(true);a.triggerResize();a.$left.baOnTransEnd(true,function(){a.triggerResize()});clearTimeout(a._onceMiniNavTimer);a._onceMiniNavTimer=setTimeout(function(){a._onceMiniNav=t},1e3)},setToDefaultNav:function e(){var t=this;if(t.isMobileSize()||!t.isMiniNav())return;t.$app.removeClass("ba-mini-nav");t.$left.removeClass("ba-left-open");t._changeBarControlIcon(false);t.scrollToNav();t.triggerResize();t.$left.baOnTransEnd(true,function(){t.triggerResize()})},triggerResize:function e(){this.$win&&this.$win.trigger("resize")},_changeBarControlIcon:function e(t){var a=this;if(t)a.$barControlIcon.removeClass("bicon-menu-close").addClass("bicon-menu-open");else a.$barControlIcon.removeClass("bicon-menu-open").addClass("bicon-menu-close")},isMobileSize:function e(){return this.$win&&this.$win.width()<=767},_saveNavState:function e(t,a){var i=this;if(i.options.navSingleHold)return;var n=i._getNavState();n[t]=a;localStorage.setItem(this.cacheKey("app.nav"),JSON.stringify(n))},_getNavState:function e(){return JSON.parse(localStorage.getItem(this.cacheKey("app.nav"))||"{}")},_saveScrollState:function e(t){var a=JSON.parse(sessionStorage.getItem("ba.app.scroll")||"{}")||{};var i=Object.keys(a);while(i.length>this.options.scrollCacheLength)delete a[i.shift()];a[document.URL]=t;sessionStorage.setItem(this.cacheKey("app.scroll"),JSON.stringify(a))},_getScrollState:function e(){var t=JSON.parse(sessionStorage.getItem(this.cacheKey("app.scroll"))||"{}")||{};return t[document.URL]||0},_initSinglePage:function e(){var l=this;l.$doc.on(p.e.appBeforeDestroy,function(){l._saveScrollState(l.$win.scrollTop())}).on(p.e.routeBeforeLeave,function(){if(l._byClick){l._saveScrollState(l.$win.scrollTop());f("body,html").animate({scrollTop:0})}}).on(p.e.appComplete,function(e){if(l._byClick){l._byClick=false;return}var t=l._getScrollState();var a=window.location.hash;if(a){var i=decodeURIComponent(a.slice(1));var n=document.getElementById(i)||document.getElementsByName(i)[0];if(n)t=f(n).offset().top}if(typeof t=="number"&&t>0)l.$win.scrollTop(t)}).on(p.e.appRenderBefore,function(e){var t=[];for(var a in l._vueMaps){var i=l._vueMaps[a];if(i._isBeingDestroyed||i._isDestroyed){t.push(a);return}i.$destroy();t.push(a)}t.forEach(function(e){delete l._vueMaps[e]})}).on("submit","form:not([data-toggle])",function(e){var t=f(this);var a=(t.attr("method")||"").trim().toLowerCase();var i=(t.attr("action")||"").trim();if(a==="post")return true;var n=p.formSubmitIgnore||[];for(var r=0;r<n.length;r++){var o=n[r];if(typeof o==="function"&&o.call(this,e))return}if(!i)i=document.URL;p.route.show(h.parseURL(i).path+"?"+t.serialize());return false}).on("click","a:not([data-toggle])",function(e){var t=p.linkClickIgnore||[];var a=f(this);var i=a.data();if(e.isDefaultPrevented())return;for(var n=0;n<t.length;n++){var r=t[n];if(typeof r==="function"&&r.call(this,e))return}var o=a.attr("href")||"";if(!o||o==="#"||0===o.toLowerCase().indexOf("javascript:"))return;var s=p.route.clickHandler(e,false);if(s!==false){l._byClick=true;p.route.show(s);return false}});p.route.base(p.root());p.route("*",function(o,n){if(l._singleTask){l._singleTask.abort();l._singleTask=null}if(o.init)return;l.closeSideNav();if(o.hash&&0===o.hash.indexOf("frames!")){l.setNavActive(o.hash.substr(7),"resumeFrames");return}l.$contentMask.addClass("active");l._singleTask=p.request(p.root()+h.ltrim(o.path,"/")).parse("html").cache(false).addHeader("Busy-Admin-Plugin","SinglePage").addHeader("X-Requested-With","HTML").pending(false).before(function(e,t){if(false===h.execCallback(l,null,document,[e,t],l.$doc,p.e.appReqBefore,true,false))return false}).complete(function(e,t,a){l._singleTask=null;l.$contentMask.removeClass("active");if(false===h.execCallback(l,null,document,[e,t,a],l.$doc,p.e.appReqComplete,true,false))return false}).error(function(e,t,a){if(false===h.execCallback(l,null,document,[e,t,a],l.$doc,p.e.appReqError,true,false))return false;var i=f('<div class="iframe-content"/>');var n=f('<iframe src="about:blank"/>');i.html(n);l._renderSinglePage({content:i},o.path);var r=n.contents()[0];r.open();r.write(a.responseText||e.message);r.close();document.title=r.title}).success(function(t,a,i){l.responseToHtml(t,function(e){n();if(false===h.execCallback(l,null,document,[t,a,i],l.$doc,p.e.appReqSuccess,true,false))return false;l._renderSinglePage(l.extractContainer(e,true),o.path)});return false}).exec()});p.route({click:false});l._oncePluginReadyEvent()},_oncePluginReadyEvent:function e(){var n=this;var r=p.e.appPluginReady+".busy.single";var o=[];n.$doc.off(r).on(r,function(e,t,a,i){o.push({element:t,name:a,target:i});clearTimeout(n._pluginReadyTimer);n._pluginReadyTimer=setTimeout(function(){n.$doc.off(r);n.trigger(p.e.appComplete,[o])},500)})},_renderSinglePage:function e(t,a){var i=this;var n=i.getPath(a);var r=[t,a,n];if(false===h.execCallback(i,null,document,r,i.$doc,p.e.appRenderBefore,true,false))return;var o=f.contains(i.$contentBody,document.activeElement);if(o)try{document.activeElement.blur()}catch(e){}i._oncePluginReadyEvent();p.data={};document.title=t.title||"";i.$contentIframes.removeClass("active");i.$contentBody.removeClass("hide");if(t.init){i.$app.html(t.init);i._initApp();if(i.isFrame)i.setNavActive(n,"renderPage")}else{if(!i.options.multiPage)i.$contentHeader.html(t.contentHeader||"");i.$contentSide.html(t.contentSide||"");i.initContentSide();i.$contentBody.html(t.content||"").append(t.trace||"");i.setNavActive(n,"renderPage")}var s=i.$contentBody.find("input[autofocus],textarea[autofocus]").last()[0];if(s&&document.activeElement!==s)s.focus();i.trigger(p.e.appRenderSuccess,r);h.triggerPluginReady(i.$doc,i)},initContentSide:function e(){var t=this;if(t.$contentSide.children().length>0)t.$content.addClass("ba--show-side");else t.$content.removeClass("ba--show-side")},getPath:function e(t){t=t||document.URL;if(-1===t.indexOf("://"))t="/"+h.ltrim(t,"/");var a=p.root();var i=h.parseURL(t);var n=0===i.pathNoSuffix.indexOf(a)?i.pathNoSuffix.substring(a.length):i.pathNoSuffix;return h.snake(h.ltrim(n,"/"))},setNavActive:function e(t,a){var i=this;if(i.isMiniNav()&&i._onceMiniNav)i.setToDefaultNav();i._onceMiniNav=false;var n=i.$nav.find('[data-path="'+t+'"]');if(n.length===0)n=i.$nav.find('[data-hide-path="'+t+'"]').parent();if(n.length>0){n.trigger(f.Event("click",{triggerFrom:a||"setNavActive"}));i.scrollToNav();return}else i.$nav.find(".active").removeClass("active");if(i.data)i.$headerMenu.find('[data-path="'+i.data.menu_default+'"]').trigger("click")},scrollToNav:function e(){var t=this;var a=t.$nav.find(".is-action.active");if(!a.length)return;var i=a.offset().top-t.$nav.offset().top+t.$nav.scrollTop();var n=(t.$nav.height()-a.height())/2;t.$nav.stop().animate({scrollTop:i-n})},_initApp:function e(){var d=this;d.currentPath=d.getPath(document.URL);d.$frame=a(d.$app,"frame");d.$loader=a(d.$app,"loader").data("show",true);d.$header=a(d.$app,"header");d.$headerLeft=a(d.$header,"header-left");d.$headerRight=a(d.$header,"header-right");d.$headerMenu=a(d.$headerRight,"menu");d.$headerBarLeft=a(d.$headerRight,"bar-left");d.$headerBarRight=a(d.$headerRight,"bar-right");d.$left=a(d.$app,"left");d.$nav=a(d.$app,"nav");d.$navChild=a(d.$app,"nav-child");d.$content=a(d.$app,"content");d.$contentHeader=a(d.$app,"content-header");d.$contentSide=a(d.$app,"content-side");d.$contentSideClose=a(d.$app,"content-side-close");d.$contentSideMask=a(d.$app,"content-side-mask");d.$contentBody=a(d.$app,"content-body");d.$contentIframes=a(d.$app,"content-iframes");d.$contentMask=a(d.$app,"content-mask");d.$barUsername=a(d.$headerRight,"bar-username");d.$barUserDropdowns=a(d.$headerRight,"bar-user-dropdowns");d.$barFullscreen=a(d.$headerRight,"bar-fullscreen");d.$barFullscreenWrap=d.$barFullscreen.parent("li");d.$barFullscreenIcon=d.$barFullscreen.find("i");d.$barRefresh=a(d.$headerRight,"bar-refresh");d.$barRefreshWrap=d.$barRefresh.parent("li");d.$barRefreshIcon=d.$barRefresh.find("i");d.$barControl=a(d.$headerRight,"bar-control");d.$barControlWrap=d.$barControl.parent("li");d.$barControlIcon=d.$barControl.find("i");d.isFrame=d.$contentBody.length>0&&!d.$contentBody.hasClass("ba-page");d.$body.toggleClass("ba-page-root",!d.isFrame);if(!d.isFrame){if(d.inIframe&&!d.options.multiPage){var t=a(d.$app,"content-header");if(t.is("script")&&window.top.busyAdmin.app){window.top.busyAdmin.app.$contentHeader.html(t.html());window.top.document.title=document.title}}if(!d.inIframe&&d.options.login&&!d.isLogin()){d.loadInfo();d.trigger(p.e.appReady);return}d.hideLoader();d.trigger(p.e.appReady);d.trigger(p.e.appReadies);return}d.initContentSide();d.$contentHeader.on("click","a",function(){var e=f(this);var t=e.attr("href")||"";var a=-1!==t.indexOf("://")?t:d.getPath(t);var i=d.$nav.find('[data-path="'+a+'"]');if(0===(i.attr("target")||"").indexOf("ba_iframe_")){d.setNavActive(a,"resumeFrames");return false}});d.$nav.on("click","a",function(e){var t=f(this);var a=t.hasClass("is-action");var i=t.hasClass("is-top");var n=t.parent("li");var r=t.find("> .nav-arrow");var o=t.next("ul");if(a){d.$nav.find(".active").removeClass("active");t.addClass("active");t.parents("ul").each(function(){var e=f(this).prev("a");e.parent("li").addClass("active");if(e.length&&!e.hasClass("open"))e.trigger("click")});d.$headerMenu.find('[data-id="'+t.parents("li").last().data("id")+'"]').trigger(f.Event("click",{_byNav:true}));d.closeSideNav();var s=d._handleIframe(t,e,false);if(i)d.$app.addClass("ba-hide-nav");else d.$app.removeClass("ba-hide-nav");return s}else{e.preventDefault();var l=t.data("path");var c=t.hasClass("open");if(c){if(e.triggerFrom==="resumeNav")return false;o.hide();r.removeClass("fa-rotate-180");t.removeClass("open");t.parents("li").each(function(){if(f(this).find("> a").hasClass("open"))return true;f(this).removeClass("opened")});d._saveNavState(l,false)}else{if(d.options.navSingleHold&&e.triggerFrom!=="resumeNav")if(d.isMobileSize())n.parent("ul").find("> li > a.open").trigger("click");else n.parent("ul").find("> li:not(.ba-nav-li-1) > a.open").trigger("click");o.show();r.addClass("fa-rotate-180");t.addClass("open");t.parents("li").each(function(){if(!f(this).find("> a").hasClass("open"))return true;f(this).addClass("opened")});e.triggerFrom!=="resumeNav"&&d._saveNavState(l,true)}}return false}).on("mouseenter",function(){if(d.isMiniNav()){clearTimeout(d._navHoverTimer);d._navHoverTimer=setTimeout(function(){d.$left.addClass("ba-left-open")},100)}}).on("mouseleave",function(){if(d.isMiniNav()){clearTimeout(d._navHoverTimer);d._navHoverTimer=setTimeout(function(){d.$left.removeClass("ba-left-open")},100)}});d.$contentMask.on("click",function(){d.closeSideNav()});d.$barFullscreen.on("click",function(){d.isFullscreen()?d.exitFullscreen():d.requestFullscreen()});d.$barRefresh.on("click",function(){p.route.reload()});d.$barControl.on("click",function(){if(!d.isMobileSize())if(d.isMiniNav())d.setToDefaultNav();else d.setToMiniNav();else if(d.sideIsOpen())d.closeSideNav();else d.openSideNav()});d.$contentSideClose.on("click",function(){d.$content.toggleClass("ba--force-side")});d.$contentSideMask.on("click",function(){d.$contentSideClose.trigger("click")});d.$contentSide.on("click","[data-close]",function(){d.$contentSideClose.trigger("click")});if(d.options.multiPage){d.tabList=[];d.$multiTabsRow=f('<div class="row"/>');d.$multiTabs=f('<ul class="nav nav-tabs"/>').append('<li class="active"><a href="'+p.root()+'">首页</a></li>');d.$contentHeader.html(d.$multiTabs)}if(!d.isLogin()){d.loadInfo();d.trigger(p.e.appReady)}else{d.trigger(p.e.appReady);d._renderFrame()}},_handleIframe:function e(t,a,i){var n=this;var r=t.attr("target")||"";var o=t.attr("href")||"";if(0===r.indexOf("ba_iframe_")&&o){n.$contentIframes.find(".active").removeClass("active");var s=f('<iframe id="'+r+'" src="'+o+'"/>');var l=-1!==o.indexOf("://");n.$contentIframes.find("#"+r).remove();n.$contentIframes.append(s);s.addClass("active");n.$contentIframes.addClass("active");n.$contentBody.addClass("hide");if(l&&!n.options.multiPage){var c='<ul class="breadcrumb"><li><i class="fa fa-home"></i> <a href="'+p.root()+'">首页</a></li>';var d;if(i){d=t.find("> span").text();c+='<li><a href="'+t.attr("href")+'">'+d+"</a></li>"}else{d=t.find("> .nav-name").text();f(t.parents("li").get().reverse()).each(function(){var e=f(this);var t=e.find("> a");var a=t.find("> .nav-name").text();c+="<li>";if(t.hasClass("is-action"))c+='<a href="'+t.attr("href")+'">'+a+"</a>";else c+="<span>"+a+"</span>";c+="</li>"})}c+="</ul>";document.title=d+n.options.pageTitleSuffix;n.$contentHeader.html(c)}if(a.triggerFrom!=="resumeFrames"){var u=o;if(!l)u=n.getPath(o);p.route.show(p.root()+"#frames!"+u,null,false)}return false}return true},loadInfo:function e(){var n=this;n._abortLoadInfo();n._loadInfoTask=p.request(n.options.url).addHeader("Busy-Admin-Plugin","AppInfo").pending(false).error(function(){return false}).success(function(e,t,a){var i=e.result||{};n.data=i;n.username=i.username;n.userId=i.user_id;n._renderFrame();return false}).exec()},_abortLoadInfo:function e(){var t=this;if(t._loadInfoTask){t._loadInfoTask.abort();t._loadInfoTask=null}},_renderFrame:function e(){var t=this;var a=t.data;t.$barUsername.text(t.username);t._renderMenu(a.menu_list||[]);t._renderNav(a.menu_list||[]);t._renderUserDropdowns(a.user_dropdowns||[]);var i=t.options.navSingleHold?{}:t._getNavState()||{};for(var n in i){if(!i[n])continue;t.$nav.find('[data-path="'+n+'"]').not(".open").trigger(f.Event("click",{triggerFrom:"resumeNav"}))}var r=h.parseURL(document.URL);if(r.hash&&0===r.hash.indexOf("frames!"))t.setNavActive(r.hash.substring(7),"resumeFrames");else t.setNavActive(t.getPath(document.URL),"loadInfo");if(t.options.navMode)t.setToMiniNav();else t.setToDefaultNav();t.trigger(p.e.appReadies);t.hideLoader()},showLoader:function e(){var t=this.$loader;if(t.data("show"))return;t.data("show",true).fadeIn()},hideLoader:function e(){var t=this.$loader;if(!t.data("show"))return;t.data("show",false).fadeOut()},isMiniNav:function e(){return this.$app&&this.$app.hasClass("ba-mini-nav")},sideIsOpen:function e(){return this.$frame.hasClass("ba-nav-open")},_parseResult:function e(t){if(typeof t==="string")try{t=JSON.parse(t)}catch(e){console.error("解析数据失败",e);return{message:"解析数据失败",status:false,code:0,result:{},url:""}}t.status=t.code===1;if(t.hasOwnProperty("traces")){var a;if(this.type!=="POST")a=h.parseURL(this.url).params;else a=h.parseURL("?"+this.data).params}return t},_initResponse:function e(){var t=this;p.response.bindCode(t.options.needLoginCode,function(e){p.dialog.tipError(e.message);p.route.show(e.url);return false});p.response.setParse(function(e){return t._parseResult(e)})},_renderMenu:function e(t){var o=this;var a="";t.map(function(e){var t=o._parseNavItem(e);a+='<li class="'+(e.path===o.data.menu_default&&!o.currentPath?"active":"")+'"><a href="'+t.url+'" data-id="'+e.id+'" data-path="'+t.path+'" target="'+t.target+'" class="'+(e.child.length>0?"":"is-top")+'"><i class="'+e.icon+'"></i> <span>'+e.name+"</span></a></li>"});o.$headerMenuNav=f('<ul class="nav navbar-nav"/>').html(a);o.$headerMenuLeft=f('<a class="left-arrow" href="javascript:void(0)"/>').append('<i class="fa fa-angle-double-left" />').hide();o.$headerMenuRight=f('<a class="right-arrow" href="javascript:void(0)"/>').append('<i class="fa fa-angle-double-right" />').hide();o.$headerMenuScroll=f('<div class="nav-scroll"/>').append(o.$headerMenuLeft).append(o.$headerMenuNav).append(o.$headerMenuRight);o.$headerMenu.html(o.$headerMenuScroll);o.$headerMenuNav.on("click","a",function(e){var t=f(this);var a=t.data("id");var i=t.closest("li");o.$headerMenuNav.find("li.active").removeClass("active");i.addClass("active");o.$nav.find("> ul > li").addClass("hide");o.$nav.find('[data-id="'+a+'"]').removeClass("hide");var n=o.$headerMenuScroll.outerWidth(false);var r=i.position().left;o.$headerMenuScroll.stop().animate({scrollLeft:r-n/2+i.outerWidth(true)/2});if(e._byNav)return false;if(t.hasClass("is-top"))o.$app.addClass("ba-hide-nav");else o.$app.removeClass("ba-hide-nav");return o._handleIframe(t,e,true)});o.$headerMenuLeft.on("click",function(){if(f(this).hasClass("disabled"))return;var e=o.$headerMenuScroll[0].clientWidth/2;o.$headerMenuScroll.stop().animate({scrollLeft:o.$headerMenuScroll.scrollLeft()-e})});o.$headerMenuRight.on("click",function(){if(f(this).hasClass("disabled"))return;var e=o.$headerMenuScroll[0].clientWidth/2;o.$headerMenuScroll.stop().animate({scrollLeft:o.$headerMenuScroll.scrollLeft()+e})});o.$headerMenuScroll.on("scroll",function(){var t=this;var a=f(this);clearTimeout(o._headerMenuScrollTimer);o._headerMenuScrollTimer=setTimeout(function(){var e=a.scrollLeft();if(e<=0)o.$headerMenuLeft.addClass("disabled");else o.$headerMenuLeft.removeClass("disabled");if(e+t.clientWidth>=t.scrollWidth)o.$headerMenuRight.addClass("disabled");else o.$headerMenuRight.removeClass("disabled")},20)});o._menuReady=true;o._computeMenu()},_computeMenu:function e(){var t=this;if(!t.isFrame||!t._menuReady)return;var a=t.$win.width();var i=t.$headerLeft.outerWidth(false);var n=Math.abs(h.float(t.$headerLeft.css("margin-left").replace("px","")));var r=Math.abs(h.float(t.$headerLeft.css("margin-right").replace("px","")));i=i+n+r;var o=t.$headerBarLeft.outerWidth(false);var s=Math.abs(h.float(t.$headerBarLeft.css("margin-left").replace("px","")));var l=Math.abs(h.float(t.$headerBarLeft.css("margin-right").replace("px","")));o=o+s+l;var c=t.$headerBarRight.outerWidth(false);var d=Math.abs(h.float(t.$headerBarRight.css("margin-left").replace("px","")));var u=Math.abs(h.float(t.$headerBarRight.css("margin-right").replace("px","")));c=c+d+u;var p=a-o-c-i;var f=t.$headerMenuNav.outerWidth(true);if(f>p){t.$headerMenuLeft.show();t.$headerMenuRight.show();t.$headerMenuScroll.addClass("show-scroll")}else{t.$headerMenuLeft.hide();t.$headerMenuRight.hide();t.$headerMenuScroll.removeClass("show-scroll")}t.$headerMenu.css("max-width",p+"px");t.$headerMenuScroll.trigger("scroll")},_renderUserDropdowns:function e(t){var a=this;var n="";t.map(function(e){if(e.type==="divider")n+='<li class="divider"></li>';else{var t=e.attr||{};var a="";for(var i in t)a+=i+"='"+t[i]+"' ";n+='<li><a href="'+(e.href||"javascript:void(0);")+'"'+a+'><i class="'+(e.icon||"")+'"></i> '+(e.text||"")+"</a></li>"}});a.$barUserDropdowns.html(n)},_renderNav:function e(t,s){s=s||1;var l=this;var c='<ul class="ba-nav-ul-'+s+'">';t.map(function(e){var t=e.child||[];var a=l._parseNavItem(e);var i=t.length>0;var n=["ba-nav-li-"+s];var r=[];var o="";if(s==1){if(l.data.menu_default!==e.path)n.push("hide");r.push("is-top")}r.push(i?"has-child":"is-action");if(e.path===l.currentPath)r.push("active");(e.hides||[]).map(function(e){o+='<abbr data-hide-path="'+h.snake(e.path)+'" class="hide"></abbr>'});c+='<li class="'+n.join(" ")+'" data-id="'+e.id+'">';c+='<a class="'+r.join(" ")+'" data-path="'+a.path+'" href="'+a.url+'" target="'+a.target+'"><i class="nav-arrow fa fa-angle-down"></i> <i class="nav-icon '+e.icon+'"></i> <span class="nav-name">'+e.name+"</span>"+o+"</a>";if(i)c+=l._renderNav(t,s+1);c+="</li>"});c+="</ul>";if(s>1)return c;else{l.$nav.html(c);l.$nav.css({marginRight:-h.getScrollbarWidth()+"px"})}},_parseNavItem:function e(t){var a=-1===t.url.indexOf("://")?p.root()+h.ltrim(t.url,"/"):t.url;var i=t.target;var n=h.snake(t.path);if(i==="_blank")return{url:a,target:i};if(!t.url||(t.child||[]).length>0)a="javascript:void(0)";if(t.top_url&&!t.parent_path)a=p.root()+h.ltrim(t.top_url,"/");if(i==="iframe")i="ba_iframe_"+t.id;return{url:a,target:i,path:n}},getContentFrame:function e(){var t=this;var a=t.$contentBody;var i=h.float(a.css("paddingTop").replace("px",""));var n=h.float(a.css("paddingBottom").replace("px",""));var r=h.float(a.css("paddingLeft").replace("px",""));var o=h.float(a.css("paddingRight").replace("px",""));var s=a.offset();var l=t.$win.height()-s.top-i-n;var c=a.outerWidth(true)-r-o;return{target:a,height:l,width:c,top:s.top-(t.isMobileSize()&&t.$contentHeader.length>0?t.$contentHeader.outerHeight():0),left:s.left,paddingLeft:r,paddingRight:o,paddingTop:i,paddingBottom:n}},isInContent:function e(t){return t.closest('[data-busy-id="'+this.$contentBody.attr("data-busy-id")+'"]').length>0},extractContainer:function e(t,a){var i=this;var n={};var r=f(v(t.match(/<body[^>]*>([\s\S.]*)<\/body>/i)[0]));var o=t.match(/<head[^>]*>([\s\S.]*)<\/head>/i);var s=o!=null?f(v(o[0])):r;var l=t.match(/<script.*?id="think_trace_console_script">([\s\S.]*)<\/script>/i)||[];if(r.length===0)return n;var c=m(r,"content-body");if(a)if(!c.hasClass("ba-page")){if(!i.isFrame){n.init=m(r,"app").first().children();n.frame=true}}else if(i.isFrame){n.init=m(r,"app").first().children();n.frame=false}var d=g(s,"title").last();n.title=f.trim(d.text()||"");n.appTitle=f.trim(d.data("title")||"");var u=r.find("title").last();if(u.length)n.appTitle=f.trim(u.text()||"");n.content=c.first().children();n.contentHeader=m(r,"content-header").first().children();n.contentSide=m(r,"content-side").first().children();n.trace=l[0]||"";if(n.content.length>0){n.content=n.content.not(function(){return f(this).is("title")});n.content.find("title").remove()}return n},responseToHtml:function e(t,a){var i=this;try{p.response.parse(i._parseResult(JSON.parse(t.result)),null,function(e,t){p.dialog.tipError("返回内容异常");console.warn("返回内容不是HTML格式，请检查服务端代码")},function(e,t){p.dialog.tipError(e.message)})}catch(e){a.call(i,t.result)}},requestFullscreen:function e(){var t=document.documentElement;var a=t.requestFullScreen||t.webkitRequestFullScreen||t.mozRequestFullScreen||t.msRequestFullScreen;if(a){a.call(t);this._changeFullState(true)}else if(typeof window.ActiveXObject!=="undefined"){var i=new ActiveXObject("WScript.Shell");if(i!=null){i.SendKeys("{F11}");this._changeFullState(true)}}},exitFullscreen:function e(){var t=document;var a=t.cancelFullScreen||t.webkitCancelFullScreen||t.mozCancelFullScreen||t.exitFullScreen;if(a){a.call(t);this._changeFullState(false)}else if(typeof window.ActiveXObject!=="undefined"){var i=new ActiveXObject("WScript.Shell");if(i!=null){i.SendKeys("{F11}");this._changeFullState(false)}}},isFullscreen:function e(){return this.$barFullscreenWrap.hasClass("active")},_changeFullState:function e(t){if(t){this.$barFullscreenWrap.addClass("active");this.$barFullscreenIcon.removeClass("bicon-full-screen").addClass("bicon-shrink-screen")}else{this.$barFullscreenWrap.removeClass("active");this.$barFullscreenIcon.addClass("bicon-full-screen").removeClass("bicon-shrink-screen")}},getUserId:function e(){return this.getData().user_id||0},cacheKey:function e(t){return"ba."+this.getUserId()+"."+t},getUsername:function e(){return this.getData().username||""},getUserInfo:function e(){return this.getData().user||{}},getData:function e(){return this.data||{}},getUseData:function e(){return this.getData().data||{}},trigger:function e(t,a){h.execCallback(this,null,document,a||[],this.$doc,t);return this},on:function e(t,a){this.$doc.on(t,a);return this},once:function e(t,a){this.$doc.one(t,a);return this},off:function e(t){this.$doc.off(t);return this},outLogin:function e(t){var a=this;a.data=null;a.options.login=false;a._abortLoadInfo();a.trigger(p.e.appLoginOuted,[t]);p.route.show(t.url)},loginSuccess:function e(t){var a=this;a.options.login=true;a.trigger(p.e.appLoginSucceed,[t]);p.route.show(t.url)},isLogin:function e(){return this.data!=null},clearCache:function e(){var t=this;var a=t.cacheKey("");for(var i in localStorage)if(0===i.indexOf(a))localStorage.removeItem(i);for(i in sessionStorage)if(0===i.indexOf(a))sessionStorage.removeItem(i);t.trigger(p.e.appClearCache)},reload:function e(){self.location.reload()}},i.DEFAULTS={navSingleHold:false,navMode:false,imagePlaceholder:"",avatarPlaceholder:"",multiPage:false,scrollCacheLength:50,url:"",pageTitleSuffix:"",needLoginCode:3020001},p.app=new i,p.regSugar("app",function(e,t,a){if(!e)return;p.app[e](t)})}),function(e){define("./ba/app/helper",["busyAdmin","jquery"],e)}(function(busyAdmin,$){function DomChange(){this.timeout=0,this.timer=null}DomChange.prototype={on:function(e,t,a){var i=this;return(e=e||document)instanceof $&&(e=e[0]),i.node=e,i.onCall=t,window.MutationObserver?(i.observer=new MutationObserver(function(e){(e[0].addedNodes.length||e[0].removedNodes.length)&&i._do()}),i.observer.observe(i.node,{subtree:!0,childList:!0})):window.addEventListener&&i.node.addEventListener("DOMNodeInserted",i._do,!1),void 0!==a&&!a||$(function(){t()}),i},off:function(){window.MutationObserver?this.observer.disconnect():window.addEventListener&&this.node.removeEventListener("DOMNodeInserted",this._do,!1)},_do:function(){var e=this;clearTimeout(e.timer),e.timer=setTimeout(function(){e.onCall()},e.timeout)}},busyAdmin.helper={parseURL:function(e){var o=document.createElement("a");o.href=e;var t=o.pathname.replace(/^([^\/])/,"/$1"),a=t.lastIndexOf("."),i="",n=t;return-1!==a&&(i=t.substring(a+1),n=t.substring(0,a)),{source:e,protocol:o.protocol.replace(":",""),host:o.hostname,port:o.port,query:o.search,params:function(){for(var e,t,a={},i=o.search.replace(/^\?/,"").split("&"),n=i.length,r=0;r<n;r++)i[r]&&(t=i[r].split("="),e=decodeURIComponent(t[0]),t=decodeURIComponent(t[1]),a.hasOwnProperty(e)?($.isArray(a[e])||(a[e]=[a[e]]),a[e].push(t)):a[e]=t);return a}(),filename:(o.pathname.match(/\/([^\/?#]+)$/i)||[,""])[1],hash:o.hash.replace("#",""),path:t,pathNoSuffix:n,extension:i,relative:(o.href.match(/tps?:\/\/[^\/]+(.+)/)||[,""])[1],segments:o.pathname.replace(/^\//,"").split("/")}},checkURL:function(e){return!(0===(e=e||"").indexOf("javascript:")||0===e.indexOf("#"))},getObjectValue:function(e,t,a,i){if(!e.hasOwnProperty(t))return a;t=e[t];return!0!==i||("string"==typeof a&&(t=t.trim()),t)?t:a},onDomChange:function(e,t,a){return(new DomChange).on(e,t,a)},onPopState:function(e){window.history&&window.history.pushState&&$(window).on("popstate",e)},parseData:function(a,e,t){e="string"==typeof e?[e]:e,t="string"==typeof t?[t]:t||[];var i,n={};for(i in a)t.map(function(e){0===i.indexOf(e)&&(n[i]=a[i])}),e.map(function(e){var t=e.length;0!==i.indexOf(e)||0!=((t=i.slice(t)).slice(0,1).toLowerCase()+t.slice(1)).length&&(n[t.slice(0,1).toLowerCase()+t.slice(1)]=a[i])});return n},uuid:function(){for(var e=[],t="0123456789abcdef",a=0;a<36;a++)e[a]=t.substr(Math.floor(16*Math.random()),1);return e[14]="4",e[19]=t.substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-",e.join("")},htmlToEscape:function(e){return null==e?"":e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;").replace(/`/g,"&#x60;")},escapeToHtml:function(e){return null==e?"":e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#039;/g,"'").replace(/&#x60;/g,"`")},execCallback:function(e,t,a,i,n,r,o,s,l){var c=["true","false"];"string"==typeof t&&(0===(t=t.trim()).indexOf("@")&&(t=busyAdmin.dispatchSugar(a,t,e,i,r?"string"==typeof r?r:r.type:"")),-1===c.indexOf(t)&&(0!==t.indexOf("!")||0<(u=(t=t.substring(1,t.length)).substring(0,t.lastIndexOf("."))).length&&(a=busyAdmin.helper.scope(u)||a),0<t.length&&(t=busyAdmin.helper.scope(t))));var d=null;if(n&&n.length&&0<n.length){var u,e=[];if($.isArray(n)&&(u=n.shift(),e=n,n=u),e.map(function(e){e.triggerHandler(r,i)}),d=n.triggerHandler(r,i),null===o)return d;if(o)if(l){if((void 0===d?"undefined":_typeof(d))===s)return d}else if(s===d)return d}return"function"==typeof t?(i=i||[],a=a||this,t.apply(a,i)):"string"==typeof t&&-1!==c.indexOf(t)?$.baStrToVar(t):d},base64Encode:function(e){return window.btoa(unescape(encodeURIComponent(e)))},base64Decode:function(e){return decodeURIComponent(escape(window.atob(e)))},int:function(e){return e=parseInt(e),isNaN(e)?0:e},float:function(e){return e=parseFloat(e),isNaN(e)?0:e},getElementBySelector:function(e){e=$(e);return 0<e.length&&"SCRIPT"===e[0].tagName&&(e=$(e.html())),e},camel:function(e){return e.replace(/[_-](\w)/g,function(e,t){return t.toUpperCase()})},snake:function(e,t){return t=t||"_",(e=e.replace(/[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+/g,"",e)).replace(/((?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))(?=[A-Z])/g,"$1"+t).toLowerCase()},sprintf:function(){for(var e=arguments,t=e[0],a=1;a<e.length;a++)var i=arguments[a],t=t.replace("%s",i);return t},urlPreviewHandler:function(e){switch(e.url.substring(e.url.lastIndexOf(".")+1).trim().toLowerCase()){case"jpeg":case"png":case"gif":case"jpg":case"webp":case"bmp":case"ico":"function"==typeof e.image&&e.image();break;case"mp4":case"webm":case"ogv":"function"==typeof e.video&&e.video();break;case"mp3":"function"==typeof e.audio&&e.audio();break;default:"function"==typeof e.file&&e.file()}},arrayRemoveByIndex:function(e,t){return 0===(e=e||[]).length||t<0?e:e.slice(0,n).concat(e.slice(n+1,e.length))},triggerPluginReady:function(e,t,a,i){i&&busyAdmin.helper.execCallback(t,(t.options||{})[a||"onInitialized"],e[0],[],e,i),$(document).triggerHandler(busyAdmin.e.appPluginReady,[e,t])},extends:function(e,t){var a,i={};for(a in t)i[a]=e[a];return $.extend(e,t),i},override:function(e,t,a,i){t=e[t];if("function"==typeof t)return t.apply(a,Array.isArray(i)?i:Array.prototype.slice.call(i));throw t},scope:function scope(name,defaults){if("string"!=typeof name)return name;if(0===name.indexOf("!"))return name.substring(1);if(!/^[a-z0-9$._]+$/i.test(name))return name;if(-1===name.indexOf("."))return busyAdmin.data[name]||window[name]||defaults;var arr=name.split(".");name=arr.shift();for(var value=busyAdmin.data[name]||window[name]||{},len=arr.length,createCode=function(e,t,a){return"("+e+"."+t+" || "+a+")"},code="",i=0,val,def;i<len;i++){0==i&&(code="value"),code=createCode(code,arr.shift(),i+1==len?"defaults":"{}")}try{return eval(code)}catch(e){return defaults}},getScrollbarWidth:function(){var e=document.createElement("div"),t=document.createElement("div");e.style.overflow="scroll",document.body.appendChild(e),e.appendChild(t);t=e.offsetWidth-t.offsetWidth;return document.body.removeChild(e),t},ltrim:function(e,t){return t=t||"s",e.replace(RegExp("(^"+t+"*)","g"),"")},rtrim:function(e,t){return t=t||"s",e.replace(RegExp("("+t+"*$)","g"),"")},random:function(e,t){e=e||32;for(var a=(t=t||"ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678").length,i="",n=0;n<e;n++)i+=t.charAt(Math.floor(Math.random()*a));return i},listToTree:function(e,t,a,i,n){t=t||"id",a=a||"child",i=i||"parent",n=n||"";for(var r=[],o={},s=0,l=(e=e||[]).length;s<l;s++){var c=e[s],d=c[t];d&&(o[d]?c[a]=o[d]:c[a]=o[d]=[],c[i]&&c[i]!=n?(o[d=c[i]]||(o[d]=[]),o[d].push(c)):r.push(c))}return r},pluginFn:function(e,o,s,l,c,d){var u,p;return(l=Array.prototype.slice.call(l)).shift(),p="object"===(void 0===s?"undefined":_typeof(s))&&!0===l[0]||!0===s,e.each(function(){var t=$(this),e=t.data(o.KEY);if(!e||p)try{e&&!e._pluginFnDestroyed&&("function"==typeof e.destroy&&e.destroy(),delete e._pluginFnDestroyed),t.data(o.KEY,e=new o(this,"object"===(void 0===s?"undefined":_typeof(s))&&s))}catch(e){throw t.data(o.KEY,e),e}if("string"==typeof s){if("function"==typeof c)u=c.call(e,t);else if(e[s])"destroy"===s&&(e._pluginFnDestroyed=!0)===l[0]&&t.removeData(o.KEY),u=e[s].apply(e,l);else if(c){$.isArray(c)||(c=[c]);for(var a=c.length,i=0;i<a;i++){var n,r=c[i];if("function"==typeof r&&(r=(n=r(s)).name,s=n.method),e[r]&&e[r][s]){u=e[r][s].apply(e[r],l);break}}}}else"function"==typeof d&&d.call(e)}),"string"==typeof s?u:e},pluginAttrs:function(e){return'[data-toggle="busy-'+e+'"],[busy-'+e+"]"},pluginKey:function(e){return"ba-"+e},pluginCall:function(e,t,a,i,n){var r=a.data(e.KEY);return r&&r instanceof e?"string"==typeof i?a[t].apply(a,Array.prototype.slice.call(n)):r:null},initArt:function(e){var d;e._busyInit||(e._busyInit=!0,d=e.defaults.rules[1],e.defaults.rules.push({test:/<ba-([a-z]+)\s*value=['"]+(.*?)['"]+\s*(\/?)>(<\/ba-(else|elseif|set)>)*|<ba-([a-z]+)\s*\/>(<\/ba-else>)*|<\/ba-([a-z]+)>/,use:function(e,t,a,i,n,r,o,s,l){if(t&&void 0!==a)switch(t){case"if":a="if ("+a+") {";break;case"elseif":a="} else if ("+a+") {";break;case"else":a="} else {";break;case"each":var c=d._split(this.getEsTokens(a));a="$each("+(c[0]||"$data")+", function("+(c[1]||"$value")+", "+(c[2]||"$index")+") {"}else if(o)switch(o){case"set":a="var "+a;break;case"else":a="} else {"}else if(l)switch(l){case"if":a="}";break;case"each":a="})";break;case"else":a="} else {"}return{code:a,output:!1}}}))},encodeUnicode:function(e){for(var t=e.split(""),a="",i=0;i<t.length;i++){var n=Number(t[i].charCodeAt(0)).toString(16);a+="\\u"+(n=String("0000").substring(n.length,4)+n)}return a},decodeUnicode:function(e){for(var t=e.split("\\u"),a=t[0],i=1;i<t.length;i++){var n=t[i];a+=String.fromCharCode(parseInt("0x"+n.substring(0,4))),4<n.length&&(a+=n.substring(4,n.length))}return a},checkCardNoProvince:function(e){e=(e+="").substring(0,2);return!(!/^[1-9][0-9]/.test(e)||!{11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江 ",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北 ",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏 ",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门"}[e])},checkCardNoDate:function(e){18===(e+="").length&&(e=e.substring(6,14));if(/^(18|19|20)\d{2}((0[1-9])|(1[0-2]))(([0-2][1-9])|10|20|30|31)$/.test(e)){var t=e.substring(0,4),a=e.substring(4,6),e=e.substring(6,8),e=new Date(t+"-"+a+"-"+e);if(e&&e.getMonth()==parseInt(a)-1)return!0}return!1},checkCardNo:function(e){if(e+="",!busyAdmin.helper.checkCardNoProvince(e))return!1;if(!busyAdmin.helper.checkCardNoDate(e))return!1;if(/^[\d]{17}[0-9|x|X]{1}$/.test(e)){for(var t=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],a=e.slice(0,17),i=e.slice(17,18),i=isNaN(parseInt(i))?i.toLowerCase():parseInt(i),n=0,r=0;r<17;r++)n+=parseInt(a.charAt(r))*t[r];e=[1,0,"X",9,8,7,6,5,4,3,2];if(("string"==typeof e[n%11]?"x":e[n%11])===i)return!0}return!1}},$.fn.baOnTransEnd=function(e,t){return this[e?"one":"on"]("webkitTransitionEnd msTransitionend oTransitionEnd otransitionend mozTransitionend transitionend",t),this},$.fn.baOnAnimEnd=function(e,t){return this[e?"one":"on"]("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",t),this},$.fn.baFormVal=function(e,t){var a,i=$(this);for(a in e=t?(e=e||document.URL,busyAdmin.helper.parseURL(e).params):e||{}){var n=e[a],r=i.find('[name="'+a+'"]');if(0<r.length)switch((r.attr("type")||"").toLowerCase()){case"checkbox":case"radio":r.each(function(){$(this).prop("checked",$(this).val()==n).trigger("change")});break;default:r.val(n).trigger("change")}else i.append('<input type="hidden" name="'+a+'" value="'+n+'"/>')}return this};var TriggerEvent=function(e,t,a){var i=document.createEvent("HTMLEvents");return i.eventName=t,i.params=a,i.initEvent(t,!0,!0),!e.dispatchEvent(i)},Dm,Em,Km;function Fm(e){return Km.raw?e:encodeURIComponent(e)}function Jm(e,t){e=Km.raw?e:function(e){0===e.indexOf('"')&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return e=decodeURIComponent(e.replace(Em," ")),Km.json?JSON.parse(e):e}catch(e){}}(e);return Dm.isFunction(t)?t(e):e}jQuery.Event.prototype.getBaTriggerParams=function(){return(this.originalEvent||{}).params},$.fn.baTriggerEvent=function(e,t){return this.each(function(){TriggerEvent(this,e,t)}),this},$.baIsEmpty=function(e){return null==e},$.baStrToVar=function(e){if("string"==typeof e)try{e="true"===e||"false"!==e&&("null"===e?null:+e+""===e?+e:/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/.test(e)?JSON.parse(e):e)}catch(e){}else e=void 0;return e},$.fn.getUrl=function(){var e=this.is("form")?this.attr("action"):this.attr("href");return $.baIsEmpty(e)||"#"===e||0===e.toLowerCase().indexOf("javascript:")?"":e},$.fn.baData=function(e){if(this.length){for(var t,a,i="busy-"+e,n=i+"-",r=n.length,o=this[0].attributes,s=o.length,l={};s--;)o[s]&&((t=o[s].name)!==i?0===t.indexOf(n)&&""!==(t=$.camelCase(t.substring(r)))&&(l[t]=$.baStrToVar(o[s].value),a=!0):a=!0);if(a)return l}return this.data()},Dm=jQuery,Em=/\+/g,Km=Dm.cookie=function(e,t,a){var i,n;if(void 0!==t&&!Dm.isFunction(t))return"number"==typeof(a=Dm.extend({},Km.defaults,a)).expires&&(n=a.expires,(i=a.expires=new Date).setTime(+i+864e5*n)),document.cookie=[Fm(e),"=",(n=t,Fm(Km.json?JSON.stringify(n):String(n))),a.expires?"; expires="+a.expires.toUTCString():"",a.path?"; path="+a.path:"",a.domain?"; domain="+a.domain:"",a.secure?"; secure":""].join("");for(var r=e?void 0:{},o=document.cookie?document.cookie.split("; "):[],s=0,l=o.length;s<l;s++){var c=o[s].split("="),d=(d=c.shift(),Km.raw?d:decodeURIComponent(d)),c=c.join("=");if(e&&e===d){r=Jm(c,t);break}e||void 0===(c=Jm(c))||(r[d]=c)}return r},Km.defaults={},Dm.removeCookie=function(e,t){return void 0!==Dm.cookie(e)&&(Dm.cookie(e,"",Dm.extend({},t,{expires:-1})),!Dm.cookie(e))}}),define("./ba/app/request",["busyAdmin","jquery"],function(f,h){var m=function e(t,a){this.config={method:e.options.method,cache:e.options.cache,pendingStatus:e.options.pendingStatus,pendingMessage:e.options.pendingMessage,before:e.options.beforeCallback,complete:e.options.completeCallback,success:e.options.successCallback,error:e.options.errorCallback,progress:e.options.progressCallback,parse:e.options.parse,parseExec:"",ajaxOptions:{},url:document.URL,params:[],headers:{}};if((typeof t==="undefined"?"undefined":_typeof(t))==="object")this.config.ajaxOptions=t||{};else if(typeof t==="string"||typeof t==="function"){this.url(t);this.config.ajaxOptions=a||{}}this.paramElements=[];this.ajax=null};m.options={root:"",contentType:"application/x-www-form-urlencoded",method:"get",cache:false,params:{},headers:{},parse:"",pendingStatus:true,pendingMessage:"请稍候...",ajaxOptions:{},beforeCallback:h.noop,completeCallback:h.noop,successCallback:function e(t){f.dialog.tipSuccess(t.message||"success")},errorCallback:function e(t){f.dialog.tipError(t.message||"error")},progressCallback:h.noop},m.prototype={pending:function e(t,a){if(typeof t==="string"&&t.length){a=t;t=true}this.config.pendingStatus=t;if(a)this.config.pendingMessage=a;return this},cache:function e(t){this.config.cache=t;return this},url:function e(t){this.config.url=t;return this},post:function e(t){return this.method(t?"post":"get")},method:function e(t){this.config.method=t;return this},headers:function e(t){if(typeof t==="function")t=t();this.config.headers=t||{};return this},addHeader:function e(t,a){this.config.headers[t]=a;return this},params:function e(t){var a=this;a.config.params=[];if(typeof t==="function"&&!(t instanceof jQuery))t=t();if(t instanceof jQuery)a.config.params=t.serializeArray();else if(h.isArray(t))a.config.params=t;else if((typeof t==="undefined"?"undefined":_typeof(t))==="object"&&t!==null)for(var i in t){var n=t[i];if(h.isArray(n))n.map(function(e){a.config.params.push({name:-1!==i.indexOf("[")?i:i+"[]",value:e})});else a.config.params.push({name:i,value:n})}else if(typeof t==="string"&&t!==""){var r=f.helper.parseURL("?"+t).params||{};for(var i in r){var n=r[i];if(h.isArray(n))n.map(function(e){a.config.params.push({name:-1!==i.indexOf("[")?i:i+"[]",value:e})});else a.config.params.push({name:i,value:n})}}return this},addParam:function e(t,a,i){if(a instanceof jQuery)this.paramElements.push({name:t,value:a,filename:i});else this.config.params.push({name:t,value:a,filename:i});return this},clear:function e(){this.config.headers={};this.config.params=[];this.paramElements=[];return this},parse:function e(t,a){this.config.parse=t;this.config.parseExec=a;return this},before:function e(t){this.config.before=typeof t==="function"?t:this.config.before;return this},complete:function e(t){this.config.complete=typeof t==="function"?t:this.config.complete;return this},success:function e(t){this.config.success=typeof t==="function"?t:this.config.success;return this},error:function e(t){this.config.error=typeof t==="function"?t:this.config.error;return this},progress:function e(t){this.config.progress=typeof t==="function"?t:this.config.progress;return this},exec:function e(){var r=this;var a=null;var o=h("<form />");this.paramElements.map(function(e){var t=e.value;var a=e.name||false;a=a?a:t.attr("name");if(t.length===0)return true;if(t[0].tagName==="INPUT"&&t.attr("type").toUpperCase()==="FILE"){var i=t[0].files;if(i.length>0)if(t.attr("multiple"))for(var n=0;n<i.length;n++)r.config.params.push({name:a,value:i[n]});else r.config.params.push({name:a,value:i[0],filename:e.filename})}else{t.attr("name",a);o.append(t.clone())}});o.serializeArray().map(function(e){r.config.params.push(e)});var t=m.options.params;for(var i in t)r.config.params.push({name:i,value:t[i]});var n=false;r.config.params.map(function(e){if(e.value instanceof File)n=true});if(!r.config.cache){r.config.headers["Cache-Control"]="no-cache";r.config.headers["If-Modified-Since"]="0"}var s=typeof r.config.url==="function"?r.config.url():r.config.url;if(typeof s!=="string"||s==="")s=document.URL;var l=h.extend({},h.extend({},{contentType:m.options.contentType,url:m.options.root+s,headers:h.extend({},r.config.headers,m.options.headers),type:r.config.method,dataType:r.config.parse?r.config.parse:"text",jsonpCallback:r.config.parseExec},m.options.ajaxOptions),r.config.ajaxOptions||{});if(n){l.cache=false;l.type="post";l.contentType=false;l.processData=false;var c=new FormData;r.config.params.map(function(e){if(e.filename)c.append(e.name,e.value,e.filename);else c.append(e.name,e.value)});l.data=c}else l.data=r.config.params;var d=function e(){a!==null&&a.close()};var u=function e(t,a,i){if(false===r.config.success.call(r,t,a,i))return false;return m.options.successCallback.call(r,t,a,i)};var p=function e(t,a,i){if(false===r.config.error.call(r,t,a,i))return false;return m.options.errorCallback.call(r,t,a,i)};l.beforeSend=function(e,t){if(false===r.config.before.call(r,e,t))return false;if(r.config.pendingStatus)a=f.dialog.pending(r.config.pendingMessage)};l.success=function(e,t,a){d();if(!r.config.parse){this.xhr=a;f.response.parse(e,this,function(e,t){u(e,t,a)},function(e,t){p(e,t,a)},function(e,t){return r.config.complete.call(r,e,t,a)})}else{var i=f.response.result;i.status=true;i.result=e;if(false!==r.config.complete.call(r,i,f.response.type.success,a))u(i,f.response.type.success,a)}};l.error=function(e,t,a){d();if(t==="abort")return;var i=t==="parsererror"?f.response.type.parse:f.response.type.http;var n=f.response.result;n.status=false;n.message=e.status+" "+a;if(false!==r.config.complete.call(r,n,i,e))p(n,i,e)};l.xhr=function(){var e=h.ajaxSettings.xhr();if(e.upload)e.upload.addEventListener("progress",function(e){if(false===r.config.progress.call(r,e))return;m.options.progressCallback.call(r,e)},false);return e};r.ajax=h.ajax(l);return r.ajax}},f.request=function(e,t){return new m(e,t)},f.request.setOptions=function(e,t){if(typeof e==="string")m.options[e]=t;else m.options=h.extend(m.options,e)}}),define("./ba/app/response",["busyAdmin","jquery"],function(e,f){var h=function e(){this.parseCallback=null;this.bindCodeList={}};h.result={status:false,message:"",url:"",code:0,result:{}},h.type={success:0,http:1,parse:2,logic:3},h.prototype={parse:function e(t,a,i,n,r){i=typeof i==="function"?i:f.noop;n=typeof n==="function"?n:f.noop;r=typeof r==="function"?r:f.noop;var o;var s=h.result;s.status=false;if(typeof t==="string"||!t)if(typeof this.parseCallback==="function")o=this.parseCallback.call(a,t)||{};else{t=f.trim(t);if("{"!==t.charAt(0)||"}"!==t.charAt(t.length-1)){s.message="返回数据解析异常";if(false!==r(s,h.type.parse))n(s,h.type.parse);return}try{o=JSON.parse(t)}catch(e){s.message="解析数据异常: "+e;if(false!==r(s,h.type.parse))n(s,h.type.parse);return}}else o=t;var l=[];["status","code","message","url","result"].map(function(e){if(!o.hasOwnProperty(e))l.push(e)});if(l.length>0){s.message="返回的参数中必须包含键: "+l.join(",");if(false!==r(s,h.type.parse))n(s,h.type.parse);return}var c=this.bindCodeList[o.code]||[];var d=c.length;for(var u=d-1;u>=0;u--){var p=c[u].callback||null;if(typeof p==="function"&&false===p(o))return}if(false===r(o,o.status?h.type.success:h.type.logic))return;if(o.status)i(o,h.type.success);else n(o,h.type.logic)},setParse:function e(t){this.parseCallback=t;return this},bindCode:function e(t,a){this.bindCodeList[t]=this.bindCodeList[t]||[];this.bindCodeList[t].push({callback:a});return this}},e.response=new h,e.response.result=h.result,e.response.type=h.type}),define("./ba/app/route",["busyAdmin","jquery"],function(l,c){"use strict";var d=Array.isArray||function(e){return Object.prototype.toString.call(e)=="[object Array]"},r=b,e=o,t=n,a=s,i=v,y=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^()])+)\\))?|\\(((?:\\\\.|[^()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function o(e){var t=[];var a=0;var i=0;var n="";var r;while((r=y.exec(e))!=null){var o=r[0];var s=r[1];var l=r.index;n+=e.slice(i,l);i=l+o.length;if(s){n+=s[1];continue}if(n){t.push(n);n=""}var c=r[2];var d=r[3];var u=r[4];var p=r[5];var f=r[6];var h=r[7];var m=f==="+"||f==="*";var g=f==="?"||f==="*";var v=c||"/";var b=u||p||(h?".*":"[^"+v+"]+?");t.push({name:d||a++,prefix:c||"",delimiter:v,optional:g,repeat:m,pattern:$(b)})}if(i<e.length)n+=e.substr(i);if(n)t.push(n);return t}function n(e){return s(o(e))}function s(l){var c=new Array(l.length);for(var e=0;e<l.length;e++)if(_typeof(l[e])==="object")c[e]=new RegExp("^"+l[e].pattern+"$");return function(e){var t="";var a=e||{};for(var i=0;i<l.length;i++){var n=l[i];if(typeof n==="string"){t+=n;continue}var r=a[n.name];var o;if(r==null)if(n.optional)continue;else throw new TypeError('Expected "'+n.name+'" to be defined');if(d(r)){if(!n.repeat)throw new TypeError('Expected "'+n.name+'" to not repeat, but received "'+r+'"');if(r.length===0)if(n.optional)continue;else throw new TypeError('Expected "'+n.name+'" to not be empty');for(var s=0;s<r.length;s++){o=encodeURIComponent(r[s]);if(!c[i].test(o))throw new TypeError('Expected all "'+n.name+'" to match "'+n.pattern+'", but received "'+o+'"');t+=(s===0?n.prefix:n.delimiter)+o}continue}o=encodeURIComponent(r);if(!c[i].test(o))throw new TypeError('Expected "'+n.name+'" to match "'+n.pattern+'", but received "'+o+'"');t+=n.prefix+o}return t}}function u(e){return e.replace(/([.+*?=^!:${}()[\]|\/])/g,"\\$1")}function $(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function p(e,t){e.keys=t;return e}function f(e){return e.sensitive?"":"i"}function h(e,t){var a=e.source.match(/\((?!\?)/g);if(a)for(var i=0;i<a.length;i++)t.push({name:i,prefix:null,delimiter:null,optional:false,repeat:false,pattern:null});return p(e,t)}function m(e,t,a){var i=[];for(var n=0;n<e.length;n++)i.push(b(e[n],t,a).source);var r=new RegExp("(?:"+i.join("|")+")",f(a));return p(r,t)}function g(e,t,a){var i=o(e);var n=v(i,a);for(var r=0;r<i.length;r++)if(typeof i[r]!=="string")t.push(i[r]);return p(n,t)}function v(e,t){t=t||{};var a=t.strict;var i=t.end!==false;var n="";var r=e[e.length-1];var o=typeof r==="string"&&/\/$/.test(r);for(var s=0;s<e.length;s++){var l=e[s];if(typeof l==="string")n+=u(l);else{var c=u(l.prefix);var d=l.pattern;if(l.repeat)d+="(?:"+c+d+")*";if(l.optional)if(c)d="(?:"+c+"("+d+"))?";else d="("+d+")?";else d=c+"("+d+")";n+=d}}if(!a)n=(o?n.slice(0,-2):n)+"(?:\\/(?=$))?";if(i)n+="$";else n+=a&&o?"":"(?=\\/|$)";return new RegExp("^"+n,f(t))}function b(e,t,a){t=t||[];if(!d(t)){a=t;t=[]}else if(!a)a={};if(e instanceof RegExp)return h(e,t,a);if(d(e))return m(e,t,a);return g(e,t,a)}r.parse=e,r.compile=t,r.tokensToFunction=a,r.tokensToRegExp=i;var x="undefined"!==typeof document,w="undefined"!==typeof window,k="undefined"!==typeof history,C=typeof process!=="undefined",_=x&&document.ontouchstart?"touchstart":"click",S=w&&!!(window.history.location||window.location);function E(){this.callbacks=[];this.exits=[];this.current="";this.len=0;this._decodeURLComponents=true;this._base="";this._strict=false;this._running=false;this._hashbang=false;this.clickHandler=this.clickHandler.bind(this);this._onpopstate=this._onpopstate.bind(this)}function T(){var a=new E;function e(){return D.apply(a,arguments)}e.callbacks=a.callbacks;e.exits=a.exits;e.base=a.base.bind(a);e.strict=a.strict.bind(a);e.start=a.start.bind(a);e.stop=a.stop.bind(a);e.show=a.show.bind(a);e.back=a.back.bind(a);e.redirect=a.redirect.bind(a);e.replace=a.replace.bind(a);e.dispatch=a.dispatch.bind(a);e.exit=a.exit.bind(a);e.configure=a.configure.bind(a);e.sameOrigin=a.sameOrigin.bind(a);e.clickHandler=a.clickHandler.bind(a);e.reload=a.reload.bind(a);e.create=T;Object.defineProperty(e,"len",{get:function e(){return a.len},set:function e(t){a.len=t}});Object.defineProperty(e,"current",{get:function e(){return a.current},set:function e(t){a.current=t}});e.Context=P;e.Route=F;return e}function D(e,t){if("function"===typeof e)return D.call(this,"*",e);if("function"===typeof t){var a=new F(e,null,this);for(var i=1;i<arguments.length;++i)this.callbacks.push(a.middleware(arguments[i]))}else if("string"===typeof e)this["string"===typeof t?"redirect":"show"](e,t);else this.start(e)}function I(e){if(e.handled)return;var t;var a=this;var i=a._window;if(a._hashbang)t=S&&this._getBase()+i.location.hash.replace("#/","");else t=S&&i.location.pathname+i.location.search;if(t===e.canonicalPath)return;a.stop();e.handled=false;S&&(i.location.href=e.canonicalPath)}function A(e){return e.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function P(e,t,a){var i=this.page=a||D;var n=i._window;var r=i._hashbang;var o=i._getBase();if("/"===e[0]&&0!==e.indexOf(o))e=o+(r?"#/":"")+e;var s=e.indexOf("?");this.canonicalPath=e;var l=new RegExp("^"+A(o));this.path=e.replace(l,"")||"/";if(r)this.path=this.path.replace("#/","")||"/";this.title=x&&n.document.title;this.state=t||{};this.state.path=e;this.querystring=~s?i._decodeURLEncodedURIComponent(e.slice(s+1)):"";this.pathname=i._decodeURLEncodedURIComponent(~s?e.slice(0,s):e);this.params={};this.hash="";if(!r){if(!~this.path.indexOf("#"))return;var c=this.path.split("#");this.path=this.pathname=c[0];this.hash=i._decodeURLEncodedURIComponent(c[1])||"";this.querystring=this.querystring.split("#")[0]}}function F(e,t,a){var i=this.page=a||R;var n=t||{};n.strict=n.strict||i._strict;this.path=e==="*"?"(.*)":e;this.method="GET";this.regexp=r(this.path,this.keys=[],n)}E.prototype={configure:function e(t){var a=t||{};this._window=a.window||w&&window;this._decodeURLComponents=a.decodeURLComponents!==false;this._popstate=a.popstate!==false&&w;this._click=a.click!==false&&x;this._hashbang=!!a.hashbang;var i=this._window;if(this._popstate)i.addEventListener("popstate",this._onpopstate,false);else if(w)i.removeEventListener("popstate",this._onpopstate,false);if(this._click)i.document.addEventListener(_,this.clickHandler,false);else if(x)i.document.removeEventListener(_,this.clickHandler,false);if(this._hashbang&&w&&!k)i.addEventListener("hashchange",this._onpopstate,false);else if(w)i.removeEventListener("hashchange",this._onpopstate,false)},base:function e(t){if(0===arguments.length)return this._base;this._base=t},_getBase:function e(){var t=this._base;if(t)return t;var a=w&&this._window&&this._window.location;if(w&&this._hashbang&&a&&a.protocol==="file:")t=a.pathname;return t},strict:function e(t){if(0===arguments.length)return this._strict;this._strict=t},start:function e(t){var a=t||{};this.configure(a);if(false===a.dispatch)return;this._running=true;var i;if(S){var n=this._window;var r=n.location;if(this._hashbang&&~r.hash.indexOf("#/"))i=r.hash.substr(2)+r.search;else if(this._hashbang)i=r.search+r.hash;else i=r.pathname+r.search+r.hash}if(i===l.helper.rtrim(this._base,"/"))i=this._base;this.replace(i,null,true,a.dispatch)},stop:function e(){if(!this._running)return;this.current="";this.len=0;this._running=false;var t=this._window;this._click&&t.document.removeEventListener(_,this.clickHandler,false);w&&t.removeEventListener("popstate",this._onpopstate,false);w&&t.removeEventListener("hashchange",this._onpopstate,false)},show:function e(t,a,i,n){var r=this._toURL(t);t=r.pathname+r.search+r.hash;var o=new P(t,a,this);var s=this.prevContext;this.prevContext=o;this.current=o.path;if(false!==i)this.dispatch(o,s);if(false!==o.handled&&false!==n)o.pushState();return o},back:function e(t,a){var i=this;if(this.len>0){var n=this._window;k&&n.history.back();this.len--}else if(t)setTimeout(function(){i.show(t,a)});else setTimeout(function(){i.show(i._getBase(),a)})},redirect:function e(t,a){var i=this;if("string"===typeof t&&"string"===typeof a){var n=i._toURL(t);D.call(this,n.pathname+n.search+n.hash,function(e){setTimeout(function(){i.replace(a)},0)})}if("string"===typeof t&&"undefined"===typeof a)setTimeout(function(){i.replace(t)},0)},replace:function e(t,a,i,n){var r=this._toURL(t);t=r.pathname+r.search+r.hash;var o=new P(t,a,this);var s=this.prevContext;this.prevContext=o;this.current=o.path;o.init=i;o.save();if(false!==n)this.dispatch(o,s);return o},dispatch:function e(t,a){var i=0,n=0,r=this;if(false===l.helper.execCallback(r,null,document,[r,t,a],c(document),l.e.routeBeforeLeave,true,false))return;function o(){var e=r.exits[n++];if(!e)return s();e(a,o)}function s(){var e=r.callbacks[i++];if(t.path!==r.current){t.handled=false;return}if(!e)return I.call(r,t);e(t,s)}if(a)o();else s()},exit:function e(t,a){if(typeof t==="function")return this.exit("*",t);var i=new F(t,null,this);for(var n=1;n<arguments.length;++n)this.exits.push(i.middleware(arguments[n]))},clickHandler:function e(t,a){if(1!==this._which(t))return false;if(t.metaKey||t.ctrlKey||t.shiftKey)return false;if(t.defaultPrevented)return false;var i=t.target;var n=t.path||(t.composedPath?t.composedPath():null);if(n)for(var r=0;r<n.length;r++){if(!n[r].nodeName)continue;if(n[r].nodeName.toUpperCase()!=="A")continue;if(!n[r].href)continue;i=n[r];break}while(i&&"A"!==i.nodeName.toUpperCase())i=i.parentNode;if(!i||"A"!==i.nodeName.toUpperCase())return false;var o=_typeof(i.href)==="object"&&i.href.constructor.name==="SVGAnimatedString";if(i.hasAttribute("download")||i.getAttribute("rel")==="external")return false;var s=i.getAttribute("href");if(!this._hashbang&&this._samePath(i)&&(i.hash||"#"===s))return false;if(s&&s.indexOf("mailto:")>-1)return false;if(o?i.target.baseVal:i.target)return false;if(!o&&!this.sameOrigin(i.href))return false;var l=o?i.href.baseVal:i.pathname+i.search+(i.hash||"");l=l[0]!=="/"?"/"+l:l;if(C&&l.match(/^\/[a-zA-Z]:\//))l=l.replace(/^\/[a-zA-Z]:\//,"/");var c=l;var d=this._getBase();if(l.indexOf(d)===0)l=l.substr(d.length);if(this._hashbang)l=l.replace("#/","");if(d&&c===l&&(!S||this._window.location.protocol!=="file:"))return false;t.preventDefault();a!==false&&this.show(c);return c},_onpopstate:function(){var o=false;if(!w)return function(){};if(x&&document.readyState==="complete")o=true;else window.addEventListener("load",function(){setTimeout(function(){o=true},0)});return function e(t){if(!o)return;var a=this;if(false===l.helper.execCallback(a,null,document,[this,t],c(document),l.e.routePopState,true,false))return;if(t.state){var i=t.state.path;var n=t.state.popStateDispatch;a.replace(i,t.state,undefined,n);if(n===false)l.helper.execCallback(a,null,document,[this,t],c(document),l.e.routeNoDispatch)}else if(S){var r=a._window.location;a.show(r.pathname+r.search+r.hash,undefined,undefined,false)}}}(),_which:function e(t){t=t||w&&this._window.event;return null==t.which?t.button:t.which},_toURL:function e(t){var a=this._window;if(typeof URL==="function"&&S)return new URL(t,a.location.toString());else if(x){var i=a.document.createElement("a");i.href=t;return i}},sameOrigin:function e(t){if(!t||!S)return false;var a=this._toURL(t);var i=this._window;var n=i.location;return n.protocol===a.protocol&&n.hostname===a.hostname&&(n.port===a.port||n.port===""&&(a.port==80||a.port==443))},_samePath:function e(t){if(!S)return false;var a=this._window;var i=a.location;return t.pathname===i.pathname&&t.search===i.search},_decodeURLEncodedURIComponent:function e(t){if(typeof t!=="string")return t;return this._decodeURLComponents?decodeURIComponent(t.replace(/\+/g," ")):t},reload:function e(){var t=this._window.location;var a=t.pathname+t.search+t.hash;this.replace(a)}},P.prototype={pushState:function e(){var t=this.page;var a=t._window;var i=t._hashbang;t.len++;if(k)a.history.pushState(this.state,this.title,i&&this.path!=="/"?"#/"+this.path:this.canonicalPath)},save:function e(){var t=this.page;if(k)t._window.history.replaceState(this.state,this.title,t._hashbang&&this.path!=="/"?"#/"+this.path:this.canonicalPath)}},F.prototype={middleware:function e(a){var i=this;return function(e,t){if(i.match(e.path,e.params)){e.routePath=i.path;return a(e,t)}t()}},match:function e(t,a){var i=this.keys,n=t.indexOf("?"),r=~n?t.slice(0,n):t,o=this.regexp.exec(decodeURIComponent(r));if(!o)return false;delete a[0];for(var s=1,l=o.length;s<l;++s){var c=i[s-1];var d=this.page._decodeURLEncodedURIComponent(o[s]);if(d!==undefined||!hasOwnProperty.call(a,c.name))a[c.name]=d}return true}};var R=T(),M=R,L;return M.default=R,l.route=M,l.regSugar("route",function(e,t,a){var i=l.e,i=[i.requestSuccess,i.requestError,i.requestComplete,i.formSuccess,i.formError,i.formComplete];-1!==["redirect","jump","go"].indexOf(e=e||"reload")&&(e="show"),t||-1===i.indexOf(e)||(t=(a.args[0]||{}).url||""),"show"!==e||t||(t=M.base()),M[e](t)}),M}),define("./ba/plug/audioViewer",["busyAdmin","jquery"],function(r,o){var s="audio-viewer",l=r.helper,e=l.pluginKey(s);r.e.audioViewerInitialized=r.ee("initialized",s);var t=function e(t,a){var i=this;i.element=t;i.$element=o(t);i.options=o.extend(true,{},e.DEFAULTS,i.$element.baData(s)||{},a||{});var n=i.options;i.$element.baModal({show:false,className:"ba-audio-viewer-dialog",content:'<audio src="'+n.src+'"></audio>',footer:false,title:n.title||"预览音频",ok:false,cancel:"关闭",type:"page",onReady:function e(t){i.$audio=t.$dialogBody.find("audio");i.$audio.baAudio({autoplay:n.autoplay,type:n.type,poster:n.poster,artist:n.artist}).baAudio("ready",function(){i.audio=this;t.resetView()})}},true);l.triggerPluginReady(i.$element,i,"",r.e.audioViewerInitialized)};function a(e){return l.pluginFn(this,t,e,arguments,"audio",function(){this.options.show&&this.show()})}return t.prototype={show:function(){this.$element.baModal("show")},hide:function(){this.$element.baModal("hide")},getAudio:function(){return this.audio},destroy:function(){this.audio=null}},t.KEY=e,t.DEFAULTS={show:!0,title:"",src:"",type:"",poster:"",artist:"",autoplay:!0},o.fn.baAudioViewer=a,o.fn.baAudioViewer.Constructor=t,r.plugins.AudioViewer=t,o("body").on("click."+e,l.pluginAttrs(s),function(e){a.call(o(this))}),t}),define("./ba/plug/audio",["busyAdmin","jquery"],function(o,s){var l,c="audio",d="abort,canplay,canplaythrough,durationchange,emptied,ended,error,loadeddata,loadedmetadata,loadstart,mozaudioavailable,pause,play,playing,progress,ratechange,seeked,seeking,stalled,suspend,timeupdate,volumechange,waiting,listshow,listhide,listadd,listremove,listswitch,listclear,noticeshow,noticehide,destroy,lrcshow,lrchide".split(","),u=o.helper,p=o.e,f=o.ee,h=s.baIsEmpty,e=u.pluginKey(c);s.map(d,function(e){p[u.camel("audio_"+e)]=f(e,c)}),p.audioInitialized=f("initialized",c);var t=function e(t,a){var i=this;i.element=t;i.$element=s(t);i.options=s.extend(true,{},e.DEFAULTS,i.$element.baData(c)||{},a||{});i.destroyed=false;i.ready(i._init)};function a(e){return o.helper.pluginFn(this,t,e,arguments,"api")}return t.prototype={ready:function(a){var i=this;l&&Hls?a.call(i):requirejs([o.lib.APlayer,o.lib.hls],function(e,t){window.Hls=t,l=e,a.call(i)})},_init:function(){var a=this,i=a.options,n=a.$element,r=a.element,e=s.proxy(a.destroy,a);s(document).one(p.appRenderBefore,e);var t=n.closestBaModal();t&&t.$element.one(p.modalHided,e),n.wrap('<div class="ba-audio" />'),a.$wrap=n.parent(),a.$player=s("<div />"),a.$wrap.append(a.$player),"audio"===r.tagName.toLowerCase()&&(a.isAudio=!0,n.find("source").each(function(){var e=s(this),t=e.attr("src"),e=e.attr("type");if(t)return i.src=i.src||t,i.type=i.type||e,!1}),h(i.autoplay)&&(i.autoplay=!!r.hasAttribute("autoplay")||null),h(i.muted)&&(i.muted=!!r.hasAttribute("muted")||null),h(i.loop)&&(i.loop=r.hasAttribute("loop")?"all":null),h(i.preload)&&(i.preload=r.getAttribute("preload"))),i.src=i.src||n.attr("src")||"",i.type=i.type||n.attr("type")||"",i.title=i.title||n.attr("title")||"",i.loop=i.loop||"all",i.preload=i.preload||"auto";e="boolean";_typeof(i.autoplay)!==e&&(i.autoplay=!1),_typeof(i.muted)!==e&&(i.muted=!1);e=i.audio||[];i.src&&e.unshift({name:i.title,url:i.src,cover:i.poster,lrc:i.lrc}),e.map(function(e){e.artist=e.artist||"未知艺人",e.name=e.name||u.parseURL(e.url).filename||"未知音乐",e.cover=e.cover||o.imagesRoot()+"audio-cover.png?v="+o.config.version,e.type=e.type||"auto"}),a.api=new l({container:a.$player[0],fixed:i.fixed,mini:i.mini,autoplay:i.autoplay,loop:i.loop,order:i.order,preload:i.preload,audio:e,mutex:i.mutex,lrcType:i.lrcType,listFolded:i.listFolded,listMaxHeight:i.listMaxHeight,storageName:i.storageName,volume:i.muted?0:s.isNumeric(i.volume)?i.volume:.7}),d.map(function(t){a.api.on(t,function(){"play"===t?a.playing=!0:"pause"===t&&(a.playing=!1);var e=Array.prototype.slice.call(arguments);e.shift(),e.unshift(a.api),u.execCallback(a,i[u.camel("on_"+t)],r,e,n,f(t,c))})}),u.triggerPluginReady(n,a,"",p.audioInitialized)},getApi:function(){return this.api},destroy:function(){var e=this;e.api&&(e.playing&&e.api.pause(),e.api.destroy(),e.api=null),e.$wrap.after(e.$element),e.$wrap.remove(),e.playing=!1}},t.KEY=e,t.DEFAULTS={src:"",type:"",poster:"",artist:"",lrc:"",title:"",audio:[],muted:null,autoplay:null,loop:null,preload:null,volume:null,fixed:!1,mini:!1,order:"list",mutex:!0,lrcType:0,listFolded:!1,listMaxHeight:null,storageName:"ba.audio.state"},s.fn.baAudio=a,s.fn.baAudio.Constructor=t,o.plugins.Audio=t,o.autoInit(c,u.pluginAttrs(c),function(){a.call(this)}),t}),define("./ba/plug/autocomplete",["busyAdmin","jquery"],function(s,l){var n=s.e,c=s.helper,r="autocomplete",e=c.pluginKey(r),t=function e(t,a){var i=this;i.element=t;i.$element=l(t);i.options=l.extend(true,{},e.DEFAULTS,i.$element.baData(r),a||{});i.ready(i._init)};function a(e){return c.pluginFn(this,t,e,arguments,"api")}return t.prototype={ready:function(e){var t=this;window.autoComplete?e.call(t):requirejs([s.lib.autocomplete],function(){e.call(t)})},_init:function(){var r=this,o=r.options,e=l.proxy(r.destroy,r);l(document).one(n.appRenderBefore,e);var t=r.$element.closestBaModal();t&&(t.$element.one(n.modalHide,e),o.container||(o.container=t.$container[0])),r.api=new window.autoComplete({container:o.container||document.body,selector:r.element,delay:o.delay,minChars:o.searchMin,menuClass:"ba-autocomplete",onSelect:function(e,t,a){c.execCallback(r,o.onSelect,r.element,[t,l(a)],r.$element,n.autocompleteSelect)},source:function(e,n){if(o.url||o.model)r._abort(),r.task=s.request(o.model?s.getConfig("autocomplete").url:"function"==typeof o.url?o.url():o.url).method(o.method).addHeader("Busy-Admin-Plugin","Autocomplete").params({model:o.model,extend:o.modelExtend?1:0,text_field:o.modelTextField||"",order:o.modelOrder||"",limit:o.modelLimit,word:e}).pending(!1).success(function(e,t,a){var i=[];return l.each(e.result.results||[],function(){var e=(this.text||"").trim();e&&i.push(e)}),n(i),!1}).error(function(e,t,a){return!1}).exec();else{var t=o.list||[],a=[];for(i=0;i<t.length;i++)-1!==t[i].toLowerCase().indexOf(e)&&a.push(t[i]);n(a)}}}),c.triggerPluginReady(r.$element,r,"",n.autocompleteInitialized)},_abort:function(){this.task&&(this.task.abort(),this.task=null)},destroy:function(){this._abort(),this.api&&(this.api.destroy(),this.api=null)}},t.KEY=e,t.DEFAULTS={container:null,list:[],searchMin:1,method:"get",url:!1,delay:250,model:"",modelExtend:!1,modelTextField:"",modelOrder:"",modelLimit:20},l.fn.baAutocomplete=a,l.fn.baAutocomplete.Constructor=t,s.plugins.Autocomplete=t,n.autocompleteInitialized=s.ee("initialized",r),n.autocompleteSelect=s.ee("select",r),s.autoInit(r,c.pluginAttrs(r),function(){a.call(this)}),t}),define("./ba/plug/calendar",["busyAdmin","jquery"],function(a,n){var i=false,r=a.helper,o="calendar",e=r.pluginKey(o);a.e.calendarInitialized=a.ee("initialized",o);var s=function e(t,a){var i=this;i.element=t;i.$element=n(t);i.options=n.extend(true,{},e.DEFAULTS,i.$element.baData(o)||{},a||{});i.ready(i._init)};function t(e){return r.pluginFn(this,s,e,arguments,"api")}return s.prototype={ready:function(e){var t=this;i?e.call(t):requirejs([a.lib.fullcalendar],function(){i=!0,e.call(t)})},_init:function(){var e=this;e.$element.addClass("ba-calendar");var t=e.options;t.themeSystem="bootstrap",t.locale="zh-cn","string"!=typeof t.headerToolbar&&t.headerToolbar||(t.headerToolbar&&s.TOOLBARS.hasOwnProperty(t.headerToolbar)||(t.headerToolbar="default"),t.headerToolbar=s.TOOLBARS[t.headerToolbar]),e.api=new FullCalendar.Calendar(e.element,t),e.api.render(),r.triggerPluginReady(e.$element,e,"",a.e.calendarInitialized)},getApi:function(){return this.api},destroy:function(){this.$element.removeClass("ba-calendar"),this.api&&(this.api.destroy(),this.api=null)}},s.KEY=e,s.DEFAULTS={headerToolbar:"default",selectable:!0,initialView:"dayGridMonth",locale:"zh-cn"},s.TOOLBARS={default:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay,listWeek"},mini:{left:"prev,next",center:"title",right:"today"}},n.fn.baCalendar=t,n.fn.baCalendar.Constructor=s,a.plugins.Calendar=s,a.autoInit(o,r.pluginAttrs(o),function(){t.call(this)}),s}),define("./ba/plug/catalog",["busyAdmin","jquery","bootstrap"],function(r,s,e){"use strict";var i=false,l=r.helper,n="catalog",t=l.pluginKey(n);r.e.catalogInitialized=r.ee("initialized",n);var a=function e(t,a){this.$element=s(t);this.options=s.extend(true,{},e.DEFAULTS,this.$element.baData(n)||{},a||{});this.scrollSelector=null;this.ready(this._init)};function o(e){return l.pluginFn(this,a,e,arguments)}return a.prototype={ready:function(t){var a=this;i?t.call(a):requirejs([r.lib.sticky],function(e){i=!0,t.call(a)})},_init:function(){var i=this;i.id=l.uuid();var e=i.$element,n=i.options;n.container&&(e=s(n.container)),e.find(i.getId()).remove(),e.append(i.create()),n.scroll&&(i.scrollSelector=n.scroll,!0===n.scroll&&(i.scrollSelector=document.body),s(i.scrollSelector).scrollspy({target:this.getId(),offset:this.options.top})),n.sticky&&s(i.scrollSelector).is("body")&&s(i.getId()).sticky({topSpacing:this.options.top||0,bottomSpacing:this.options.bottom||0}),e.find(".nav a").on("click",function(e){e.preventDefault();var t=s(this).attr("href");if(0!==t.indexOf("#"))return!0;var a=s(t),e=s(i.scrollSelector),t=a.position().top;return e.is("body")&&(e=s("body,html"),t=a.offset().top),i.isScrollPending=!0,e.animate({scrollTop:t-(n.top||0)},function(){i.isScrollPending=!1}),!1}),s(document).one(r.e.appRenderBefore,s.proxy(i.destroy,i)),l.triggerPluginReady(i.$element,i,"",r.e.catalogInitialized)},create:function(){var e=this.$element.find("h1,h2,h3,h4,h5,h6"),r=[],o=this.options;e.each(function(e){var t=s(this);if(o.filterSelector&&0<t.closest(o.filterSelector).length)return!0;var a=this.tagName.charAt(1),i=(t.attr("id")||"").trim(),n=t.text().trim();if(!n)return!0;i=(i=l.base64Encode(n+":"+a+"_"+e)).replace(/[=\/+]/g,""),t.attr("id",i),r.push({name:n,id:i,level:a})});var t=function e(t){var a='<ul class="nav">';return s.each(t,function(){a+='<li><a href="#'+this.id+'">'+this.name+"</a>"+(this.children?e(this.children):"")+"</li>"}),a+="</ul>"}(this.toTree(r)),e="";return o.title&&(e='<div class="panel-heading ba-catalog-title">'+o.title+"</div>"),'<div class="panel panel-default ba-catalog" id="'+this.id+'">'+e+t+"</div>"},toTree:function(e){var t=[];return function e(t,a){var i=a.shift();for(t.push(i);0<a.length;){if(!i)return;var n=function(e,t){if(e){for(var a=-e.level,i=[],n=0,r=t.length;n<r;n++){var o=t[n];if(!(-o.level<a))break;i.push(o)}return 0<i.length&&t.splice(0,i.length),i}}(i,a,i.level);0!=n.length?(i.children=[],e(i.children,n)):(i=a.shift())&&t.push(i)}}(t,e),t},getId:function(){return"#"+this.id},destroy:function(){var e=this.options;e.scroll&&s(this.scrollSelector).removeData("bs.scrollspy"),e.sticky&&s(this.getId()).unstick()}},a.KEY=t,a.DEFAULTS={title:"目录",container:null,scroll:null,sticky:!1,top:0,bottom:0,filterSelector:null},s.fn.baCatalog=o,s.fn.baCatalog.Constructor=a,r.plugins.Catalog=a,r.autoInit(n,l.pluginAttrs(n),function(){o.call(this)}),a}),define("./ba/plug/changeVerify",["busyAdmin","jquery"],function(e,i){"use strict";var t=e.helper,n="change-verify",a=t.pluginKey(n),r=function e(t,a){this.$element=i(t);this.options=i.extend(true,{},e.DEFAULTS,this.$element.baData(n)||{},a||{});this.source=this.$element.attr("src")};function o(e){return t.pluginFn(this,r,e,arguments,null,function(){this.options.change&&this.change()})}return r.prototype={change:function(){var e=this.source;-1===e.indexOf("?")?e+="?":e+="&",this.$element.attr("src",e+"__rand__t="+Math.random())},destroy:function(){}},r.KEY=a,r.DEFAULTS={change:!0},i.fn.baChangeVerify=o,i.fn.baChangeVerify.Constructor=r,e.plugins.ChangeVerify=r,i("body").on("click."+a,t.pluginAttrs(n),function(e){o.call(i(this))}),r}),define("./ba/plug/checkboxRadio",["busyAdmin","jquery"],function(s,l){var c=s.helper,e=c.pluginKey("checkbox-radio");s.e.checkboxRadioInitialized=s.ee("initialized","checkbox-radio");var d=function e(t,a){var i=this;i.element=t;i.$element=l(t);if(i.element.tagName.toLowerCase()!=="input")return;var n=i.elementType=(i.$element.attr("type")||"").toLowerCase();if(n!=="checkbox"&&n!=="radio")return;i.isRadio=n==="radio";i.options=l.extend(true,{},e.DEFAULTS,i.$element.baData(n)||{},a||{});i._init()};function t(e){return c.pluginFn(this,d,e,arguments)}return d.prototype={_init:function(){var i=this,n=i.$element,r=i.options,e=i.elementType;r.title||(r.title=n.attr("title")||"");var t=n.attr("id")||"__ba_checkbox_radio_"+d.INDEX++;n.attr("id",t),i.$icon=l('<i class="bicon" />'),i.$text=l("<span />"),i.$label=l('<label for="'+t+'" />'),i.$label.append(i.$icon),i.$label.append(i.$text);var a=[],o="";l.each((n.attr("class")||"").split(" "),function(e,t){(t=t.trim()).length&&a.push(t)}),-1===a.indexOf("pill")&&-1===a.indexOf("switch")?(a.push("default"),o="default"):-1!==a.indexOf("pill")?o="pill":-1!==a.indexOf("switch")&&(o="switch");t=n.closest("."+e+"-group");0<t.length&&t.addClass(o),i.$template=l('<div class="ba-'+e+" "+a.join(" ")+'"/>'),i.$template.append(i.$label),i.isSwitch=n.hasClass("switch"),i.switchOn="",i.switchOff="",i.isSwitch?(e=r.title||"",l.isArray(e)||-1===e.indexOf(",")||(e=e.split(",")),l.isArray(e)&&(i.switchOn=e[0]||r.locale.on,i.switchOff=e[1]||r.locale.off),i.$text.html(n.prop("checked")?i.switchOn:i.switchOff)):r.title?(i.$text.html(r.title),i.$template.removeClass("untitled")):(i.$text.addClass("hide"),i.$template.addClass("untitled")),i.requestOptions={},r.url&&(l.extend(!0,i.requestOptions,r),i.requestOptions.headers=l.extend({},i.requestOptions.headers||{},{"Busy-Admin-Plugin":i.isRadio?"Radio":"Checkbox"}),i.requestOptions.params=i.requestOptions.params||{},n.on(s.e.requestError,function(){n.prop("checked",!l(this).prop("checked")).baTriggerEvent("change",{__checkboxRadioNoRequest:!0})})),n.after(i.$template),i.$template.prepend(n),n.on("change",function(e){i._decorate();var t=this.hasAttribute("value"),a=l(this);r.url&&!(e.getBaTriggerParams()||{}).__checkboxRadioNoRequest&&(i.requestOptions.params.status=n.prop("checked")?1:0,i.requestOptions.params.value=t?a.val():"",n.baRequest(i.requestOptions,!0))}),i._decorate(),c.triggerPluginReady(n,i,"",s.e.checkboxRadioInitialized)},_decorate:function(){var e=this,t=e.$element.prop("checked");e.isSwitch&&e.$text.html(t?e.switchOn:e.switchOff)},destroy:function(){this.$template.after(this.$element),this.$template.remove()}},d.INDEX=0,d.KEY=e,d.DEFAULTS={title:"",url:void 0,locale:l.extend({},{on:"开启",off:"关闭"},((s.locale||{}).plugin||{}).checkboxRadio||{})},l.fn.baCheckboxRadio=t,l.fn.baCheckboxRadio.Constructor=d,s.plugins.CheckboxRadio=d,s.autoInit("checkboxRadio",[c.pluginAttrs("checkbox"),c.pluginAttrs("radio")].join(","),function(){t.call(this)}),d}),define("./ba/plug/checkedAll",["busyAdmin","jquery"],function(e,u){"use strict";var t=e.helper.pluginAttrs("checked-all").replace(/\[/g,"input[");u("body").on("change.ba-checked-all",t,function(e){var t=u(this);var a=t.prop("checked");var i=t.attr("data-parent");var n=t.attr("data-child");if(n&&(e.getBaTriggerParams()||{}).__CheckedAllChildNoChange!==true)u("input"+n).not(":disabled").prop("checked",a).baTriggerEvent("change");if(i){var r=true;var o=0;var s=0;var l=u("input"+i);var c=l.data()||{};var d=l.attr("data-child");if(!d)return;u("input"+c.child).each(function(){var e=u(this);if(e.prop("disabled"))return true;var t=e.prop("checked");if(!t&&!this.indeterminate)r=false;if(t)o++;if(this.indeterminate)s++});if(o===0&&s===0){l.each(function(){this.indeterminate=false;u(this).removeClass("indeterminate")});l.prop("checked",false)}else if(!r||s!==0){l.each(function(){this.indeterminate=true;u(this).addClass("indeterminate")});l.prop("checked",false)}else{l.each(function(){this.indeterminate=false;u(this).removeClass("indeterminate")});l.prop("checked",true)}l.baTriggerEvent("change",{__CheckedAllChildNoChange:true})}}),e.autoInit("checkedAll",t,function(){var a="ba.checked-all.api";var i=[];var n=[];u(this).each(function(){var e=u(this);if(e.data(a))return true;e.data(a,true);var t=e.data()||{};if(t.parent&&e.prop("checked")&&-1===i.indexOf(t.parent)){e.baTriggerEvent("change",{__CheckedAllChildNoChange:true});i.push(t.parent)}if(t.child&&e.prop("checked")&&-1===n.indexOf(t.child)){e.baTriggerEvent("change");n.push(t.child)}})})}),define("./ba/plug/colorPicker",["busyAdmin","jquery"],function(s,l){"use strict";var c=s.helper,d=s.e,u=s.ee,p="color-picker",a=false,n=c.pluginKey(p),e="create,showPicker,hidePicker,changeColor,disable,enable".split(",");d.colorPickerInitialized=u("initialized",p),d.colorPickerClear=u("clear",p),e.map(function(e){d[c.camel(p+"_"+e)]=u(e,p)});var t=function e(t,a){var i=this;i.$element=l(t);i.options=l.extend(true,{},e.DEFAULTS,i.$element.baData(p)||{},a||{});i.$form=i.$element.closest("form");i.api=null;i.index=e.INDEX++;i.formStatus=i.$element.baFormStatus(i).render();i.defaultValue=i.options.color;i.resetEvent="reset."+n+i.index;i.$form.on(i.resetEvent,function(){setTimeout(function(){i.setValue(i.defaultValue)},1)});i.ready(i._init)};function i(e){return c.pluginFn(this,t,e,arguments)}return t.INDEX=0,t.prototype={ready:function(e){var t=this;a?e.call(t):requirejs([s.lib.colorPicker],function(){a=!0,e.call(t)})},_init:function(){var n=this,r=n.$element,o=n.options;o.hexNumberSignPrefix=o.hexPrefix,o.colorSelectors=o.selectors,o.customClass="ba-color-picker"+(o.className||""),o.inline&&(o.container=!0),o.sliders={saturation:{maxLeft:150,maxTop:150},hue:{maxTop:150},alpha:{maxTop:150}};var e=l.proxy(n.destroy,n);l(document).one(d.appRenderBefore,e);var t=r.closestBaModal();t&&t.$element.one(d.modalHide,e),o.template='<div class="colorpicker dropdown-menu">    <div class="colorpicker-saturation"><i><b></b></i></div>    <div class="colorpicker-hue"><i></i></div>    <div class="colorpicker-alpha"><i></i></div>    <div class="colorpicker-color"><div></div></div>    <div class="colorpicker-selectors clearfix"></div>    <div class="colorpicker-operate"><button class="btn btn-default btn-xs" type="button">清空</button></div></div>',n.api=r.colorpicker(o).data("colorpicker"),r.on("create showPicker hidePicker changeColor disable enable destroy",function(e){var t,a=[n],i=n.api;"changeColor"===e.type?(a=[n,i.color],i.hasInput()&&i.input.baTriggerEvent("input")):"create"===e.type&&(t=i.picker.find(".colorpicker-operate"),i.hasInput()?(n.defaultValue=n.defaultValue||i.input.val().trim(),t.removeClass("hide"),t.find("button").on("mousedown",function(e){e.preventDefault()}).on("click",function(e){n.setValue(),i.input.blur(),c.execCallback(n,o.onClear,n.element,[],r,d.colorPickerClear),i.hide()})):t.addClass("hide"),s.app.triggerResize(),n.formStatus.rendered()),c.execCallback(n,o[c.camel("on_"+e.type)],n.element,a,r,u(e.type,p))}),c.triggerPluginReady(r,n,"",d.colorPickerInitialized)},setValue:function(e){this.api&&(this.api.setValue(e||"transparent"),!e&&this.api.hasInput()&&this.api.input.val(""))},destroy:function(){var e=this;e.api&&(e.api.destroy(),e.api=null),e.$form.off(e.resetEvent)}},t.KEY=n,t.DEFAULTS={format:"hex",color:!1,component:".add-on, .input-group-addon",input:"input",hexPrefix:!0,inline:!1,container:!1,align:"left",selectors:null,className:""},l.fn.baColorPicker=i,l.fn.baColorPicker.Constructor=t,s.plugins.ColorPicker=t,s.autoInit(p,c.pluginAttrs(p),function(){i.call(this)}),t}),define("./ba/plug/consoleLog",["busyAdmin","jquery"],function(e,r){"use strict";var o=e.helper,t=e.ee,s=e.e,n="console-log",a=o.pluginKey(n);s.consoleLogInitialized=t("initialized",n),s.consoleLogOk=t("ok",n),s.consoleLogCancel=t("cancel",n),s.consoleLogHide=t("hide",n);var l=function e(t,a){var i=this;i.element=t;i.$element=r(t);i.options=r.extend(true,{},e.DEFAULTS,i.$element.baData(n)||{},a||{});i.disabled=false;i._init()};function i(e){return o.pluginFn(this,l,e,arguments,null,function(){this.options.show&&this.show()})}return l.prototype={_init:function(){var i=this,e=i.options,t=e.locale,a=i.$element,n=i.element;!r.baIsEmpty(e.title)&&""!==e.title||(e.title=a.attr("title")||""),""===e.title&&(e.title=t.title),r(document).one(s.appRenderBefore,function(){i.destroy()}),a.baModal({show:!1,content:l.TEMPLATE,className:"ba-console-log-dialog",padding:0,title:e.title,ok:!1!==e.ok&&(e.ok||t.ok),cancel:e.cancel||t.cancel,type:"page",onReady:function(e){var t=e.$container;i.$progress=t.find(".progress").hide(),i.$progressBar=t.find(".progress-bar"),i.$text=t.find(".ba--text"),i.$content=t.find(".ba--content"),i.$title=t.find(".ba--title"),i.$loader=t.find(".ba-loader"),i.$refreshBtn=r('<button type="button" class="btn btn-outline-secondary"><i class="fa fa-refresh"></i></button>'),i.$wrapBtn=r('<button type="button" class="btn btn-outline-secondary"><i class="fa fa-text-height"></i></button>'),i.$ok=e.$okBtn,i.$content.on("mouseover",function(){i.mouse=!0}).on("mouseout",function(){i.mouse=!1}).on("scroll",function(e){clearTimeout(i.scrollTimer),i.scrollTimer=setTimeout(function(){i.disabled=i.$text.height()>i.$content.scrollTop()+i.$content.height()},10)}),i.load(!0),e.$dialogFooter.prepend(r('<div class="btn-group"/>').append(i.$refreshBtn).append(i.$wrapBtn)),i.$refreshBtn.on("click.ba",function(){i.refresh()});var a=i.$wrapBtn;a.on("click.ba",function(){var e=a.find("i").removeClass("fa-text-width fa-text-height");a.removeClass("btn-outline-secondary btn-primary"),i.$text.hasClass("ba--wrap")?(a.addClass("btn-outline-secondary"),e.addClass("fa-text-height"),i.$text.removeClass("ba--wrap")):(a.addClass("btn-primary"),e.addClass("fa-text-width"),i.$text.addClass("ba--wrap"))})},onOk:function(){e.okUrl&&(e.okBlank?window.open(e.okUrl):self.location.href=e.okUrl),o.execCallback(i,e.onOk,n,[i.result],a,s.consoleLogOk)},onCancel:function(){o.execCallback(i,e.onCancel,n,[],a,s.consoleLogCancel)},onHide:function(){o.execCallback(i,e.onHide,n,[],a,s.consoleLogHide),i.destroy()}},!0),o.triggerPluginReady(a,i,"",s.consoleLogInitialized)},load:function(r){var o=this;r&&(o.$loader.show(),o.$ok.prop("disabled",!0).addClass("disabled")),o.task=e.request(e.getConfig("consoleLog").url).addHeader("Busy-Admin-Plugin","ConsoleLog").params({id:o.options.id}).pending(!1).complete(function(){o.$loader.hide()}).success(function(e){var t=o.result=e.result,a=2==t.type||3==t.type;o.setTitle(t.message,t.level),t.progress?(o.$progress.show(),e=t.percentage,e=Math.max(e,0),e=Math.min(e,100),o.$progressBar.toggleClass("no-transition",100<=e).addClass("progress-bar-striped active").css("width",e+"%").text(e.toFixed(2)+"%"),a&&o.$progressBar.removeClass("progress-bar-striped active")):o.$progress.hide(),o.resetView(),r&&o.$text.empty();var i="",n=0;return t.list.map(function(e){var t;e.back.map(function(e){o.remove(e)}),!1!==e.percentage?(n=Math.min(e.percentage,100),4==(t=(n=Math.max(n,0)).toFixed(2)).length?t="00"+t:5==t.length&&(t="0"+t),i="[ "+t+"% ] "):100<=n&&(i=""),o.append(e.id,e.message.replace(/\n/g,"<br />"),e.level,i)}),o.toBottom(),a?(clearTimeout(o.timer),2==t.type&&o.$ok.prop("disabled",!1).removeClass("disabled")):o._countdown(),!1}).error(function(e){return r&&o.$text.empty(),4010001===e.code?o.append("",e.message,"record"):(o._countdown(),o.append("",e.message,"error"),o.setTitle(e.message,"error"),o.toBottom(),o.resetView()),!1}).exec()},show:function(){this.$element.baModal("show")},close:function(){this.$element.baModal("close")},setTitle:function(e,t){this.$element.baModal("setTitle",this.options.title+'<small><span class="ba--'+t+'">'+e+"</span></small>")},resetView:function(){this.$element.baModal("resetView")},append:function(e,t,a,i){this.$text&&((e=e||"")&&(this.remove(e),e="console_log_"+e),t=t.replace(/<([a-z]+)>(.*?)<\/([a-z]+)>/gi,'<span class="ba--$1">$2</span>'),this.$text.append('<div id="'+e+'">'+(i||"")+'<span class="ba--line ba--'+(a||"record")+'">'+t+"</span></div>"))},remove:function(e){this.$text&&this.$text.find("#console_log_"+e).remove()},toBottom:function(){this.$content&&!this.disabled&&this.$content.scrollTop(this.$text.height())},refresh:function(){this._clear(),this.load(!0)},_countdown:function(){var e=this;clearTimeout(e.timer),e.timer=setTimeout(function(){e.load()},50)},_clear:function(){var e=this;e.result=null,e.disabled=!1,clearTimeout(e.timer),clearTimeout(e.scrollTimer),e.task&&(e.task.abort(),e.task=null)},destroy:function(){this._clear()}},l.TEMPLATE='<div class="ba-console-log"><div class="progress"><div class="progress-bar progress-bar-success" style="width: 0">0%</div></div><div class="ba--content"><div class="ba--text"></div></div></div><div class="ba-loader ba-loader-inline"><div></div></div>',l.KEY=a,l.DEFAULTS={title:null,ok:null,okUrl:null,okBlank:!1,cancel:null,onOk:null,onCancel:null,onHide:null,show:!0,locale:r.extend({},{title:"执行日志",ok:"完成",cancel:"关闭"},((e.locale||{}).plugin||{}).consoleLog||{})},r.fn.baConsoleLog=i,r.fn.baConsoleLog.Constructor=l,e.plugins.ConsoleLog=l,e.regSugar(n,function(e,t,a){(e="show"===e?"":e)?r(this).baConsoleLog(e,t):(t||-1===[s.requestSuccess,s.formSuccess].indexOf(a.event)||(a=((a.args[0]||{}).result||{}).console_log||!1)&&(t={id:a.id,okUrl:a.operate_url||null,okBlank:a.operate_blank||!1},a.operate_name&&(t.ok=a.operate_name)),r(this).baConsoleLog("object"===(void 0===t?"undefined":_typeof(t))?t:{},!0))}),r("body").on("click."+a,o.pluginAttrs(n),function(){i.call(r(this))}),l}),define("./ba/plug/copy",["busyAdmin","jquery"],function(o,s){var l=null,c=o.helper,d=o.e,e=o.ee,n="copy",t=c.pluginKey(n),a=function e(t,a){var i=this;i.element=t;i.$element=s(t);i.options=s.extend(true,{},e.DEFAULTS,i.$element.baData(n)||{},a||{});i.ready(i._init)};function i(e){return c.pluginFn(this,a,e,arguments,"api")}return a.prototype={ready:function(t){var a=this;l?t.call(a):requirejs([o.lib.clipboard],function(e){l=e,t.call(a)})},_init:function(){var a=this,i=a.options,n=a.$element,r=a.element,e={action:function(){return i.action||"copy"},text:function(e){var t="",e=s(e);return i.content?t=i.content:i.target&&(t=!0===i.target?a.getText(e):a.getText(s(i.target))),"html"===i.onDecode?t=c.escapeToHtml(t):"string"==typeof(e=c.execCallback(a,i.onDecode,r,[t],n,d.copyDecode,!0,"string",!0))&&(t=e),t}};i.target&&!0!==i.target&&(e.target=function(e){return s(i.target)[0]}),a.api=new l(r,e),a.api.on("success",function(e){e.clearSelection(),"cut"===i.action&&i.target&&(!0===i.target?n:s(i.target)).val(""),!1!==c.execCallback(a,i.onSuccess,r,[],n,d.copySuccess,!0,!1)&&o.dialog.toast("cut"===i.action?i.locale.cutSuccess:i.locale.copySuccess)}),a.api.on("error",function(){!1!==c.execCallback(a,i.onError,r,[],n,d.copyError,!0,!1)&&o.dialog.toast("cut"===i.action?i.locale.cutError:i.locale.copyError)}),c.triggerPluginReady(n,a,"",d.copyInitialized)},getApi:function(){return this.api},getText:function(e){e=e.is(":text")?e.val():e.html();return e},destroy:function(){this.api&&this.api.destroy()}},a.KEY=t,a.DEFAULTS={target:null,onDecode:null,onSuccess:null,onError:null,locale:s.extend({copySuccess:"复制成功",copyError:"复制失败",cutSuccess:"剪切成功",cutError:"剪切失败"},((o.locale||{}).plugin||{}).copy||{})},s.fn.baCopy=i,s.fn.baCopy.Constructor=a,o.plugins.Copy=a,d.copyInitialized=e("initialized",n),d.copySuccess=e("success",n),d.copyError=e("error",n),d.copyDecode=e("decode",n),o.autoInit(n,c.pluginAttrs(n),function(){i.call(this)}),a}),define("./ba/plug/datePicker",["busyAdmin","jquery"],function(i,U){"use strict";var q,Y=i.helper,H=Y.sprintf,e=i.ee,V=i.e,r="date-picker",n=Y.pluginKey(r),W=function e(t){return t+"."+n},t=function e(t,a,i){var n=this;n.parentEl="body";n.element=U(t);n.minDate=false;n.maxDate=false;n.maxSpan=false;n.singleDatePicker=false;n.showDropdowns=true;n.showWeekNumbers=false;n.showISOWeekNumbers=false;n.showCustomRangeLabel=true;n.timePicker=false;n.timePicker24Hour=true;n.timePickerIncrement=1;n.timePickerSeconds=true;n.timePickerMinute=true;n.linkedCalendars=false;n.autoUpdateInput=false;n.alwaysShowCalendars=false;n.pickerType="date";n.ranges={};n.moveTimer=null;n.valueTarget=null;n.hideClearBtn=false;n.force=false;n.sourceContent="";n.startTarget=null;n.endTarget=null;n.callback=typeof i==="function"?i:U.noop;n.isShowing=false;n.leftCalendar={};n.rightCalendar={};n.opens="right";if(n.element.hasClass("pull-right"))n.opens="left";n.drops="down";if(n.element.hasClass("dropup"))n.drops="up";n.buttonClasses="btn btn-sm";n.applyButtonClasses="btn-primary";n.nowButtonClasses="btn-default";n.clearButtonClasses="btn-default";n.options=U.extend(true,{},e.DEFAULTS,n.element.baData(r)||{},a||{});n.locale=n.options.locale;n.ready(n._init)};function a(e){return Y.pluginFn(this,t,e,arguments,[],function(){this.ready(this.show)})}t.prototype={constructor:t,ready:function e(t){var a=this;if(q)t.call(a);else requirejs([i.lib.moment],function(e){q=e;t.call(a)})},_init:function e(){var t=this;var a=t.options;var i=t.locale;var n=t.element;t.startDate=t.getInitStartDate();t.endDate=t.getInitEndDate();t.minYear=q().subtract(100,"year").format("YYYY");t.maxYear=q().add(100,"year").format("YYYY");i.firstDay=q.localeData().firstDayOfWeek();if(a.format){i.format=a.format;var r="date";var o=a.format;var s=o.indexOf("Y")!==-1;var l=o.indexOf("M")!==-1;var c=o.indexOf("D")!==-1;var d=o.indexOf("H")!==-1;var u=o.indexOf("m")!==-1;var p=o.indexOf("s")!==-1;var f=true;var h=true;if(s&&l&&c){if(d||u||p)r="datetime"}else if(s&&l)r="month";else if(s)r="year";else if(d||u||p)r="time";if(!u){f=false;h=false}else if(!p)h=false;a.pickerType=r;a.timePickerSeconds=h;a.timePickerMinute=f}if(a.range){a.singleDatePicker=false;if(a.range!==true)i.separator=a.range;if(typeof a.ranges!=="string"&&a.ranges!==false)if(a.pickerType==="year"){var m=q().startOf("year");var g=m.clone().subtract(1,"year");a.ranges={};a.ranges[i.thisYear]=[m,m];a.ranges[i.lastYear]=[g,g];a.ranges[H(i.lastNYear,"2")]=[g,m];a.ranges[H(i.lastNYear,"3")]=[g.clone().subtract(2,"year"),m];a.ranges[H(i.lastNYear,"6")]=[g.clone().subtract(5,"year"),m]}else if(a.pickerType==="month"){var v=q().startOf("month");var b=v.clone().subtract(1,"month");a.ranges={};a.ranges[i.thisMonth]=[v,v];a.ranges[i.lastMonth]=[b,b];a.ranges[H(i.lastNMonth,"2")]=[b.clone(),v];a.ranges[H(i.lastNMonth,"3")]=[b.clone().subtract(2,"month"),v];a.ranges[H(i.lastNMonth,"6")]=[b.clone().subtract(5,"month"),v]}else if(a.pickerType==="time"){a.ranges={};a.ranges[i.todayToNow]=[q().startOf("days"),q()];a.ranges[H(i.lastNHours,"1")]=[q().subtract(1,"hours"),q()];a.ranges[H(i.lastNHours,"2")]=[q().subtract(2,"hours"),q()];a.ranges[H(i.lastNHours,"3")]=[q().subtract(3,"hours"),q()];a.ranges[H(i.lastNHours,"6")]=[q().subtract(6,"hours"),q()];a.ranges[H(i.lastNHours,"12")]=[q().subtract(12,"hours"),q()];a.ranges[i.forenoon]=[q().startOf("days"),q().startOf("days").add(12,"hours")];a.ranges[i.afternoon]=[q().startOf("days").add(12,"hours"),q().endOf("days")];a.ranges[i.allDay]=[q().startOf("days"),q().endOf("days")]}else{a.ranges={};a.ranges[i.today]=[q().startOf("days"),q().endOf("days")];a.ranges[i.yesterday]=[q().startOf("days").subtract(1,"days"),q().endOf("days").subtract(1,"days")];a.ranges[H(i.lastNDay,"7")]=[q().startOf("days").subtract(6,"days"),q().endOf("days")];a.ranges[H(i.lastNDay,"30")]=[q().startOf("days").subtract(29,"days"),q().endOf("days")];a.ranges[i.thisMonth]=[q().startOf("month"),q().endOf("month")];a.ranges[i.lastMonth]=[q().subtract(1,"month").startOf("month"),q().subtract(1,"month").endOf("month")]}else if(a.ranges!==false)a.ranges=window[a.ranges]||false;if(typeof a.span==="string"&&a.span){var y=(a.span||"").split(",");for(var $=0;$<y.length;$++)y[$]=y[$].trim();var x=Y.int((y[0]||"0").trim());var w=Y.int((y[1]||"0").trim());var k=Y.int((y[2]||"0").trim());var C=Y.int((y[3]||"0").trim());var $=Y.int((y[4]||"0").trim());var _=Y.int((y[5]||"0").trim());a.span={};if(x>0)a.span.year=x-1;if(w>0)a.span.month=w-1;if(k>0)a.span.days=k-1;if(C>0)a.span.hours=C-1;if($>0)a.span.minute=$-1;if(_>0)a.span.secoud=_-1}}else a.singleDatePicker=true;if(typeof a.template!=="string"&&!(a.template instanceof U))a.template='<div class="ba-date-picker">    <div class="ranges"></div>    <div class="drp-calendar left">        <div class="calendar-table"></div>        <div class="calendar-time"></div>    </div>    <div class="drp-calendar right">        <div class="calendar-table"></div>        <div class="calendar-time"></div>    </div>    <div class="drp-buttons">        <span class="drp-selected"></span>        <div class="btn-group">            <button class="clearBtn" type="button"></button>            <button class="nowBtn" type="button"></button>            <button class="applyBtn" disabled="disabled" type="button"></button>        </div>    </div>    <div class="arrow"></div></div>';var S=U.proxy(t.destroy,t);U(document).one(V.appRenderBefore,S);var E=n.closestBaModal();if(E){E.$element.one(V.modalHide,S);if(!a.parentEl)a.parentEl=E.$container}t.parentEl=a.parentEl&&U(a.parentEl).length?U(a.parentEl):U(t.parentEl);t.container=U(a.template).appendTo(t.parentEl);var T=t.container.addClass(i.direction);t.$arrow=T.find(".arrow");if(typeof a.valueTarget==="string")t.valueTarget=a.valueTarget;if(typeof a.startDate==="string")t.startDate=q(a.startDate,i.format);if(typeof a.endDate==="string")t.endDate=q(a.endDate,i.format);if(typeof a.minDate==="string")t.minDate=q(a.minDate,i.format);if(typeof a.maxDate==="string")t.maxDate=q(a.maxDate,i.format);if(_typeof(a.startDate)==="object")t.startDate=q(a.startDate);if(_typeof(a.endDate)==="object")t.endDate=q(a.endDate);if(_typeof(a.minDate)==="object")t.minDate=q(a.minDate);if(_typeof(a.maxDate)==="object")t.maxDate=q(a.maxDate);if(t.minDate&&t.startDate.isBefore(t.minDate))t.startDate=t.minDate.clone();if(t.maxDate&&t.endDate.isAfter(t.maxDate))t.endDate=t.maxDate.clone();if(typeof a.applyButtonClasses==="string")t.applyButtonClasses=a.applyButtonClasses;if(typeof a.applyClass==="string")t.applyButtonClasses=a.applyClass;if(typeof a.nowButtonClasses==="string")t.nowButtonClasses=a.nowButtonClasses;if(typeof a.nowClass==="string")t.nowButtonClasses=a.nowClass;if(typeof a.clearButtonClasses==="string")t.clearButtonClasses=a.clearButtonClasses;if(typeof a.clearClass==="string")t.nowButtonClasses=a.clearClass;if(_typeof(a.span)==="object")t.maxSpan=a.span;if(typeof a.opens==="string")t.opens=a.opens;if(typeof a.drops==="string")t.drops=a.drops;if(typeof a.showWeekNumbers==="boolean")t.showWeekNumbers=a.showWeekNumbers;if(typeof a.showISOWeekNumbers==="boolean")t.showISOWeekNumbers=a.showISOWeekNumbers;if(typeof a.buttonClasses==="string")t.buttonClasses=a.buttonClasses;if(_typeof(a.buttonClasses)==="object")t.buttonClasses=a.buttonClasses.join(" ");if(typeof a.showDropdowns==="boolean")t.showDropdowns=a.showDropdowns;if(typeof a.minYear==="number")t.minYear=a.minYear;if(typeof a.maxYear==="number")t.maxYear=a.maxYear;if(typeof a.custom==="boolean")t.showCustomRangeLabel=a.custom;if(typeof a.singleDatePicker==="boolean"){t.singleDatePicker=a.singleDatePicker;if(t.singleDatePicker)t.endDate=t.startDate.clone()}if(typeof a.timePicker==="boolean")t.timePicker=a.timePicker;if(typeof a.timePickerMinute==="boolean")t.timePickerMinute=a.timePickerMinute;if(typeof a.timePickerSeconds==="boolean")t.timePickerSeconds=a.timePickerSeconds;if(typeof a.timePickerIncrement==="number")t.timePickerIncrement=a.timePickerIncrement;if(typeof a.timePicker24Hour==="boolean")t.timePicker24Hour=a.timePicker24Hour;if(typeof a.input==="boolean")t.autoUpdateInput=a.input;if(typeof a.link==="boolean")t.linkedCalendars=a.link;if(typeof a.isInvalidDate==="function")t.isInvalidDate=a.isInvalidDate;if(typeof a.isCustomDate==="function")t.isCustomDate=a.isCustomDate;if(typeof a.alwaysShowCalendars==="boolean")t.alwaysShowCalendars=a.alwaysShowCalendars;if(typeof a.clear==="boolean")t.hideClearBtn=!a.clear;if(typeof a.force==="boolean"){t.force=a.force;t.sourceContent=n.html()}if(i.firstDay!=0){var D=i.firstDay;while(D>0){i.daysOfWeek.push(i.daysOfWeek.shift());D--}}var I,A,P;if(typeof a.startDate==="undefined"&&typeof a.endDate==="undefined")if(U(n).is(":text")){var F=U(n).val();var R=F.split(i.separator);I=A=null;if(R.length==2){I=q(R[0],i.format);A=q(R[1],i.format)}else if(t.singleDatePicker&&F!==""){I=q(F,i.format);A=q(F,i.format)}if(I!==null&&A!==null){t.setStartDate(I);t.setEndDate(A)}}if(typeof a.startTarget==="string"){t.startTarget=a.startTarget;a.ranges=false}if(typeof a.endTarget==="string")t.endTarget=a.endTarget;if(_typeof(a.ranges)==="object"){var M="day";if(t.timePicker&&t.timePickerMinute&&t.timePickerSeconds)M="second";else if(t.timePicker&&t.timePickerMinute)M="minute";else if(t.timePicker)M="hours";else if(t.pickerType==="month"||t.pickerType==="year")M=t.pickerType;for(P in a.ranges){if(typeof a.ranges[P][0]==="string")I=q(a.ranges[P][0],i.format);else I=q(a.ranges[P][0]);if(typeof a.ranges[P][1]==="string")A=q(a.ranges[P][1],i.format);else A=q(a.ranges[P][1]);if(t.minDate&&I.isBefore(t.minDate))I=t.minDate.clone();var L=t.maxDate;if(t.maxSpan&&L){if(I.clone().add(t.maxSpan).isAfter(L))L=I.clone().add(t.maxSpan)}else if(t.maxSpan)L=I.clone().add(t.maxSpan);if(L&&A.isAfter(L,M))continue;if(t.minDate&&A.isBefore(t.minDate,M)||L&&I.isAfter(L,M))continue;var B=document.createElement("textarea");B.innerHTML=P;var O=B.value;t.ranges[O]=[I,A]}var z="<ul>";for(P in t.ranges)z+='<li data-range-key="'+P+'">'+P+"</li>";if(t.showCustomRangeLabel)z+='<li data-range-key="'+i.customRangeLabel+'">'+i.customRangeLabel+"</li>";if(!t.hideClearBtn)z+='<li data-range-key="'+i.clearLabel+'">'+i.clearLabel+"</li>";z+="</ul>";T.find(".ranges").prepend(z)}if(typeof a.pickerType==="string"&&a.pickerType.length){t.pickerType=a.pickerType;if(a.pickerType==="datetime"||a.pickerType==="time")t.timePicker=true}if(!t.timePicker){t.startDate=t.startDate.startOf("day");t.endDate=t.endDate.endOf("day");T.find(".calendar-time").hide()}if(_typeof(a.ranges)==="object")T.addClass("show-ranges");if(t.singleDatePicker){T.addClass("single");T.find(".drp-calendar.left").addClass("single");T.find(".drp-calendar.left").show();T.find(".drp-calendar.right").hide()}if(typeof a.ranges==="undefined"&&!t.singleDatePicker||t.alwaysShowCalendars)T.addClass("show-calendar");T.addClass("opens"+t.opens);T.find(".applyBtn, .nowBtn, .clearBtn").addClass(t.buttonClasses);if(t.applyButtonClasses.length)T.find(".applyBtn").addClass(t.applyButtonClasses);if(t.nowButtonClasses.length)T.find(".nowBtn").addClass(t.nowButtonClasses);if(t.clearButtonClasses.length)T.find(".clearBtn").addClass(t.clearButtonClasses);T.find(".applyBtn").html(i.applyLabel);T.find(".nowBtn").html(i.nowLabel);T.find(".clearBtn").html(i.clearLabel);if(t.autoUpdateInput||t.hideClearBtn)T.find(".clearBtn").remove();var N=W("click");T.find(".drp-calendar").on(N,".prev",U.proxy(t.clickPrev,t)).on(N,".next",U.proxy(t.clickNext,t)).on(N,"td.available,span.col-xs-4.available",U.proxy(t.clickDate,t)).on(W("mouseenter"),"td.available,span.col-xs-4.available",U.proxy(t.hoverDate,t)).on(N,"span.year-select",U.proxy(t.showYearView,t)).on(N,"span.month-select",U.proxy(t.showMonthView,t)).on(W("change"),"select.hourselect,select.minuteselect,select.secondselect,select.ampmselect",U.proxy(t.timeChanged,t)).on(N,"span.available.time-picker-item",U.proxy(t.timeChanged,t));T.find(".ranges").on(N,"li",U.proxy(t.clickRange,t));T.find(".drp-buttons").on(N,"button.applyBtn",U.proxy(t.clickApply,t)).on(N,"button.clearBtn",U.proxy(t.clickClear,t)).on(N,"button.nowBtn",U.proxy(t.clickNow,t));if(n.is(":text")||n.is("button")){var j={};j[N]=U.proxy(t.show,t);j[W("focus")]=U.proxy(t.show,t);j[W("keyup")]=U.proxy(t.elementChanged,t);j[W("keydown")]=U.proxy(t.keydown,t);n.on(j)}else{n.on(N,U.proxy(t.toggle,t));n.on(W("keydown"),U.proxy(t.toggle,t))}n.data("ba.date.picker",t);t.updateElement()},getTopWrap:function e(t){return t.parents(".drp-calendar")},isLeft:function e(t){return t.hasClass("left")},isYearPicker:function e(t){return t.closest(".table-year-view").length>0},isMonthPicker:function e(t){return t.closest(".table-month-view").length>0},isAvailable:function e(t){return t.hasClass("available")},setStartDate:function e(t){var a=this;if(typeof t==="string")a.startDate=q(t,a.locale.format);if((typeof t==="undefined"?"undefined":_typeof(t))==="object")a.startDate=q(t);if(!a.timePicker)a.startDate=a.startDate.startOf("day");if(a.timePicker&&a.timePickerIncrement)a.startDate.minute(Math.round(a.startDate.minute()/a.timePickerIncrement)*a.timePickerIncrement);if(a.minDate&&a.startDate.isBefore(a.minDate)){a.startDate=a.minDate.clone();if(a.timePicker&&a.timePickerIncrement)a.startDate.minute(Math.round(a.startDate.minute()/a.timePickerIncrement)*a.timePickerIncrement)}if(a.maxDate&&a.startDate.isAfter(a.maxDate)){a.startDate=a.maxDate.clone();if(a.timePicker&&a.timePickerIncrement)a.startDate.minute(Math.floor(a.startDate.minute()/a.timePickerIncrement)*a.timePickerIncrement)}if(!a.isShowing)a.updateElement();a.updateMonthsInView()},setEndDate:function e(t){var a=this;if(typeof t==="string")a.endDate=q(t,a.locale.format);if((typeof t==="undefined"?"undefined":_typeof(t))==="object")a.endDate=q(t);if(!a.timePicker)a.endDate=a.endDate.endOf("day");if(a.timePicker&&a.timePickerIncrement)a.endDate.minute(Math.round(a.endDate.minute()/a.timePickerIncrement)*a.timePickerIncrement);if(a.endDate.isBefore(a.startDate))a.endDate=a.startDate.clone();if(a.maxDate&&a.endDate.isAfter(a.maxDate))a.endDate=a.maxDate.clone();if(a.maxSpan&&a.startDate.clone().add(a.maxSpan).isBefore(a.endDate))a.endDate=a.startDate.clone().add(a.maxSpan);a.previousRightTime=a.endDate.clone();a.container.find(".drp-selected").html(a.startDate.format(a.locale.format)+a.locale.separator+a.endDate.format(a.locale.format));if(!a.isShowing)a.updateElement();a.updateMonthsInView()},isInvalidDate:function e(){return false},isCustomDate:function e(){return false},updateView:function e(){var t=this;if(t.timePicker)if(!t.endDate)t.container.find(".right .calendar-time select").prop("disabled",true).addClass("disabled");else t.container.find(".right .calendar-time select").prop("disabled",false).removeClass("disabled");if(t.endDate)t.container.find(".drp-selected").html(t.startDate.format(t.locale.format)+t.locale.separator+t.endDate.format(t.locale.format));t.updateMonthsInView();t.updateCalendars();t.updateFormInputs();if(t.timePicker){t.renderTimePicker("left");t.renderTimePicker("right")}},updateMonthsInView:function e(){var t=this;if(t.pickerType==="year"||t.pickerType==="month"){if(t.endDate){if(!t.singleDatePicker&&t.leftCalendar.month&&t.rightCalendar.month&&(t.startDate.year()==t.leftCalendar.month.year()||t.startDate.year()==t.rightCalendar.month.year())&&(t.endDate.year()==t.leftCalendar.month.year()||t.endDate.year()==t.rightCalendar.month.year()))return;t.leftCalendar.month=t.startDate.clone().startOf("year");if(!t.linkedCalendars&&t.endDate.year()!=t.startDate.year())t.rightCalendar.month=t.endDate.clone().startOf("year");else t.rightCalendar.month=t.startDate.clone().startOf("year").add(1,"year")}else if(t.leftCalendar.month.year()!=t.startDate.year()&&t.rightCalendar.month.year()!=t.startDate.year()){t.leftCalendar.month=t.startDate.clone().startOf("year");t.rightCalendar.month=t.startDate.clone().startOf("year").add(1,"year")}if(t.maxDate&&t.linkedCalendars&&!t.singleDatePicker&&t.rightCalendar.year()>t.maxDate.year()){t.rightCalendar.month=t.maxDate.clone().startOf("year");t.leftCalendar.month=t.maxDate.clone().startOf("year").subtract(1,"year")}return}if(t.endDate){if(!t.singleDatePicker&&t.leftCalendar.month&&t.rightCalendar.month&&(t.startDate.format("YYYY-MM")==t.leftCalendar.month.format("YYYY-MM")||t.startDate.format("YYYY-MM")==t.rightCalendar.month.format("YYYY-MM"))&&(t.endDate.format("YYYY-MM")==t.leftCalendar.month.format("YYYY-MM")||t.endDate.format("YYYY-MM")==t.rightCalendar.month.format("YYYY-MM")))return;t.leftCalendar.month=t.startDate.clone().date(2);if(!t.linkedCalendars&&(t.endDate.month()!=t.startDate.month()||t.endDate.year()!=t.startDate.year()))t.rightCalendar.month=t.endDate.clone().date(2);else t.rightCalendar.month=t.startDate.clone().date(2).add(1,"month")}else if(t.leftCalendar.month.format("YYYY-MM")!=t.startDate.format("YYYY-MM")&&t.rightCalendar.month.format("YYYY-MM")!=t.startDate.format("YYYY-MM")){t.leftCalendar.month=t.startDate.clone().date(2);t.rightCalendar.month=t.startDate.clone().date(2).add(1,"month")}if(t.maxDate&&t.linkedCalendars&&!t.singleDatePicker&&t.rightCalendar.month>t.maxDate){t.rightCalendar.month=t.maxDate.clone().date(2);t.leftCalendar.month=t.maxDate.clone().date(2).subtract(1,"month")}},updateCalendars:function e(){var t=this;if(t.timePicker){var a,i,n;if(t.endDate){a=parseInt(t.container.find(".left .hourselect").val(),10);i=parseInt(t.container.find(".left .minuteselect").val(),10);if(isNaN(i))i=parseInt(t.container.find(".left .minuteselect option:last").val(),10);n=t.timePickerSeconds?parseInt(t.container.find(".left .secondselect").val(),10):0;if(!t.timePicker24Hour){var r=t.container.find(".left .ampmselect").val();if(r==="PM"&&a<12)a+=12;if(r==="AM"&&a===12)a=0}}else{a=parseInt(t.container.find(".right .hourselect").val(),10);i=parseInt(t.container.find(".right .minuteselect").val(),10);if(isNaN(i))i=parseInt(t.container.find(".right .minuteselect option:last").val(),10);n=t.timePickerSeconds?parseInt(t.container.find(".right .secondselect").val(),10):0;if(!t.timePicker24Hour){var r=t.container.find(".right .ampmselect").val();if(r==="PM"&&a<12)a+=12;if(r==="AM"&&a===12)a=0}}t.leftCalendar.month.hour(a).minute(i).second(n);t.rightCalendar.month.hour(a).minute(i).second(n)}t.renderCalendar("left");t.renderCalendar("right");if(t.pickerType==="year"){t.renderYearOrMonth(true,true);t.renderYearOrMonth(false,true)}else if(t.pickerType==="month"){t.renderYearOrMonth(true,false);t.renderYearOrMonth(false,false)}t.container.find(".ranges li").removeClass("active");if(t.endDate==null)return;t.calculateChosenLabel()},renderCalendar:function e(t){var a=this;var i=t=="left"?a.leftCalendar:a.rightCalendar;var n=i.month.month();var r=i.month.year();var o=i.month.hour();var s=i.month.minute();var l=i.month.second();var c=q([r,n]).daysInMonth();var d=q([r,n,1]);var u=q([r,n,c]);var p=q(d).subtract(1,"month").month();var f=q(d).subtract(1,"month").year();var h=q([f,p]).daysInMonth();var m=d.day();var g=[];g.firstDay=d;g.lastDay=u;for(var v=0;v<6;v++)g[v]=[];var b=h-m+a.locale.firstDay+1;if(b>h)b-=7;if(m==a.locale.firstDay)b=h-6;var y=q([f,p,b,12,s,l]);var $,x;for(var v=0,$=0,x=0;v<42;v++,$++,y=q(y).add(24,"hour")){if(v>0&&$%7===0){$=0;x++}g[x][$]=y.clone().hour(o).minute(s).second(l);y.hour(12);if(a.minDate&&g[x][$].format("YYYY-MM-DD")==a.minDate.format("YYYY-MM-DD")&&g[x][$].isBefore(a.minDate)&&t=="left")g[x][$]=a.minDate.clone();if(a.maxDate&&g[x][$].format("YYYY-MM-DD")==a.maxDate.format("YYYY-MM-DD")&&g[x][$].isAfter(a.maxDate)&&t=="right")g[x][$]=a.maxDate.clone()}if(t=="left")a.leftCalendar.calendar=g;else a.rightCalendar.calendar=g;var w=t=="left"?a.minDate:a.startDate;var k=a.maxDate;var C='<table class="table-condensed">';C+="<thead>";C+="<tr>";if(a.showWeekNumbers||a.showISOWeekNumbers)C+="<th></th>";if((!w||w.isBefore(g.firstDay))&&(!a.linkedCalendars||t=="left"))C+='<th class="prev available"><span></span></th>';else C+="<th></th>";var _=g[1][1].format("YYYY"+a.locale.yearName)+" "+a.locale.monthNames[g[1][1].month()];if(a.showDropdowns)_='<span class="year-select">'+g[1][1].format("YYYY"+a.locale.yearName)+'</span><span class="month-select">'+a.locale.monthNames[g[1][1].month()]+"</span>";C+='<th colspan="5" class="month">'+_+"</th>";if((!k||k.isAfter(g.lastDay))&&(!a.linkedCalendars||t=="right"||a.singleDatePicker))C+='<th class="next available"><span></span></th>';else C+="<th></th>";C+="</tr>";C+='<tr class="week-bar">';if(a.showWeekNumbers||a.showISOWeekNumbers)C+='<th class="week">'+a.locale.weekLabel+"</th>";U.each(a.locale.daysOfWeek,function(e,t){C+="<th>"+t+"</th>"});C+="</tr>";C+="</thead>";C+="<tbody>";if(a.endDate==null&&a.maxSpan){var S=a.startDate.clone().add(a.maxSpan).endOf("day");if(!k||S.isBefore(k))k=S}for(var x=0;x<6;x++){C+="<tr>";if(a.showWeekNumbers)C+='<td class="week">'+g[x][0].week()+"</td>";else if(a.showISOWeekNumbers)C+='<td class="week">'+g[x][0].isoWeek()+"</td>";for(var $=0;$<7;$++){var E=[];if(g[x][$].isSame(new Date,"day"))E.push("today");if(g[x][$].isoWeekday()>5)E.push("weekend");if(g[x][$].month()!=g[1][1].month())E.push("off","ends");if(a.minDate&&g[x][$].isBefore(a.minDate,"day"))E.push("off","disabled");if(k&&g[x][$].isAfter(k,"day"))E.push("off","disabled");if(a.isInvalidDate(g[x][$]))E.push("off","disabled");if(g[x][$].format("YYYY-MM-DD")==a.startDate.format("YYYY-MM-DD"))E.push("active","start-date");if(a.endDate!=null&&g[x][$].format("YYYY-MM-DD")==a.endDate.format("YYYY-MM-DD"))E.push("active","end-date");if(a.endDate!=null&&g[x][$]>a.startDate&&g[x][$]<a.endDate)E.push("in-range");var T=a.isCustomDate(g[x][$]);if(T!==false)if(typeof T==="string")E.push(T);else Array.prototype.push.apply(E,T);var D="",I=false;for(var v=0;v<E.length;v++){D+=E[v]+" ";if(E[v]=="disabled")I=true}if(!I)D+="available";C+='<td class="'+D.replace(/^\s+|\s+$/g,"")+'" data-date="'+g[x][$].date()+'" data-title="'+"r"+x+"c"+$+'">'+g[x][$].date()+"</td>"}C+="</tr>"}C+="</tbody>";C+="</table>";a.container.find(".drp-calendar."+t+" .calendar-table").html(C)},renderTimePicker:function e(t){var a=this;if(t=="right"&&!a.endDate)return;var i,n,r=a.maxDate;if(a.maxSpan&&(!a.maxDate||a.startDate.clone().add(a.maxSpan).isBefore(a.maxDate)))r=a.startDate.clone().add(a.maxSpan);if(t=="left"){i=a.startDate.clone();n=a.minDate}else if(t=="right"){i=a.endDate.clone();n=a.startDate;var o=a.container.find(".drp-calendar.right .calendar-time");if(o.html()!=""){i.hour(!isNaN(i.hour())?i.hour():o.find(".hourselect option:selected").val());i.minute(!isNaN(i.minute())?i.minute():o.find(".minuteselect option:selected").val());i.second(!isNaN(i.second())?i.second():o.find(".secondselect option:selected").val());if(!a.timePicker24Hour){var s=o.find(".ampmselect option:selected").val();if(s==="PM"&&i.hour()<12)i.hour(i.hour()+12);if(s==="AM"&&i.hour()===12)i.hour(0)}}if(i.isBefore(a.startDate))i=a.startDate.clone();if(r&&i.isAfter(r))i=r.clone()}var l=["show-hour"];var c='<div class="time-picker time-picker-hour"><div class="time-picker-title">'+a.locale.hourName+'</div><div class="time-picker-list">';var d='<select class="hourselect">';var u=a.timePicker24Hour?0:1;var p=a.timePicker24Hour?23:12;for(var f=u;f<=p;f++){var h=f;if(!a.timePicker24Hour)h=i.hour()>=12?f==12?12:f+12:f==12?0:f;var m=i.clone().hour(h);var g=false;if(n&&m.minute(59).isBefore(n))g=true;if(r&&m.minute(0).isAfter(r))g=true;var v=f<10?"0"+f:f;if(h==i.hour()&&!g){d+='<option value="'+f+'" selected="selected">'+v+"</option>";c+='<span data-value="'+f+'" class="time-picker-item available active">'+v+"</span>"}else if(g){d+='<option value="'+f+'" disabled="disabled" class="disabled">'+v+"</option>";c+='<span data-value="'+f+'" disabled="disabled" class="time-picker-item disabled">'+v+"</span>"}else{d+='<option value="'+f+'">'+v+"</option>";c+='<span data-value="'+f+'" class="time-picker-item available">'+v+"</span>"}}d+="</select> ";c+="</div></div>";d+=': <select class="minuteselect" '+(a.timePickerMinute?"":" disabled")+">";var b='<div class="time-picker time-picker-minute"><div class="time-picker-title">'+a.locale.minuteName+'</div><div class="time-picker-list">';for(var f=0;f<60;f+=a.timePickerIncrement){var y=f<10?"0"+f:f;var m=i.clone().minute(f);var g=false;if(n&&m.second(59).isBefore(n))g=true;if(r&&m.second(0).isAfter(r))g=true;if(i.minute()==f&&!g){d+='<option value="'+f+'" selected="selected">'+y+"</option>";b+='<span data-value="'+f+'" class="time-picker-item available active">'+y+"</span>"}else if(g){d+='<option value="'+f+'" disabled="disabled" class="disabled">'+y+"</option>";b+='<span data-value="'+f+'" disabled="disabled" class="time-picker-item disabled">'+y+"</span>"}else{d+='<option value="'+f+'">'+y+"</option>";b+='<span data-value="'+f+'" class="time-picker-item available">'+y+"</span>"}}d+="</select> ";b+="</div></div>";c+=a.timePickerMinute?b:"";if(a.timePickerMinute)l.push("show-minute");if(a.timePickerSeconds){l.push("show-second");d+=': <select class="secondselect">';c+='<div class="time-picker time-picker-second"><div class="time-picker-title">'+a.locale.secondName+'</div><div class="time-picker-list">';for(var f=0;f<60;f++){var y=f<10?"0"+f:f;var m=i.clone().second(f);var g=false;if(n&&m.isBefore(n))g=true;if(r&&m.isAfter(r))g=true;if(i.second()==f&&!g){d+='<option value="'+f+'" selected="selected">'+y+"</option>";c+='<span data-value="'+f+'" class="time-picker-item available active">'+y+"</span>"}else if(g){d+='<option value="'+f+'" disabled="disabled" class="disabled">'+y+"</option>";c+='<span data-value="'+f+'" disabled="disabled" class="time-picker-item disabled">'+y+"</span>"}else{d+='<option value="'+f+'">'+y+"</option>";c+='<span data-value="'+f+'" class="time-picker-item available">'+y+"</span>"}}d+="</select> ";c+="</div></div>"}if(!a.timePicker24Hour){l.push("show-amp");c+='<div class="time-picker time-picker-amp"><div class="time-picker-title">A/PM</div><div class="time-picker-list">';d+='<select class="ampmselect">';var $="";var x="";var w=" available";var k=" available";if(n&&i.clone().hour(12).minute(0).second(0).isBefore(n)){$=' disabled="disabled" class="disabled"';w=" disabled"}if(r&&i.clone().hour(0).minute(0).second(0).isAfter(r)){x=' disabled="disabled" class="disabled"';k=" disabled"}if(i.hour()>=12){c+='<span data-value="AM" class="time-picker-item'+w+'"'+w+">"+a.locale.am+"</span>";c+='<span data-value="PM" class="time-picker-item active'+k+'"'+k+">"+a.locale.pm+"</span>";d+='<option value="AM"'+$+">"+a.locale.am+'</option><option value="PM" selected="selected"'+x+">"+a.locale.pm+"</option>"}else{c+='<span data-value="AM" class="time-picker-item active'+w+'"'+w+">"+a.locale.am+"</span>";c+='<span data-value="PM" class="time-picker-item'+k+'"'+k+">"+a.locale.pm+"</span>";d+='<option value="AM" selected="selected"'+$+">"+a.locale.am+'</option><option value="PM"'+x+">"+a.locale.pm+"</option>"}d+="</select>";c+="</div></div>"}var C=a.container.find(".drp-calendar."+t+" .calendar-time");C.html(d);if(a.pickerType==="time"){C.hide();var _=a.singleDatePicker?a.locale.timeChoose:t=="left"?a.locale.timeStartChoose:a.locale.timeEndChoose;var S=a.container.find(".drp-calendar."+t+" .calendar-table");S.find(".select-box").remove();S.append('<div class="select-box"><table class="table-time-view '+l.join(" ")+'"><thead><tr><th>'+_+"</th></tr></thead><tbody><tr><td>"+c+"</td></tr></tbody></table></div>");a.container.find(".time-picker-item.active").each(function(){var e=U(this);var t=e.closest(".time-picker-list");var a=e.offset().top-t.offset().top+t.scrollTop();var i=(t.height()-e.height())/2;if(a>i)t.animate({scrollTop:a-i},0)})}},updateFormInputs:function e(){var t=this;if(t.singleDatePicker||t.endDate&&(t.startDate.isBefore(t.endDate)||t.startDate.isSame(t.endDate)))t.container.find("button.applyBtn").prop("disabled",false);else t.container.find("button.applyBtn").prop("disabled",true)},move:function e(){var t;var a;var i={top:0,left:0};var n=this;var r=n.drops;var o=U(window).width();if(!n.parentEl.is("body")){i={top:n.parentEl.offset().top-n.parentEl.scrollTop(),left:n.parentEl.offset().left-n.parentEl.scrollLeft()};o=n.parentEl[0].clientWidth+n.parentEl.offset().left}a=n.container.outerHeight();switch(r){case"auto":t=n.element.offset().top+n.element.outerHeight()-i.top;if(t+a>=n.parentEl[0].scrollHeight&&n.element.offset().top>a){t=n.element.offset().top-a-i.top;r="up"}break;case"up":t=n.element.offset().top-a-i.top;break;default:t=n.element.offset().top+n.element.outerHeight()-i.top;break}n.container.css({top:0,left:0,right:"auto"});var s=n.container.outerWidth();n.container.toggleClass("drop-up",r=="up");if(n.opens=="left"){var l=o-n.element.offset().left-n.element.outerWidth();if(s+l>U(window).width())n.container.css({top:t,right:"auto",left:9});else n.container.css({top:t,right:l,left:"auto"});n.$arrow.css({marginLeft:n.element.offset().left})}else if(n.opens=="center"){var c=n.element.offset().left-i.left+n.element.outerWidth()/2-s/2;if(c<0)n.container.css({top:t,right:"auto",left:9});else if(c+s>U(window).width())n.container.css({top:t,left:"auto",right:0});else n.container.css({top:t,left:c,right:"auto"})}else{var c=n.element.offset().left-i.left;if(c+s>U(window).width())n.container.css({top:t,left:"auto",right:0});else n.container.css({top:t,left:c,right:"auto"});n.$arrow.css({left:n.element.offset().left-n.container.offset().left})}clearTimeout(n.moveTimer);n.moveTimer=setTimeout(function(){if(a!=n.container.outerHeight())n.move()})},show:function e(t){var a=this;if(a.isShowing)return;a._outsideClickProxy=U.proxy(function(e){a.outsideClick(e)},a);U(document).on(W("mousedown"),a._outsideClickProxy).on(W("touchend"),a._outsideClickProxy).on(W("click"),"[data-toggle=dropdown]",a._outsideClickProxy).on(W("focusin"),a._outsideClickProxy);U(window).on(W("resize"),U.proxy(function(e){this.move(e)},a));a.oldStartDate=a.startDate.clone();a.oldEndDate=a.endDate.clone();a.previousRightTime=a.endDate.clone();a.elementChanged();a.container.show();a.move();if(a.pickerType==="time")a.container.find(".drp-calendar.left .hourselect").trigger("change");Y.execCallback(a,a.options.onShow,a.element[0],[a],a.element,V.datePickerShow);a.isShowing=true},hide:function e(t){var a=this;if(!a.isShowing)return;if(!a.endDate){a.startDate=a.oldStartDate.clone();a.endDate=a.oldEndDate.clone()}if(!a.startDate.isSame(a.oldStartDate)||!a.endDate.isSame(a.oldEndDate))a.callback(a.startDate.clone(),a.endDate.clone(),a.chosenLabel);a.updateElement();U(document).off("."+n);U(window).off("."+n);a.container.hide();Y.execCallback(a,a.options.onHide,a.element[0],[a],a.element,V.datePickerHide);a.isShowing=false;a.leftCalendar.viewYear=false;a.rightCalendar.viewYear=false},toggle:function e(t){var a=this;if(a.isShowing)a.hide();else a.show()},outsideClick:function e(t){var a=this;var i=U(t.target);if(t.type=="focusin"||i.closest(a.element).length||i.closest(a.container).length||i.closest(".calendar-table").length)return;Y.execCallback(a,a.options.onOutsideClick,a.element[0],[a],a.element,V.datePickerOutsideClick);a.hide()},showCalendars:function e(){var t=this;t.container.addClass("show-calendar");t.move();Y.execCallback(t,t.options.onShowCalendar,t.element[0],[t],t.element,V.datePickerShowCalendar)},hideCalendars:function e(){var t=this;t.container.removeClass("show-calendar");Y.execCallback(t,t.options.onHideCalendar,t.element[0],[t],t.element,V.datePickerHideCalendar)},clickRange:function e(t){var a=t.target.getAttribute("data-range-key");var i=this;i.chosenLabel=a;if(a==i.locale.customRangeLabel)i.showCalendars();else if(a==i.locale.clearLabel)i.clickClear(t);else{var n=i.ranges[a];i.startDate=n[0];i.endDate=n[1];if(!i.timePicker){i.startDate.startOf("day");i.endDate.endOf("day")}if(!i.alwaysShowCalendars)i.hideCalendars();i.clickApply()}},clickPrev:function e(t){var a=U(t.target);var i=this;var n=i.getTopWrap(a);var r=i.isLeft(n);var o=i.pickerType==="year";var s=i.pickerType==="month";if(i.isYearPicker(a)){if(r)i.leftCalendar.viewYear.subtract(15,"year");else{i.rightCalendar.viewYear.subtract(15,"year");if(i.linkedCalendars&&o)i.leftCalendar.viewYear.subtract(15,"year")}if(!o){i.renderYearOrMonth(r,true);return}}else if(i.isMonthPicker(a)){if(r)i.leftCalendar.viewYear.subtract(1,"year");else{i.rightCalendar.viewYear.subtract(1,"year");if(i.linkedCalendars&&s)i.leftCalendar.viewYear.subtract(1,"year")}if(!s){i.renderYearOrMonth(r,false);return}}else if(r){i.leftCalendar.month.subtract(1,"month");if(i.linkedCalendars)i.rightCalendar.month.subtract(1,"month")}else i.rightCalendar.month.subtract(1,"month");i.updateCalendars()},clickNext:function e(t){var a=U(t.target);var i=this;var n=i.getTopWrap(a);var r=i.isLeft(n);var o=i.pickerType==="year";var s=i.pickerType==="month";if(i.isYearPicker(a)){if(r)i.leftCalendar.viewYear.add(15,"year");else{i.rightCalendar.viewYear.add(15,"year");if(i.linkedCalendars&&o)i.leftCalendar.viewYear.add(15,"year")}if(!o){i.renderYearOrMonth(r,true);return}}else if(i.isMonthPicker(a)){if(r)i.leftCalendar.viewYear.add(1,"year");else{i.rightCalendar.viewYear.add(1,"year");if(i.linkedCalendars&&s)i.leftCalendar.viewYear.add(1,"year")}if(!s){i.renderYearOrMonth(r,false);return}}else if(r)i.leftCalendar.month.add(1,"month");else{i.rightCalendar.month.add(1,"month");if(i.linkedCalendars)i.leftCalendar.month.add(1,"month")}i.updateCalendars()},hoverDate:function e(t){var a=U(t.target);var l=this;if(!l.isAvailable(a))return;var i=l.getTopWrap(a);var n=l.isLeft(i);if(l.isYearPicker(a)||l.isMonthPicker(a)){if(l.pickerType==="year"){var r=l.startDate.year();var o=a.data("year");if(!l.endDate)l.container.find(".table-year-view .col-xs-4").each(function(e,t){var a=U(t);var i=a.data("year");if(i>=r&&i<=o)a.addClass("in-range");else a.removeClass("in-range")})}else if(l.pickerType==="month"){var s=q([a.data("year"),a.data("month")]);if(!l.endDate)l.container.find(".table-month-view .col-xs-4").each(function(e,t){var a=U(t);var i=q([a.data("year"),a.data("month")]);if(i.isSameOrAfter(l.startDate,"month")&&i.isSameOrBefore(s))a.addClass("in-range");else a.removeClass("in-range")})}return}var c=a.attr("data-title");var d=c.substr(1,1);var u=c.substr(3,1);var p=n?l.leftCalendar.calendar[d][u]:l.rightCalendar.calendar[d][u];var f=l.leftCalendar;var h=l.rightCalendar;var m=l.startDate;if(!l.endDate)l.container.find(".drp-calendar tbody td").each(function(e,t){var a=U(t);if(a.hasClass("week"))return;var i=a.attr("data-title");var n=i.substr(1,1);var r=i.substr(3,1);var o=l.getTopWrap(a);var s=l.isLeft(o)?f.calendar[n][r]:h.calendar[n][r];if(s.isAfter(m)&&s.isBefore(p)||s.isSame(p,"day"))a.addClass("in-range");else a.removeClass("in-range")})},clickDate:function e(t){var a=U(t.target);var i=this;if(!i.isAvailable(a))return;if(i.isYearPicker(a)||i.isMonthPicker(a))if(i.pickerType==="year"||i.pickerType==="month")i.setSelectedDate(q([a.data("year"),a.data("month")]));else i.monthOrYearChanged(t);else{var n=i.getTopWrap(a);var r=a.attr("data-title");var o=r.substr(1,1);var s=r.substr(3,1);if(a.hasClass("active")&&i.singleDatePicker)i.clickApply();else i.setSelectedDate(i.isLeft(n)?i.leftCalendar.calendar[o][s]:i.rightCalendar.calendar[o][s])}t.stopPropagation()},setSelectedDate:function e(t){var a=this;if(a.endDate||t.isBefore(a.startDate,"day")){if(a.timePicker){var i=parseInt(a.container.find(".left .hourselect").val(),10);if(!a.timePicker24Hour){var n=a.container.find(".left .ampmselect").val();if(n==="PM"&&i<12)i+=12;if(n==="AM"&&i===12)i=0}var r=parseInt(a.container.find(".left .minuteselect").val(),10);if(isNaN(r))r=parseInt(a.container.find(".left .minuteselect option:last").val(),10);var o=a.timePickerSeconds?parseInt(a.container.find(".left .secondselect").val(),10):0;t=t.clone().hour(i).minute(r).second(o)}a.endDate=null;a.setStartDate(t.clone())}else if(!a.endDate&&t.isBefore(a.startDate))a.setEndDate(a.startDate.clone());else{if(a.timePicker){var i=parseInt(a.container.find(".right .hourselect").val(),10);if(!a.timePicker24Hour){var n=a.container.find(".right .ampmselect").val();if(n==="PM"&&i<12)i+=12;if(n==="AM"&&i===12)i=0}var r=parseInt(a.container.find(".right .minuteselect").val(),10);if(isNaN(r))r=parseInt(a.container.find(".right .minuteselect option:last").val(),10);var o=a.timePickerSeconds?parseInt(a.container.find(".right .secondselect").val(),10):0;t=t.clone().hour(i).minute(r).second(o)}a.setEndDate(t.clone());if(!a.timePicker){a.calculateChosenLabel();a.clickApply()}}if(a.singleDatePicker){a.setEndDate(a.startDate);if(!a.timePicker)a.clickApply()}a.updateView()},calculateChosenLabel:function e(){var t=true;var a=0;var i=this;for(var n in i.ranges){if(i.timePicker){var r=i.timePickerSeconds?"YYYY-MM-DD HH:mm:ss":"YYYY-MM-DD HH:mm";if(i.startDate.format(r)==i.ranges[n][0].format(r)&&i.endDate.format(r)==i.ranges[n][1].format(r)){t=false;i.chosenLabel=i.container.find(".ranges li:eq("+a+")").addClass("active").attr("data-range-key");break}}else if(i.startDate.format("YYYY-MM-DD")==i.ranges[n][0].format("YYYY-MM-DD")&&i.endDate.format("YYYY-MM-DD")==i.ranges[n][1].format("YYYY-MM-DD")){t=false;i.chosenLabel=i.container.find(".ranges li:eq("+a+")").addClass("active").attr("data-range-key");break}a++}if(t){if(i.showCustomRangeLabel)i.chosenLabel=i.container.find('.ranges li[data-range-key="'+i.locale.customRangeLabel+'"]').addClass("active").attr("data-range-key");else i.chosenLabel=null;i.showCalendars()}},clickApply:function e(t){var a=this;a.updateElement(true);Y.execCallback(a,a.options.onApply,a.element[0],[a],a.element,V.datePickerApply);a.hide();if(a.endTarget){var i=U(a.endTarget);if(i.is(":text"))i.val("").trigger(W("focus"));else i.html("").trigger(W("click"))}},clickCancel:function e(t){var a=this;a.startDate=a.oldStartDate;a.endDate=a.oldEndDate;Y.execCallback(a,a.options.onCancel,a.element[0],[a],a.element,V.datePickerCancel);a.hide()},clickNow:function e(t){var a=this;a.startDate=a.getInitStartDate();a.endDate=a.getInitEndDate();a.clickApply()},clickClear:function e(t){var a=this;a.triggerElementChange(a.force?a.sourceContent:"");Y.execCallback(a,a.options.onClear,a.element[0],[a],a.element,V.datePickerClear);a.hide()},monthOrYearChanged:function e(t){var a=U(t.target);var i=this;var n=i.isLeft(i.getTopWrap(a));var r=parseInt(a.data("month"),10);var o=parseInt(a.data("year"));if(!n)if(o<i.startDate.year()||o==i.startDate.year()&&r<i.startDate.month()){r=i.startDate.month();o=i.startDate.year()}if(i.minDate)if(o<i.minDate.year()||o==i.minDate.year()&&r<i.minDate.month()){r=i.minDate.month();o=i.minDate.year()}if(i.maxDate)if(o>i.maxDate.year()||o==i.maxDate.year()&&r>i.maxDate.month()){r=i.maxDate.month();o=i.maxDate.year()}if(n){i.leftCalendar.month.month(r).year(o);if(i.linkedCalendars)i.rightCalendar.month=i.leftCalendar.month.clone().add(1,"month")}else{i.rightCalendar.month.month(r).year(o);if(i.linkedCalendars)i.leftCalendar.month=i.rightCalendar.month.clone().subtract(1,"month")}i.updateCalendars()},updateRightViewYear:function e(t){var a=this;a.rightCalendar.viewYear=a.leftCalendar.viewYear.clone().add(t,"year")},showYearView:function e(t){var a=this;a.renderYearOrMonth(a.isLeft(a.getTopWrap(U(t.target))),true)},renderYearOrMonth:function e(t,a){var i=this;var n=i.container.find((t?".left ":".right ")+".calendar-table");var r=t?i.leftCalendar:i.rightCalendar;var o=i.pickerType==="year"||i.pickerType==="month";var s=o?i.minDate:t?i.minDate:i.startDate;var l=i.maxDate;if(o)if(i.endDate==null&&i.maxSpan){var c=i.startDate.clone().add(i.maxSpan).endOf(i.pickerType);if(!l||c.isBefore(l))l=c}var d=l&&l.year()||i.maxYear;var u=s&&s.year()||i.minYear;var p=r.month.year();var f=r.month.month();var h=p==u;var m=p==d;var g=!t&&i.linkedCalendars&&o&&!i.singleDatePicker;var v=t&&i.linkedCalendars&&o&&!i.singleDatePicker;var b='<div class="select-box">    <table class="table-condensed table-'+(a?"year":"month")+'-view">        <thead>            <tr>                '+(g?"<th></th>":'<th class="prev"><span></span></th>')+'                <th class="month">_name_</th>                '+(v?"<th></th>":'<th class="next"><span></span></th>')+'            </tr>         </thead>        <tbody><tr><td colspan="3">_list_</td></tr></tbody>    </table></div>';var y=null;if(r.viewYear)y=r.viewYear.clone();if(!y)y=r.month.clone();var $=y.year();var x="";var w="";if(a){var k=$-7;var C=$+7;for(var _=k;_<=C;_++){var S=[];if(_>=u&&_<=d)S.push("available");else S.push("disabled");if(i.pickerType==="year"){if(_==i.startDate.year())S.push("start-date","active");if(i.endDate!=null&&_==i.endDate.year())S.push("end-date","active");if(i.endDate!=null&&_>=i.startDate.year()&&_<=i.endDate.year())S.push("in-range")}else if(_==p)S.push("active");x+='<span data-year="'+_+'" data-month="'+f+'" class="col-xs-4 '+S.join(" ")+'">'+_+i.locale.yearName+"</span>"}w=k+i.locale.yearName+" - "+C+i.locale.yearName}else{var E=y.clone().startOf("year");for(var T=0;T<12;T++){var S=[];if((!h||s&&E.isSameOrAfter(s,"month"))&&(!m||l&&E.isSameOrBefore(l,"month")))S.push("available");else S.push("disabled");if(i.pickerType==="month"){if(E.isSame(i.startDate,"month"))S.push("start-date","active");if(i.endDate!=null&&E.isSame(i.endDate,"month"))S.push("end-date","active");if(i.endDate!=null&&E.isSameOrAfter(i.startDate,"month")&&E.isSameOrBefore(i.endDate,"month"))S.push("in-range")}else if(E.isSame(r.month,"month"))S.push("active");x+='<span data-year="'+$+'" data-month="'+T+'" class="col-xs-4 '+S.join(" ")+'">'+i.locale.monthNames[T]+"</span>";E.add(1,"month")}w=$+i.locale.yearName}b=b.replace("_list_",x);b=b.replace("_name_",w);n.find(".select-box").remove();n.append(b);if(t)i.leftCalendar.viewYear=y;else i.rightCalendar.viewYear=y},showMonthView:function e(t){this.renderYearOrMonth(U(t.target).closest(".drp-calendar").hasClass("left"),false)},timeChanged:function e(t){var a=U(t.target);var i=this;var n=i.getTopWrap(a);var r=i.isLeft(n);var o=n.find(".hourselect");var s=n.find(".minuteselect");var l=n.find(".secondselect");var c=n.find(".ampmselect");if(a.parents(".time-picker-hour").length>0){o.val(a.data("value")).trigger("change");return}else if(a.parents(".time-picker-minute").length>0){s.val(a.data("value")).trigger("change");return}else if(a.parents(".time-picker-second").length>0){l.val(a.data("value")).trigger("change");return}else if(a.parents(".time-picker-amp").length>0){c.val(a.data("value")).trigger("change");return}var d=parseInt(o.val(),10);var u=parseInt(s.val(),10);if(isNaN(u))u=parseInt(s.find("option:last").val(),10);var p=i.timePickerSeconds?parseInt(l.val(),10):0;if(!i.timePicker24Hour){var f=c.val();if(f==="PM"&&d<12)d+=12;if(f==="AM"&&d===12)d=0}if(r){var h=i.startDate.clone();h.hour(d);h.minute(u);h.second(p);i.setStartDate(h);if(i.singleDatePicker)i.endDate=i.startDate.clone();else if(i.endDate&&i.endDate.format("YYYY-MM-DD")==h.format("YYYY-MM-DD")&&i.endDate.isBefore(h))i.setEndDate(h.clone())}else if(i.endDate){var m=i.endDate.clone();m.hour(d);m.minute(u);m.second(p);i.setEndDate(m)}i.updateCalendars();i.updateFormInputs();i.renderTimePicker("left");i.renderTimePicker("right")},parseValue:function e(t){if(t.length<=0)return false;var a=this;var i=t.split(a.locale.separator);var n=null;var r=null;if(i.length===2){n=q(i[0],a.locale.format);r=q(i[1],a.locale.format)}if(a.singleDatePicker||n===null||r===null){n=q(t,a.locale.format);r=n}if(n.isValid()&&r.isValid())return[n,r];return false},elementChanged:function e(){var t=this;if(t.startTarget){var a=U(t.startTarget);var i;if(a.is(":text"))i=a.val().trim();else i=a.html().trim();var n=a.data("ba.date.picker");var r=t.parseValue(i);if(false!==r)if(t.singleDatePicker)t.minDate=r[0];else t.minDate=r[1];if(n)t.maxDate=n.maxDate}var o=t.parseValue(t.getValue());if(false!==o){t.setStartDate(o[0]);t.setEndDate(o[1]);t.updateView();return}t.setStartDate(t.getInitStartDate());t.setEndDate(t.getInitEndDate());t.updateView()},getInitStartDate:function e(){return q()},getInitEndDate:function e(){return q().endOf("days")},keydown:function e(t){if(t.keyCode===9||t.keyCode===13)this.hide();if(t.keyCode===27){t.preventDefault();t.stopPropagation();this.hide()}},updateElement:function e(t){var a=this;if(a.autoUpdateInput||t===true){var i=a.startDate.format(a.locale.format);if(!a.singleDatePicker)i+=a.locale.separator+a.endDate.format(a.locale.format);var n=a.getValue();if(i!==n)a.triggerElementChange(i)}},getValue:function e(){var t="";var a=this.element;if(a.is(":text"))t=a.val().trim();else if(this.force)t=a.html().trim();else t=(a.data("value")||"").trim();return t},triggerElementChange:function e(t){t=t===undefined?false:t;var a=this;var i=a.element;if(i.is(":text")){if(t!==false)i.val(t);i.baTriggerEvent("input").baTriggerEvent("change")}else{if(t!==false)if(this.force)i.html(t);else i.data("value",t);Y.execCallback(a,a.options.onChange,i[0],[a],i,V.datePickerChange)}if(a.valueTarget)U(a.valueTarget).each(function(){var e=U(this);if(e.is(":text")){if(t!==false)e.val(t);e.baTriggerEvent("input").baTriggerEvent("change")}else{if(t!==false)e.html(t);Y.execCallback(a,a.options.onChange,this,[a],e,V.datePickerChange)}})},destroy:function e(){this.container.remove();this.element.off(".ba-date-picker")}},t.KEY=n,t.DEFAULTS={format:"",range:null,startDate:undefined,endDate:undefined,minDate:false,maxDate:false,force:null,valueTarget:null,clear:true,applyClass:null,nowClass:null,clearClass:null,span:null,drops:"auto",opens:"right",input:false,link:false,custom:null,ranges:undefined,endTarget:null,startTarget:null,locale:U.extend({direction:"ltr",format:"YYYY-MM-DD",separator:" - ",applyLabel:"确定",nowLabel:"现在",clearLabel:"清空",weekLabel:"W",customRangeLabel:"自定义",daysOfWeek:["日","一","二","三","四","五","六"],monthNames:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],yearName:"年",yearChoose:"请选择年份",monthChoose:"请选择月份",timeChoose:"请选择时间",timeStartChoose:"选择开始时间",timeEndChoose:"选择结束时间",secondName:"秒",hourName:"时",minuteName:"分",am:"上午",pm:"下午",thisYear:"今年",lastYear:"去年",lastNYear:"最近%s年",thisMonth:"本月",lastMonth:"上个月",lastNMonth:"最近%s个月",todayToNow:"今天到现在",lastNHours:"最近%s小时",forenoon:"上午",afternoon:"上午",allDay:"整天",lastNDay:"最近%s天",today:"今天",yesterday:"昨天"},((i.locale||{}).plugin||{}).datePicker||{})},U.fn.baDatePicker=a,U.fn.baDatePicker.Constructor=t,i.plugins.DatePicker=t,V.datePickerShow=e("show",r),V.datePickerHide=e("hide",r),V.datePickerOutsideClick=e("outside-click",r),V.datePickerShowCalendar=e("show-calendar",r),V.datePickerHideCalendar=e("hide-calendar",r),V.datePickerApply=e("apply",r),V.datePickerCancel=e("cancel",r),V.datePickerClear=e("clear",r),V.datePickerChange=e("change",r);var o=Y.pluginAttrs(r);return U("body").on("focus."+n,o,function(){(U(this).is(":text")||U(this).is("button"))&&a.call(U(this))}).on("click."+n,o,function(){U(this).is(":text")||U(this).is("button")||a.call(U(this))}),t}),define("./ba/plug/dialog",["busyAdmin","jquery","layer"],function(h,m){var n,g=h.helper,f=function e(t){m(document).one(h.e.appRenderBefore,function(){layer.close(t())})},v=function e(t){return Array.prototype.slice.call(t)},b=g.extends(layer.Constructor.pt,{vessel:function e(t,s){var a=this;var l=a.config;var i=l.success;var n=l.yes;var r=l.cancel;var o=l.end;var c=l.min;var d=l.full;var u=l.restore;var p=l.moveEnd;l.success=function(){typeof i==="function"&&i.apply(a,v(arguments))};l.yes=function(){typeof n==="function"&&n.apply(a,v(arguments))};l.cancel=function(){typeof r==="function"&&r.apply(a,v(arguments))};l.end=function(){typeof o==="function"&&o.apply(a,v(arguments))};l.min=function(){typeof c==="function"&&c.apply(a,v(arguments))};l.full=function(){typeof d==="function"&&d.apply(a,v(arguments))};l.restore=function(){typeof u==="function"&&u.apply(a,v(arguments))};l.moveEnd=function(){typeof p==="function"&&p.apply(a,v(arguments))};l.zIndex=h.defaultZIndex;var f=function e(t,a,i){h.defaultZIndex=l.zIndex;var n=m(t[1]);var r=n.find(".layui-layer-btn");var o=r.find("a[class*=layui-layer-btn]");o.each(function(){var e=m(this);if(e.hasClass("layui-layer-btn0"))e.addClass("btn btn-primary");else e.addClass("btn btn-default")});t[1]=n[0].outerHTML;s(t,a,i)};g.override(b,"vessel",a,[t,f]);return a}});layer.ready=function(e){e()},layer.config({anim:0,isOutAnim:false}),layer.area=function(e,t,a){layer.style(e,{width:t,height:a})},layer.width=function(e,t){layer.style(e,{width:t})},layer.height=function(e,t){layer.style(e,{height:t})};var t=function e(t){t=(t||"").trim();var i=this;i.message=t;i.messageElement=null;i.layer=null;f(function(){return i.index});i.index=layer.open({type:1,resize:false,title:false,closeBtn:false,btn:false,area:"auto",skin:"ba-pending"+(i.message.length?"":" ba-pending-empty"),content:'<div class="ba-pending-icon"></div><div class="ba-pending-message">'+i.message+"</div>",success:function e(t,a){i.messageElement=t.find(".ba-pending-message");i.layer=this}})};t.prototype={update:function e(t){t=(t||"").trim();var a=this;if(a.layer===null)return a;if(t.length>0){a.layer.layero.removeClass("ba-pending-empty");a.messageElement.html(t)}else a.layer.layero.addClass("ba-pending-empty");if(a.message!==t){a.message=t;a.layer.offset()}return a},close:function e(){var t=this;if(t.index!==null){layer.close(t.index);t.index=null}}};var i=function e(t,a,i){var n={};if(typeof a==="function")i=a;else if(m.isArray(a)){var r=a[0]||500;var o=a[1]||500;r=typeof r==="number"?r+"px":r;o=typeof o==="number"?o+"px":o;n.area=[r,o]}else n=a||{};if(m.isArray(t)){n.title=t[0];n.content=t[1]}else n.content=t;var s=this;var l=n.success||null;s.data=null;s.layerApi=null;n.success=function(e,t){var a=e.find("iframe");var i=a[0].contentWindow;s.layerApi=this;i.layer=window.layer;i.busyAdmin.dialog=window.busyAdmin.dialog;n.title=n.title||"";if(n.title.length===0){layer.title(a[0].contentWindow.document.title,t);this.offset()}if(typeof i.busyAdmin.dialogIframeReady==="function"){i.busyAdmin.dialogIframeReady.call(s,t);s.update()}typeof l==="function"&&l.call(s,e,t,a)};n.end=function(){typeof i==="function"&&i(s.data)};n.type=2;n.skin="ba-dialog";f(function(){return s.index});s.index=layer.open(n)};i.prototype={setData:function e(t){this.data=t;return this},setTitle:function e(t){layer.title(t,this.index);return this},setSize:function e(t,a){layer.style(this.index,{width:t,height:a});return this},setWidth:function e(t){layer.style(this.index,{width:t});return this},setHeight:function e(t){layer.style(this.index,{height:t});return this},update:function e(){if(this.layerApi!==null)this.layerApi.offset();return this},getLayerApi:function e(){return this.layerApi},close:function e(){layer.close(this.index)},getIndex:function e(){return this.index}};var r=function e(t,a,i,n){var r={title:false,scrollbar:false,skin:typeof a==="string"?a:"",closeBtn:0,move:false,anim:-1,shadeClose:true,isOutAnim:true};if((typeof a==="undefined"?"undefined":_typeof(a))==="object")r=m.extend({},r,a);r.success=function(e,t){typeof i==="function"&&i.call(this,t,this,e)};r.end=function(){typeof n==="function"&&n.call(this)};r.type=1;r.content=t;this.index=layer.open(r)};r.prototype={close:function e(){layer.close(this.index)},getIndex:function e(){return this.index}};var o=function e(t){var a=this;a.options=m.extend({},{closeButton:true,timeOut:2500},t||{});a.options.toastClass="toast ba-notify";a.ready()};o.prototype={ready:function e(t){var a=this;if(n)typeof t==="function"&&t.call(a);else requirejs([h.lib.toastr],function(e){n=e;typeof t==="function"&&t.call(a)});return this}};var y=function e(t){var a=this;a.index=t;a.shown=true;a.end=null;var i=layer.Constructor.container.end[a.index];layer.Constructor.container.end[a.index]=function(){a.shown=false;typeof i==="function"&&i.apply(this,v(arguments));typeof a.end==="function"&&a.apply(this,v(arguments))}};y.prototype={close:function e(){layer.close(this.index)},onEnd:function e(t){this.end=t;return this},getIndex:function e(){return this.index},isShown:function e(){return this.shown}};var a=function e(){};return a.prototype={alert:function(e,t,a){var i,n={},r=this;return"function"==typeof t?(a=t,n.icon=0):"object"!==(void 0===t?"undefined":_typeof(t))?n.icon=this.parseIcon(t,0):(n=t).icon=this.parseIcon(n.hasOwnProperty("icon")?n.icon:"w",0),n.closeBtn=!1,n.resize=!1,n.skin="ba-dialog",f(function(){return i}),new y(i=layer.alert(e,m.extend({},{btn:["确定"]},n),function(e,t){"function"==typeof a&&!1===a.call(r,e,this,t)||layer.close(e)}))},alertSuccess:function(e,t){return this.alert(e,"success",t)},alertError:function(e,t){return this.alert(e,"error",t)},confirm:function(e,t,a,i){var n,r={},o=this;return"function"==typeof t?(i=a,a=t,r.icon=this.parseIcon(3)):"object"!==(void 0===t?"undefined":_typeof(t))?r.icon=this.parseIcon(t,3):(r=t).icon=this.parseIcon(r.hasOwnProperty("icon")?r.icon:3,3),r.closeBtn=!1,r.resize=!1,r.skin="ba-dialog",f(function(){return n}),new y(n=layer.confirm(e,m.extend({},{btn:["确认","取消"],title:"确认提示"},r),function(e,t){"function"==typeof a&&!1===a.call(o,e,this,t)||layer.close(e)},function(e,t){return("function"!=typeof i||!1!==i.call(o,e,this,t))&&void layer.close(e)}))},prompt:function(e,t,a,n,i){var r,o={},s=this;"function"==typeof a?(i=n,n=a,o.formType=0):"object"!==(void 0===a?"undefined":_typeof(a))?o.formType=a:o=a,o.placeholder=o.placeholder||e,o.value=t;var l,c=o.success||null;o.success=function(e,t){(l=e.find(".form-control")).val(o.value||"").focus(),"function"==typeof c&&c.call(this,e,t)},o.cancel=function(e,t){if("function"==typeof i&&!1===i.call(s,e,this,t))return!1;layer.close(e)},o.btn2="select"===o.formType&&0<o.rows?function(){return l.find(":selected").prop("selected",!1),s.toast("已清空"),!1}:o.cancel,o.yes=function(e,t){var a=l.val();if("number"==o.formType){var i=g.float(a);if(0<o.maxlength&&i>o.maxlength)return s.toast("最大不能超过"+o.maxlength),l.focus(),!1;if(0<o.minlength&&i<o.minlength)return s.toast("不能小于"+o.minlength),l.focus(),!1}else if("select"==o.formType){if(o.rows){if(a=m.isArray(a)?a:[],0<o.maxlength&&a.length>o.maxlength)return s.toast("最多允许选择"+o.maxlength+"项"),l.focus(),!1;if(0<o.minlength&&a.length<o.minlength)return s.toast("至少需要选择"+o.minlength+"项"),l.focus(),!1}else if(0<o.minlength&&""===a)return s.toast("请选择"),l.focus(),!1}else{if(a=a.trim(),0<o.maxlength&&a.length>o.maxlength)return s.toast("最多允许输入"+o.maxlength+"个字符"),l.focus(),!1;if(0<o.minlength&&a.length<o.minlength)return s.toast("至少需要输入"+o.minlength+"个字符"),l.focus(),!1}if("function"==typeof n&&!1===n.call(s,l.val(),e,this,l,t))return!1;layer.close(e)};var d="";o.area&&(d='style="width: '+(t=o.area)[0]+"; height: "+t[1]+';"',delete o.area);var u="";switch(o.formType){case"textarea":u='<textarea class="form-control"'+d+' placeholder="'+(o.placeholder||e)+'" rows="'+(o.rows||2)+'"></textarea>';break;case"select":var p=o.selectOptions;m.isArray(o.selectOptions)&&(p="",o.selectOptions.map(function(e){"object"!==(void 0===e?"undefined":_typeof(e))?p+='<option value="'+e+'">'+e+"</option>":p+='<option value="'+e.value+'">'+e.name+"</option>"})),u='<select class="form-control" '+(o.rows?'multiple size="'+o.rows+'"':"")+">"+p+"</select>",o.rows&&(u+='<div class="space-10"></div><div class="text-gray text-center size-12">请按<code>CTRL+鼠标左键</code> 或 <code>拖拽鼠标</code>多选</div>');break;default:u='<input type="'+(o.formType||"text")+'" placeholder="'+(o.placeholder||e)+'" '+(o.numberStep?' step="'+o.numberStep+'"':"")+' class="form-control">'}return f(function(){return r}),new y(r=layer.open(m.extend({type:1,title:e,skin:"layui-layer-prompt ba-dialog",btn:["确认",0<o.rows?"清空":"取消"],content:u,maxWidth:m(window).width(),resize:!1},o)))},toast:function(e,t,a){var i={};return"function"==typeof t?a=t:"object"!==(void 0===t?"undefined":_typeof(t))?i.time=t?2500:1500:i=t,-1!==i.icon&&i.icon?i.skin="layui-layer-msg ba-dialog":i.skin="layui-layer-hui layui-layer-msg ba-dialog",new y(layer.msg(e,m.extend({},{time:1500},i),a))},toastSuccess:function(e,t){return this.toast(e,{shade:.1,shadeClose:!0,icon:1},t)},toastError:function(e,t){return this.toast(e,{shade:.1,shadeClose:!0,icon:2},t)},tipSuccess:function(e){"notify"==h.getConfig("app").operateTipStyle?h.dialog.notifySuccess(e):h.dialog.toastSuccess(e)},tipError:function(e){"notify"==h.getConfig("app").operateTipStyle?h.dialog.notifyError(e):h.dialog.toastError(e)},pending:function(e){return new t(e)},iframe:function(e,t,a){return new i(e,t,a)},fullRight:function(e,t,a,i){return t=void 0===t||_typeof(t)?" "+t:"",new r(e,{skin:"ba-layer-full-right ba-anim ba-anim-rl"+t,offset:"r"},a,i)},parseIcon:function(e,t){if("string"!=typeof e)return null===e?-1:e||t;switch(e.trim().toLowerCase()){case"success":case"s":case"y":case"yes":return 1;case"e":case"error":case"n":case"no":return 2;case"a":case"ask":case"q":case"question":return 3;case"l":case"lock":return 4;case"f":case"frown":return 5;case"sm":case"smile":return 6;case"w":case"warn":case"warning":default:return 0}}},m.map(["Success","Warning","Info","Error"],function(e){var i=e.toLowerCase();o.prototype[i]=function(e,t){return n.options=this.options,n[i](e,t),this},a.prototype["notify"+e]=function(e,t,a){return a=a||{},"object"==(void 0===t?"undefined":_typeof(t))?(a=t,t=e,e=void 0):"function"==typeof t?(a.onHidden=t,t=void 0):"function"==typeof a&&(a={onHidden:a}),new o(a||{}).ready(function(){this[i](t,e)})}}),h.dialog=new a,h.dialogIframeReady=null,a}),define("./ba/plug/editor",["busyAdmin","jquery"],function(u,p){var f,r,o={ck5:"ck5"},h=u.helper,m=u.e,s="editor",l=h.pluginKey(s);m.editorInitialized=u.ee("initialized",s);var g=function e(t,a){this.loader=t;this.options=a};g.prototype={upload:function e(){var t=this;return t.loader.file.then(function(e){return new Promise(function(i,n){t.request=u.request(r.url).params({class_type:t.options.imageClass,class_value:t.options.classValue}).addParam("upload",e).pending(false).progress(function(e){if(e.lengthComputable){t.loader.uploadTotal=e.total;t.loader.uploaded=e.loaded}}).success(function(e,t,a){i({default:e.result.file_url});return false}).error(function(e,t,a){n(e.message)}).exec()})})},abort:function e(){if(this.request)this.request.abort()}};var n="editor.ck5",v=function e(t,a){var i=b();i[t]=a;localStorage.setItem(u.app.cacheKey(n),JSON.stringify(i))},b=function e(t){var a=JSON.parse(localStorage.getItem(u.app.cacheKey(n))||"{}");if(!t)return a;return a[t]},y=function e(t,a){var i=this,n;i.element=t;i.$element=p(t);i.index=e.INDEX++;n=i.options=p.extend(true,{},e.DEFAULTS,i.$element.baData(s),a||{});i.formStatus=i.$element.baFormStatus(i).render();i.resetEvent="reset."+l+i.index;i.$form=i.$element.closest("form");i.$form.on(i.resetEvent,function(){i.setContent(i.defaultValue)});if(i.$element.is(":input")){i.defaultValue=i.$element.val();var r=i.$element.attr("placeholder");if(r)n.placeholder=r;var o=i.$element.attr("name");if(o)n.name=o}else i.defaultValue=i.$element.html();if(n.toolbar&&typeof n.toolbar==="string")n.toolbar=p.map(n.toolbar.split(","),function(e){e=e.trim();if(e)return e;return null});i.ready(i._init)};function e(e){return h.pluginFn(this,y,e,arguments,"api")}return y.prototype={ready:function(i){var n=this,e=window.UEDITOR_CONFIG&&n.options.type!=o.ck5,t=f&&n.options.type==o.ck5;e||t?i.call(n):n.options.type===o.ck5?(t=(t=u.requirePaths[u.lib.ckEditor5Classic].split("/"))[0]+"/"+t[1]+"/translations/"+n.options.locale,requirejs([u.lib.ckEditor5Classic,t,u.lib.uploadConfig],function(e,t,a){f=e,window.CKClassicEditor=e,r=a,i.call(n)})):requirejs([u.lib.ueditor,u.lib.zeroClipboard],function(e,t){window.ZeroClipboard=t,window.UEDITOR_CONFIG.UEDITOR_HOME_URL=u.moduleRoot()+"ueditor/",UE.Editor.prototype.placeholder=function(e){p(this.document.body).attr("data-placeholder",e)},i.call(n)})},_init:function(){var e=this,t=e.options,a=p.proxy(e.destroy,e);p(document).one(m.appRenderBefore,a),e.modal=e.$element.closestBaModal(),e.modal&&e.modal.$element.one(m.modalHide,a),t.type===o.ck5?e._initCkEditor():e._initUEditor()},_initCkEditor:function(){var a=this,i=a.options,e=p.extend(!0,{},y.CKEDITOR_TYPES[i.mode||"small"]||{});!1===i.mode&&(e={}),i.toolbar&&(e.toolbar=i.toolbar),e.toolbar&&p.isArray(e.toolbar)&&(e.toolbar={items:e.toolbar,shouldNotGroupWhenFull:!0});for(var t=[{model:"paragraph",title:"Paragraph",class:"ck-heading_paragraph"}],n=1;n<7;n++)t.push({model:"heading"+n,view:"h"+n,title:"Heading "+n,class:"ck-heading_heading"+n});function r(){return a.ckEditor?(a.$ckEl||(a.$ckEl=p(a.ckEditor.ui.view.element)),a.$ckEl):p([])}var o,s,l,c={language:i.locale,removePlugins:["Title","Markdown"],heading:{options:t},image:{toolbar:["imageTextAlternative","toggleImageCaption","|","imageStyle:inline","imageStyle:wrapText","imageStyle:breakText","imageStyle:side","|","resizeImage"]},table:{contentToolbar:["tableColumn","tableRow","mergeTableCells","tableProperties","tableCellProperties","toggleTableCaption"]}},d=!0;i.autoSave&&(l="string"==typeof i.autoSave?i.autoSave:null,s=o=null,l=l||(location.protocol+location.host+location.pathname).replace(/[.:\/]/g,"_"),l+="_drafts",c.autosave={save:function(a){return o||(o=p('<div class="alert alert-info alert-sm ck-alert-auto-save-tip">本地保存成功</div>').hide(),r().find(".ck-editor__main").append(o)),new Promise(function(e,t){if(!d)return d=!0,void e();v(l,a.getData()),o.fadeIn(),clearTimeout(s),s=setTimeout(function(){o.fadeOut()},1500),e()})}}),u.formSubmitIgnore.push(function(e){return p(this).hasClass("ck")}),u.linkClickIgnore.push(function(e){return p(this).hasClass("ck-link_selected")}),a.$element.on(m.validateErrorPlacement,function(e,t){return r().after(t),!1}),f.create(a.element,p.extend({},p.extend({},c,i.options||{}),e)).then(function(e){var t;a.ckEditor=e,a.api=e,u.app.triggerResize(),a.formStatus.rendered(),e.model.document.on("change:data",function(){a.$element.val(a.ckEditor.getData()).baTriggerEvent("input").baTriggerEvent("change")}),e.plugins.get("FileRepository").createUploadAdapter=function(e){return new g(e,i)},u.app.isInContent(a.$element)&&(t=u.app.getContentFrame(),e.ui.viewportOffset={top:t.top,right:0,bottom:0,left:0}),e.isReadOnly=a.$element.prop("disabled"),i.autoSave&&l&&(d=!1,e.setData(b(l)||"")),h.triggerPluginReady(a.$element,a,"",m.editorInitialized)}).catch(function(e){console.error(e)})},_initUEditor:function(){var e=this,t=e.$element;e.elementId=t.attr("id")||"",e.editorId=e.elementId+"__baEditor_"+e.index,t.removeAttr("class",""),t.attr("id",e.editorId);var a=e.options,i=p.extend(!0,{},y.UEDITOR_TYPES[a.mode||"small"]||{});!1===a.mode&&(i={}),a.toolbar&&(i.toolbars=[a.toolbar]);var n={};p.extend(!0,n,{charset:"utf-8",wordCount:a.showCount,enableAutoSave:a.autoSave,autoSaveKey:a.autoSave&&"string"==typeof a.autoSave?a.autoSave:null,zIndex:p.isNumeric(a.zindex)?a.zindex:u.zIndex(),catchRemoteImageEnable:a.catchRemoteImage,autoHeightEnabled:a.autoHeight,elementPathEnabled:a.elementPath,whitList:a.whitList,lang:a.locale,xssFilterRules:!0,inputXssFilter:!0,outputXssFilter:!0,insertorderedlist:{decimal:"","decimal-leading-zero":"01,02,03...","lower-alpha":"","upper-alpha":"","lower-roman":"","upper-roman":"","cjk-ideographic":"一,二,三..."},insertunorderedlist:{circle:"",disc:"",square:""},showImageOnlineManager:a.imageManager,showAttachmentOnlineManage:a.fileManager,showVideoOnlineManage:a.videoManager,allowVideoUpload:a.videoUpload,autoFloatEnabled:a.stickyToolbar,topOffset:"auto"===a.stickyTopOffset?0:a.stickyTopOffset,toolbarTopOffset:"auto"===a.stickyTopOffset?0:a.stickyTopOffset,textarea:a.name,initialFrameHeight:100,imageClass:a.imageClass,videoClass:a.videoClass,fileClass:a.fileClass,classValue:a.classValue,useImageExtensions:!p.baIsEmpty(a.imageExtensions),useImageMimetypes:!p.baIsEmpty(a.imageMimetypes),useImageMaxSize:!p.baIsEmpty(a.imageMaxSize),useVideoExtensions:!p.baIsEmpty(a.videoExtensions),useVideoMimetypes:!p.baIsEmpty(a.videoMimetypes),useVideoMaxSize:!p.baIsEmpty(a.videoMaxSize),useFileExtensions:!p.baIsEmpty(a.fileExtensions),useFileMimetypes:!p.baIsEmpty(a.fileMimetypes),useFileMaxSize:!p.baIsEmpty(a.fileMaxSize),preferencesKey:function(){return u.app.cacheKey("editor.ue")}},a.options||{},i),"auto"===a.stickyTopOffset&&u.app.isInContent(t)&&(s=u.app.getContentFrame(),n.topOffset=s.top,n.toolbarTopOffset=s.top);var r=window.UEDITOR_CONFIG,o=r.uploadCategory,i=function(t,e){n[t]=[],p.map(a[e].split(","),function(e){e="."+e.toLocaleLowerCase();-1!==r[t].indexOf(e)&&n[t].push(e)})},s=o[a.imageClass]||null;s&&(p.baIsEmpty(a.imageExtensions)&&(a.imageExtensions=s.allow_extensions.join(",")),p.baIsEmpty(a.imageMimetypes)&&(a.imageMimetypes=s.allow_mimetypes.join(",")),p.isNumeric(a.imageMaxSize)||(a.imageMaxSize=s.max_size)),a.imageExtensions&&i("imageAllowFiles","imageExtensions"),a.imageMimetypes&&(n.imageMimetypes=a.imageMimetypes),p.isNumeric(a.imageMaxSize)&&(n.imageMaxSize=a.imageMaxSize);s=o[a.videoClass]||null;s&&(p.baIsEmpty(a.videoExtensions)&&(a.videoExtensions=s.allow_extensions.join(",")),p.baIsEmpty(a.videoMimetypes)&&(a.videoMimetypes=s.allow_mimetypes.join(",")),p.isNumeric(a.videoMaxSize)||(a.videoMaxSize=s.max_size)),a.videoExtensions&&i("videoAllowFiles","videoExtensions"),a.videoMimetypes&&(n.videoMimetypes=a.videoMimetypes),p.isNumeric(a.videoMaxSize)&&(n.videoMaxSize=a.videoMaxSize);o=o[a.fileClass]||null;o&&(p.baIsEmpty(a.fileExtensions)&&(a.fileExtensions=o.allow_extensions.join(",")),p.baIsEmpty(a.fileMimetypes)&&(a.fileMimetypes=o.allow_mimetypes.join(",")),p.isNumeric(a.fileMaxSize)||(a.fileMaxSize=o.max_size)),a.fileExtensions&&i("fileAllowFiles","fileExtensions"),a.fileMimetypes&&(n.fileMimetypes=a.fileMimetypes),p.isNumeric(a.fileMaxSize)&&(n.fileMaxSize=a.fileMaxSize),e.modal&&(-1!=(i=(o=n.toolbars[0]||[]).indexOf("fullscreen"))&&(o=o.del(i)),n.toolbars=[o]),t.css("width","100%");function l(){p(c.document.body).toggleClass("no-has-contents",!c.hasContents())}var c=e.api=e.ueditor=UE.getEditor(e.editorId,n);t.on(m.validateErrorPlacement,function(e,t){return p("#"+c.key).after(t),!1}),c.on("beforefullscreenchange",function(e,t){this.options.topOffset=t?0:n.topOffset}),c.on("fullscreenchanged",function(e,t){p(this.container).toggleClass("edui-fullscreen",t)}),c.addListener("contentchange",function(){t.val(this.getContent("html")).baTriggerEvent("input").baTriggerEvent("change"),l()}),c.addListener("blur",function(){t.trigger("blur")}),c.addListener("focus",function(){t.trigger("focus")}),c.ready(function(){t.attr("id",e.elementId),c.execCommand("serverparam",{class_file_type:a.fileClass,class_image_type:a.imageClass,class_video_type:a.videoClass,class_value:a.classValue}),c.getOpt("enableAutoSave")&&(c.getContent()||c.execCommand("drafts")),t.prop("disabled")&&c.setDisabled(),p(c.document.head).append("<style>body.no-has-contents::before { content: attr(data-placeholder); position: absolute; pointer-events: none; cursor: text; color: #707070; } </style>"),c.placeholder(e.options.placeholder),l(),u.app.triggerResize(),e.formStatus.rendered(),h.triggerPluginReady(e.$element,e,"",m.editorInitialized)})},_api:function(e,t){return this.options.type!==o.ck5?this.ueditor?"function"==typeof e&&e.call(this):null:this.ckEditor?"function"==typeof t&&t.call(this):null},getApi:function(){return this.api},getContent:function(t){return this._api(function(){var e=this.ueditor;switch(t){case"html":return e.getContent();case"text":return e.getContentTxt();default:return e.getPlainTxt()}},function(){return this.ckEditor.getData()})},setContent:function(e){this._api(function(){this.ueditor.setContent(e+"")},function(){this.ckEditor.setData(e+"")})},append:function(e){this._api(function(){this.ueditor.setContent(e+"",!0)},function(){this.ckEditor.setData(this.ckEditor.getData()+e+"")})},hasContent:function(){return this._api(function(){return this.ueditor.hasContents()},function(){return 0<this.ckEditor.getData().length})},setFocus:function(e){this._api(function(){e?this.ueditor.focus():this.ueditor.blur()},function(){e&&this.ckEditor.focus()})},setDisabled:function(e){this._api(function(){e?this.ueditor.setDisabled():this.ueditor.setEnabled()},function(){this.ckEditor.isReadOnly=e})},setPlaceholder:function(e){this.options.placeholder=e,this._api(function(){this.ueditor.placeholder(e)},function(){this.ckEditor.config.set("placeholder",e),this.ckEditor.ui._initPlaceholder()})},exec:function(e){var t=Array.prototype.slice.call(arguments);return this._api(function(){return this.ueditor.execCommand.apply(this.ueditor,t)},function(){return this.ckEditor.execute.apply(this.ckEditor,t)})},destroy:function(){this.$form.off(this.resetEvent),this._api(function(){UE.delEditor(this.editorId),p("#edui_fixedlayer").remove(),this.ueditor=null},function(){this.ckEditor.destroy().catch(),this.ckEditor=null}),this.api=null}},y.DEFAULTS={type:"ue",name:"content",placeholder:"",classValue:"",imageClass:"",imageExtensions:null,imageMimetypes:null,imageMaxSize:null,videoClass:"",videoExtensions:null,videoMimetypes:null,videoMaxSize:null,fileClass:"",fileExtensions:null,fileMimetypes:null,fileMaxSize:null,imageManager:!0,videoManager:!0,fileManager:!0,showCount:!1,autoSave:!1,zindex:null,catchRemoteImage:!0,videoUpload:!1,autoHeight:!1,elementPath:!1,stickyToolbar:!1,stickyTopOffset:"auto",toolbar:null,mode:"",whitList:{a:["target","href","title","class","style"],abbr:["title","class","style"],address:["class","style"],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","loop","preload","src","class","style"],b:["class","style"],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite","class","style"],br:[],caption:["class","style"],center:[],cite:[],code:["class","style"],col:["align","valign","span","width","class","style"],colgroup:["align","valign","span","width","class","style"],dd:["class","style"],del:["datetime"],details:["open"],div:["class","style"],dl:["class","style"],dt:["class","style"],em:["class","style"],font:["color","size","face"],footer:[],h1:["class","style"],h2:["class","style"],h3:["class","style"],h4:["class","style"],h5:["class","style"],h6:["class","style"],header:[],hr:[],i:["class","style"],img:["src","alt","title","width","height","id","_src","loadingclass","class","data-latex"],ins:["datetime"],li:["class","style"],mark:[],nav:[],ol:["class","style"],p:["class","style"],pre:["class","style"],s:[],section:[],small:[],span:["class","style"],sub:["class","style"],sup:["class","style"],strong:["class","style"],table:["width","border","align","valign","class","style"],tbody:["align","valign","class","style"],td:["width","rowspan","colspan","align","valign","class","style"],tfoot:["align","valign","class","style"],th:["width","rowspan","colspan","align","valign","class","style"],thead:["align","valign","class","style"],tr:["rowspan","align","valign","class","style"],tt:[],u:[],ul:["class","style"],video:["autoplay","controls","loop","preload","src","height","width","class","style"]},locale:"zh-cn"},y.INDEX=0,y.UEDITOR_TYPES={default:{toolbars:[["fullscreen","source","|","undo","redo","|","bold","italic","underline","fontborder","strikethrough","superscript","subscript","removeformat","formatmatch","autotypeset","blockquote","pasteplain","|","forecolor","backcolor","insertorderedlist","insertunorderedlist","selectall","cleardoc","|","rowspacingtop","rowspacingbottom","lineheight","|","paragraph","fontfamily","fontsize","|","directionalityltr","directionalityrtl","indent","|","justifyleft","justifycenter","justifyright","justifyjustify","|","touppercase","tolowercase","|","link","unlink","anchor","|","imagenone","imageleft","imageright","imagecenter","|","simpleupload","insertimage","attachment","insertvideo","scrawl","|","wordimage","insertcode","pagebreak","map","horizontal","date","time","spechars","|","inserttable","deletetable","insertparagraphbeforetable","insertrow","deleterow","insertcol","deletecol","mergecells","mergeright","mergedown","splittocells","splittorows","splittocols","|","print","preview","searchreplace"]]},small:{toolbars:[["fullscreen","source","|","undo","redo","|","bold","italic","underline","fontborder","strikethrough","superscript","subscript","removeformat","formatmatch","autotypeset","blockquote","pasteplain","|","forecolor","backcolor","insertorderedlist","insertunorderedlist","|","paragraph","fontsize","|","indent","justifyleft","justifycenter","justifyright","justifyjustify","|","link","unlink","anchor","|","simpleupload","insertimage","scrawl","|","horizontal","spechars","|","inserttable","deletetable","|","print","preview","searchreplace"]]},text:{toolbars:[["source","undo","redo","|","bold","italic","underline","removeformat","formatmatch","autotypeset","forecolor","link","unlink"]],enableContextMenu:!1,pasteplain:!0,filterTxtRules:function(){function e(e){e.tagName="p",e.setAttr("style",""),e.setAttr("class","")}return{"-":"script style object iframe embed input select textarea",p:{$:{}},a:{$:{href:"",target:"",title:""}},br:{$:{}},div:{$:{}},li:{$:{}},caption:e,th:e,tr:e,h1:e,h2:e,h3:e,h4:e,h5:e,h6:e,td:function(e){e.innerText()&&e.parentNode.insertAfter(UE.uNode.createText(" &nbsp; &nbsp;"),e),e.parentNode.removeChild(e,e.innerText())}}}()}},y.KEY=l,y.CKEDITOR_TYPES={default:{toolbar:["sourceEditing","|","undo","redo","|","heading","|","bold","italic","underline","strikethrough","link","superscript","subscript","removeFormat","|","fontColor","fontBackgroundColor","highlight","numberedList","bulletedList","todoList","|","fontFamily","fontSize","|","outdent","indent","|","alignment","|","blockQuote","uploadImage","insertTable","|","pageBreak","horizontalLine","codeBlock","specialCharacters","selectAll","findAndReplace"]},small:{toolbar:["sourceEditing","|","undo","redo","|","heading","|","bold","italic","underline","strikethrough","link","|","fontColor","fontBackgroundColor","bulletedList","numberedList","alignment","outdent","indent","|","blockQuote","uploadImage","insertTable","|","horizontalLine","specialCharacters","findAndReplace"]},text:{toolbar:["undo","redo","|","bold","italic","underline","strikethrough","link"]}},p.fn.baEditor=e,p.fn.baEditor.Constructor=y,u.plugins.Editor=y,u.autoInit(s,h.pluginAttrs(s),function(){e.call(this)}),y}),define("./ba/plug/elementUi",["busyAdmin","jquery"],function(n,r){var t=n.helper,e=n.e,o="element-ui",a=t.pluginKey(o),i=false,s=function e(t){if(i)return;i=true;l.ELEMENT=t;n.plugins.Vue.Vue.use(t)},l=function e(t,a){var i=this;i.element=t;i.$element=r(t);i.options=r.extend(true,{},n.plugins.Vue.DEFAULTS,i.$element.baData(o)||{},a||{});i.ready(i._init)};function c(e){return t.pluginFn(this,l,e,arguments,"api")}return l.prototype={ready:function(t){var a=this;window._BaElementUI&&(l.ELEMENT=window._BaElementUI,i=!0),i?t.call(a):n.plugins.Vue.ready(function(){n.require([n.lib.elementUi],function(e){s(e),t.call(a)})})},_init:function(){this.api=this.$element.baVue(this.options).data(n.plugins.Vue.KEY)}},l.ELEMENT=null,l.KEY=a,r.fn.baElementUI=c,r.fn.baElementUI.Constructor=l,n.plugins.ElementUI=l,n.autoInit(o,t.pluginAttrs(o),function(){c.call(r(this))}),l}),define("./ba/plug/filePicker",["busyAdmin","jquery"],function(i,n){var r=null,e=undefined,t=i.helper,o="file-picker",a=t.pluginKey(o),s=function e(t,a){var i=this;i.element=t;i.$element=n(t);i.options=n.extend(true,{},e.DEFAULTS,i.$element.baData(o)||{},a||{});i.ready(i._init)};function l(e){return i.helper.pluginFn(this,s,e,arguments,[],function(){this.options.show&&this.ready(this.show)})}return s.prototype={ready:function(t){var a=this;r?_typeof(t.call(a)):requirejs([i.lib.uploadConfig],function(e){r=e,_typeof(t.call(a))})},_init:function(){var e=this.options;this.$element.baModal({show:!1,keyboard:!1,title:e.title,zindex:e.zindex,type:"page",size:"lg",className:"ba-file-picker",url:r.picker,picker:this},!0)},show:function(){this.$element.baModal("show")},destroy:function(){}},s.LOCALE={delete:"删除",confirm:"确定",cancel:"取消",clear:"清空",search:"搜索",reset:"重置",upload:"上传",uploadSuccess:"上传成功",placeholder:"请输入关键词",currentInfo:"当前信息",allCategory:"所有分类",allFile:"全部文件",noData:"暂无相关文件",noExtensionsData:"暂无 <code>%s</code> 格式的文件",noSelect:"空",selected:"已选",pleaseSelectFile:"请选择文件",maxSelectAllowed:"最多允许选择%s个文件",pleaseSelectDelete:"请选择要删除的文件",confirmDeleteSelect:"确认要删除选中的%s个文件吗？",confirmDelete:"确认要删除选文件%s吗？"},s.KEY=a,s.DEFAULTS={show:!0,title:"",classType:"",classValue:"",maxSize:e,mimetypes:e,extensions:e,count:9,success:n.noop,zindex:"auto",locale:n.extend(s.LOCALE,((i.locale||{}).plugin||{}).filePicker||{})},n.fn.baFilePicker=l,n.fn.baFilePicker.Constructor=s,i.plugins.FilePicker=s,i.e.filePickerSuccess=i.ee("success",o),n("body").on("click."+a,t.pluginAttrs(o),function(e){l.call(n(this))}),s}),define("./ba/plug/form",["busyAdmin","jquery"],function(s,l){"use strict";var c=s.helper,e=s.ee,d=s.e,n="form",u=c.pluginKey(n);d.formInitialized=e("initialized",n),d.formCheck=e("check",n),d.formBefore=e("before",n),d.formComplete=e("complete",n),d.formSuccess=e("success",n),d.formError=e("error",n),d.formWaiting=e("waiting",n),d.formDisabled=e("disabled",n),d.formEnabled=e("enabled",n),d.formChildRender=e("child-render",n),d.formChildRendered=e("child-rendered",n),d.formChildRun=e("child-run",n),d.formChildRan=e("child-ran",n);var p=function e(t){return Array.prototype.slice.call(t)},f=function e(t,a){var i=this;i.element=t;i.$element=l(t);i.options=l.extend(true,{},e.DEFAULTS,i.$element.baData(n)||{},a||{});i.renderChilds=[];i.runChilds=[];i.disabled=false;i._init()};function t(e){return c.pluginFn(this,f,e,arguments)}f.prototype={_init:function e(){var i=this;var t=i.$element;var a=i.options;if(!a.action)a.action=t.attr("action")||"";if(!a.action)a.action=document.URL;if(!a.method)a.method=t.attr("method")||"";if(!a.method)a.method=f.DEFAULTS.method;if(a.validate){var n=c.parseData(a,"validate");n.onSubmit=function(){i.submit();return false};t.baValidate(n)}else t.on("submit."+u,function(){i.submit();return false});t.on(d.formChildRun+"."+u,function(e,t,a){i.runChilds.push(t);i.setDisabled(true)}).on(d.formChildRan+"."+u,function(e,t,a){i._waitChildRan()}).on(d.formChildRender+"."+u,function(e,t,a){i.renderChilds.push(t);i.setDisabled(true)}).on(d.formChildRendered+"."+u,function(e,t,a){i._waitChildRendered()});var r=l.proxy(i.destroy,i);l(document).one(d.appRenderBefore,r);var o=i.$element.closestBaModal();if(o)o.$element.one(d.modalHide,r);c.triggerPluginReady(t,i,"",d.formInitialized)},_waitChildRendered:function e(){var a=this;clearTimeout(a._waitChildRenderedTimeId);a._waitChildRenderedTimeId=setTimeout(function(){for(var e=0;e<a.renderChilds.length;e++){var t=a.renderChilds[e];if(t&&t.data(d.formChildRendered)!==true){a._waitChildRendered();return}}a.setDisabled(false)},100)},_waitChildRan:function e(){var a=this;clearTimeout(a._waitChildRanTimeId);a._waitChildRanTimeId=setTimeout(function(){for(var e=0;e<a.runChilds.length;e++){var t=a.runChilds[e];if(t&&t.data(d.formChildRan)!==true){a._waitChildRan();return}}a.setDisabled(false)},100)},setDisabled:function e(t){var a=this;if(!a.$buttons)a.$buttons=a.$element.find(":submit,:reset");if(a.disabled&&t){c.execCallback(a,a.options.onWaiting,a.element,[],a.$element,d.formWaiting);return}a.$buttons.prop("disabled",t).toggleClass("disabled",t);a.disabled=t;c.execCallback(a,a.options[t?"onDisabled":"onEnabled"],a.element,[],a.$element,t?d.formDisabled:d.formEnabled)},submit:function e(){var t=this;var a=t.options;var i=t.$element;if(t.disabled){s.dialog.toast("请稍后在提交");return}if(a.validate&&!i.baValidate("valid"))return;if(false===c.execCallback(t,a.onCheck,t.element,[],i,d.formCheck,true,false))return;var n=a.confirm;if(n){if(t.dialog&&t.dialog.isShown())return;t.dialog=s.dialog.confirm(n,function(){t.request()})}else t.request()},request:function e(){var i=this;var n=i.options;var r=i.$element;var o=i.element;if(i.pending)return null;i._abort();i.pending=true;i.task=s.request(n.action).pending(n.pending,n.pendingMessage).method(n.method).params(r).before(function(e,t){return false!==c.execCallback(i,n.onBefore,o,p(arguments),r,d.formBefore,true,false)}).complete(function(e,t,a){i.pending=false;return false!==c.execCallback(i,n.onComplete,o,p(arguments),r,d.formComplete,true,false)}).success(function(e,t,a){if(false===c.execCallback(i,n.onSuccess,o,p(arguments),r,d.formSuccess,true,false))return false;if(n.onSuccess===false)return false;s.dialog.tipSuccess(e.message);return false}).error(function(e,t,a){if(false===c.execCallback(i,n.onError,o,p(arguments),r,d.formError,true,false))return false;if(n.onError===false)return false;s.dialog.tipError(e.message);return false}).exec();return i.task},reset:function e(){this.element.reset();this.$element.trigger("reset")},_abort:function e(){var t=this;if(t.task){t.task.abort();t.task=null}},destroy:function e(){var t=this;t.$element.off("."+u);t._abort();t.renderChilds=[];t.runChilds=[];t.disabled=false;clearTimeout(t._waitChildRenderedTimeId);clearTimeout(t._waitChildRanTimeId)}},f.KEY=u,f.DEFAULTS={confirm:"",pending:true,pendingMessage:"",method:"post",action:"",validate:true,onCheck:l.noop,onBefore:l.noop,onSuccess:l.noop,onError:l.noop,onComplete:l.noop};var a=function e(t,a){this.elem=t;this.$form=this.elem.closest("form");this.plugin=a};return a.prototype={render:function(){var e=this;return e.$form.length&&(e.elem.data(d.formChildRendered,!1),e.$form.triggerHandler(d.formChildRender,[e.elem,e.plugin])),e},rendered:function(){var e=this;return e.$form.length&&(e.elem.data(d.formChildRendered,!0),e.$form.triggerHandler(d.formChildRendered,[e.elem,e.plugin])),e},run:function(){var e=this;return e.$form.length&&(e.elem.data(d.formChildRan,!1),e.$form.triggerHandler(d.formChildRun,[e.elem,e.plugin])),e},ran:function(){var e=this;return e.$form.length&&(e.elem.data(d.formChildRan,!0),e.$form.triggerHandler(d.formChildRan,[e.elem,e.plugin])),e}},l.fn.baFormStatus=function(e){return new a(this,e)},l.fn.baForm=t,l.fn.baForm.Constructor=f,s.plugins.Form=f,s.regSugar(n,function(e,t,a){var i;e&&(i=l(this),a.api instanceof s.plugins.Modal&&(i=a.api.$form),(i=i.data(f.KEY))instanceof f&&i[e](t))}),s.autoInit(n,c.pluginAttrs(n),function(){t.call(this)}),f}),define("./ba/plug/high",["busyAdmin","jquery"],function(i,n){"use strict";var s=null,l=i.helper,r="high-code",e=l.pluginKey(r);i.e.highCodeInitialized=i.ee("initialized",r);var c=function e(t,a){var i=this;i.$element=n(t);i.$wrap=null;i.options=n.extend(true,{},e.DEFAULTS,i.$element.baData(r)||{},a||{});i.ready(i._init)};function t(e){return l.pluginFn(this,c,e,arguments)}return c.prototype={ready:function(t){var a=this;s?t.call(a):requirejs([i.lib.highlight],function(e){s=e,t.call(a)})},_init:function(){var e=this,t=e.options,a=e.$element;e.$wrap=n(c.parse(a.html(),t.type,"",t.locale.copy)),a.hide().after(e.$wrap),l.triggerPluginReady(a,e,"",i.e.HighCodeInitialized)},reload:function(){this.$wrap&&this.$wrap.remove(),this._init()},destroy:function(){}},c.KEY=e,c.DEFAULTS={type:"auto",locale:n.extend({copy:"复制"},((i.locale||{}).plugin||{}).highCode||{})},c.highlight=null,c.parse=function(e,t,a,i){var n;null===s&&(s=c.highlight);var r="",o=l.uuid();return e=(e||"").trim(),"string"==typeof t&&t&&"auto"!==t?(n=s.highlight(t,e).value,r=t):(t="code",n=s.highlightAuto(e).value),'<div class="ba-high-code '+(a||"")+'"><div class="ba-high-code-title"><a href="javascript:void(0)" class="pull-right" data-toggle="busy-copy" data-target="#'+o+'" data-on-decode="html">'+(i||"复制")+"</a>"+t+'</div><pre><code class="hljs '+r+'">'+(n="<ol><li>"+n.replace(/\n/g,"</li><li>")+"</li></ol>")+'</code></pre><script type="text/plain" id="'+o+'">'+l.htmlToEscape(e)+"<\/script></div>"},n.fn.baHighCode=t,n.fn.baHighCode.Constructor=c,i.plugins.High=c,i.autoInit(r,l.pluginAttrs(r),function(){t.call(this)}),c}),define("./ba/plug/iconPicker",["busyAdmin","jquery"],function(e,p){"use strict";var f,h=e.helper,t=e.ee,m=e.e,n="icon-picker",r=h.pluginKey(n),a=function e(t,a){var i=this;i.element=t;i.$element=p(t);i.index=e.INDEX++;i.options=p.extend(true,{},e.DEFAULTS,i.$element.baData(n)||{},a||{});i.defaultValue=i._getValue();i.resetEvent="reset."+r+i.index;i.$form=i.$element.closest("form");i.$form.on(i.resetEvent,function(){i.setValue(i.defaultValue)});i.ready(i._init)};function i(e){return h.pluginFn(this,a,e,arguments,null,function(){this.options.show&&this.show()})}return a.prototype={ready:function(t){var a=this;f?t.call(a):requirejs(["bicon/busy-icon-data"],function(e){f=e,t.call(a)})},_init:function(){var a,n=this,e=n.options,t=e.locale,r=n.$element,i="",o="",s=0;for(a in f){var l=f[a],c=0===s?" active":"",d="__ba_icon_tab"+s;i+='<li class="'+c+'"><a href="#'+d+'" data-toggle="tab">'+l.name+' <span class="badge badge-primary">'+l.list.length+"</span></a></li>",o+='<div class="tab-pane'+c+'" id="'+d+'"><ul>',l.list.map(function(e){var t=a+" "+a+"-"+e;o+='<li><span class="keyword hide">'+e+'</span><a href="javascript:void(0);" icon="'+t+'"><i class="'+t+'"></i><span>'+e+"</span></a></li>"}),o+="</ul></div>",s++}var u=p('<div class="ba--content"><ul class="nav nav-lines nav-justified">'+i+'</ul><div class="form-horizontal"><input type="text" class="form-control" placeholder="'+t.search+'"/></div><div class="tab-content">'+o+"</div></div>");r.baModal({show:!1,type:"page",content:u,title:t.title,className:"ba-icon-picker",cancel:t.clear,onCancel:function(){n.setValue(""),r.baModal("close"),h.execCallback(n,e.onClear,n.element,[],r,m.iconPickerClear)},padding:0,onShown:function(e){var t=n.$content=e.$dialogBody.find(".ba--content");t.on("click","[icon]",function(){var e=p(this).attr("icon");n.setValue(e),r.baModal("close")}),t.on("input",".form-control",function(){var e=p(this).val().trim();e?(t.find(".keyword:contains("+e+")").parent().show(),t.find(".keyword:not(:contains("+e+"))").parent().hide()):t.find(".keyword").parent().show()}),t.find(".active[icon]").removeClass("active");var a=t.find('[icon="'+n._getValue()+'"]').addClass("active"),i=a.closest(".tab-pane").attr("id");i&&(e=a.closest(".tab-content"),t.find('[href="#'+i+'"]').trigger("click"),e.scrollTop(a.offset().top-e.offset().top+e.scrollTop()))}},!0)},_getValue:function(){var t;return this.$element.is(":input")&&(t=this.$element.val().trim()),!t&&this.options.target&&p(this.options.target).each(function(){var e=p(this);if(t=e.is(":input")?e.val().trim():e.attr("class"))return!1}),t||""},setValue:function(t){var e=this.$element,a=this.options;e.is(":input")&&e.val(t).baTriggerEvent("input").baTriggerEvent("change"),a.target&&p(a.target).each(function(){var e=p(this);e.is(":input")?e.val(t).baTriggerEvent("input").baTriggerEvent("change"):e.removeAttr("class").addClass(t||"icon-placeholder")}),h.execCallback(this,a.onSelect,this.element,[t],e,m.iconPickerSelect)},show:function(){var e=this;e.ready(function(){e.$element.baModal("show")})},destroy:function(){this.$form.off(this.resetEvent)}},a.INDEX=0,a.KEY=r,a.DEFAULTS={show:!0,target:null,locale:p.extend({},{title:"图标选择器",clear:"清空",search:"搜索图标"},((e.locale||{}).plugin||{}).iconPicker||{})},p.fn.baIconPicker=i,p.fn.baIconPicker.Constructor=a,e.plugins.IconPicker=a,m.iconPickerSelect=t("select",n),m.iconPickerClear=t("clear",n),p("body").on("focus."+r,':input[data-toggle="busy-'+n+'"],:input[busy-'+n+"]",function(){i.call(p(this))}).on("click."+r,'[data-toggle="busy-'+n+'"]:not(:input),[busy-'+n+"]:not(:input)",function(e){i.call(p(this))}),a}),define("./ba/plug/imageViewer",["busyAdmin","jquery"],function(r,o){var s=r.helper,l=r.e,n="image-viewer",c=s.pluginKey(n),t=function e(t,a){var i=this;i.element=t;i.isSingle=false;i.$element=o(t);i.$img=null;i.options=o.extend(true,{},e.DEFAULTS,i.$element.baData(n)||{},a||{});i.api=null;i.$body=o("body");i.ready(i._init)};function e(e){return s.pluginFn(this,t,e,arguments,"api",function(){if(!this.options.clickHandler&&this.options.src)this.show()})}return t.prototype={ready:function(e){var t=this;o.fn.viewer?e.call(t):requirejs([r.lib.imageViewer],function(){e.call(t)})},_init:function(){var t=this,a=t.options,e=t.$element,i=o.proxy(t.destroy,t);o(document).one(l.appRenderBefore,i);var n=e.closestBaModal();n&&n.$element.one(l.modalHided,i),a.button=a.showClose,a.navbar=a.thumbs,a.url="data-src",a.zIndex=r.zIndex(),a.hidden=function(){t._clear()},a.filter=s.scope(a.filter),a.filter||(a.hasClass?a.filter=function(e){return o(e).hasClass(a.hasClass)}:e.closestBaTableEl().length&&(a.filter=function(e){return o(e).elInBaTable()})),a.src?(t.isSingle=!0,t.$img=o('<img data-src="'+a.src+'" style="display: none;" alt="'+a.alt+'"/>'),e.append(t.$img),a.clickHandler&&e.off("click."+c).on("click."+c,function(e){return e.preventDefault(),t.show(),!1})):t.isSingle="img"===t.element.tagName.toLowerCase(),t.isSingle?(a.navbar=!1,"boolean"==typeof a.control?a.toolbar=a.control:a.toolbar=!1):"boolean"==typeof a.control?a.toolbar=a.control:a.toolbar=!0,e.viewer(a),t.api=e.data("viewer"),s.triggerPluginReady(e,t,"",l.imageViewerInitialized)},show:function(e){this.ready(function(){this.$element.viewer("view",e||0)})},hide:function(){this.ready(function(){this.$element.viewer("hide")})},update:function(e){var t=this;t.ready(function(){t.options=o.extend({},t.options,e||{}),t.options.src&&t.$img.attr("src",t.options.src).attr("alt",t.options.alt),t.api&&(t.api.update(),t._clear())})},_clear:function(){var e=this.api;e&&e.ready&&(e.ready=!1,e.viewer.parentNode.removeChild(e.viewer))},destroy:function(){var e=this;e.$img&&(e.$img.remove(),e.$img=null),e.api&&(e.api.destroy(),e.api=null),e.options.src&&e.options.clickHandler&&e.$element.off("click."+c)}},t.KEY=c,t.DEFAULTS={clickHandler:!0,backdrop:!0,showClose:!0,fullscreen:!0,keyboard:!0,loading:!0,loop:!0,movable:!0,rotatable:!0,scalable:!0,title:!0,alt:"",control:void 0,transition:!1,zoomable:!0,thumbs:!0,src:"",filter:null,hasClass:null},o.fn.baImageViewer=e,o.fn.baImageViewer.Constructor=t,r.plugins.ImageViewer=t,l.imageViewerInitialized=r.ee("initialized",n),r.autoInit(n,s.pluginAttrs(n),function(){e.call(this)}),t}),define("./ba/plug/linkagePicker",["busyAdmin","jquery","bootstrap"],function(o,p){var s=o.helper,e=o.ee,l=o.e,n="linkage-picker",i=p("body"),c=p(window),t=s.pluginKey(n),a=function e(t,a){var i=this;i.showing=false;i.uuid=i.getUID("linkage_picker");i.wrapId="__ba_"+i.uuid;i.selectData=[];i.selectIndex=[];i.pickerData=[];i.$value=p(t);i.$form=i.$value.closest("form");i.formStatus=i.$value.baFormStatus(i).render();i.placeholder=i.$value.attr("placeholder")||"请选择";i.$wrap=p('<div class="ba-linkage-picker">    <div class="ba--container">        <input type="text" readonly class="form-control ba--input"/>        <i class="fa fa-angle-down ba--caret"></i>        <i class="bicon bicon-close-o ba--clear"></i>        <i class="fa fa-spinner fa-spin ba--spinner"></i>    </div></div>');i.$wrap.insertAfter(i.$value);i.$wrap.prepend(i.$value);i.$caret=i.$wrap.find(".ba--caret");i.$clear=i.$wrap.find(".ba--clear");i.$loading=i.$wrap.find(".ba--spinner");i.$input=i.$wrap.find(".ba--input").addClass(i.$value.attr("class")||"").attr("placeholder",i.placeholder);i.$value.addClass("input-hidden");i.init("linkagePicker",i.$wrap[0],a);i.values=[];var n=i.options;i.$value.val().trim().split(n.idSpace).map(function(e){var t=e.trim();if(t!=="")i.values.push(t)});i.$content=i.tip().find(".popover-content");i.childField=n.childField||"child";i.idField=n.idField||"id";i.nameField=n.nameField||"name";i.parentField=n.parentField||"parent";i.disabledField=n.disabledField||"disabled";i.parentRoot=n.parentRoot||"";i.initEvent();i.setList(n.list);if(i.values.length>0&&(n.model||n.url)){i.$wrap.addClass("ba--loading");i.$input.attr("placeholder",n.locale.loading);i.request(function(e){if(!e){i.$input.attr("placeholder",i.placeholder);i.$wrap.removeClass("ba--loading")}else i.initDefault(false);i.formStatus.rendered();s.execCallback(i,n.onReady,t,[],i.$value,l.linkagePickerReady)})}else{i.initDefault(false);i.formStatus.rendered();s.execCallback(i,n.onReady,t,[],i.$value,l.linkagePickerReady)}i.setDisabled(i.$value.prop("disabled"));var r=p.proxy(i.destroy,i);p(document).one(l.appRenderBefore,r);var o=i.$value.closestBaModal();if(o)o.$element.one(l.modalHide,r);s.triggerPluginReady(i.$value,i,"",l.linkagePickerInitialized)};a.prototype=p.extend({},p.fn.popover.Constructor.prototype,{initEvent:function e(){var r=this;var t=r.options;if(!t.strict&&!t.multiple)r.$content.on("click","label",function(e){var t=p(this).closest("li");r.handleClick(t);if(t.hasClass("disabled"))return;r.selectComplete()});r.$content.on("click","li",function(e){if(e.target.tagName==="LABEL")return;if(r.handleClick(p(this)))r.selectComplete()});r.$form.on("reset."+r.uuid,function(){setTimeout(function(){r.initDefault(true)},1)});i.on("click."+r.uuid,function(e){var t=p(e.target);if(t.closest(r.tip()).length||t.closest(r.$element).length||t.closest(r.$wrap).length)return;if(r.showing)r.hide()});c.on("resize."+r.uuid,function(){if(r.showing)r.autoPosition()});var a=r.$value;if(t.clear){r.$wrap.addClass("ba--has-clear");r.$clear.on("click",function(e){e.preventDefault();r.selectData=[];r.selectIndex=[];r.setValue(true);r.$wrap.removeClass("ba--has-value");if(r.showing)r.hide();s.execCallback(r,t.onClear,a[0],[r],a,l.linkagePickerClear)})}r.$wrap.on("click",function(e){var t=p(this);if(p(e.target).closest(r.$clear).length||t.hasClass("ba--loading")||t.hasClass("disabled")||r.showing)return;if(t.hasClass("focus")){r.hide();return}r.show()}).on("shown.bs.linkagePicker",function(){r.selectIndex.map(function(e,t){var a=r.$content.find(".ba--wrap-"+t);var i=a.find("li.active");if(i.length>0){var n=(a.outerHeight(true)-i.outerHeight(true))/2;a.scrollTop(i.offset().top-(a.offset().top+n)+a.scrollTop())}});s.execCallback(r,t.onShown,a[0],[r],a,l.linkagePickerShown)}).on("show.bs.linkagePicker",function(){r.showing=true;r.$wrap.addClass("focus");s.execCallback(r,t.onShow,a[0],[r],a,l.linkagePickerShow)}).on("hide.bs.linkagePicker",function(){r.$wrap.removeClass("focus");r.showing=false;s.execCallback(r,t.onHide,a[0],[r],a,l.linkagePickerHide)}).on("hidden.bs.linkagePicker",function(){s.execCallback(r,t.onHided,a[0],[r],a,l.linkagePickerHided)});a.on(l.validateErrorPlacement,function(e,t){r.$wrap.after(t);return false})},getDefaults:function e(){return p.extend({},a.DEFAULTS,{trigger:"manual",template:'<div class="popover ba-linkage-picker-popover" role="tooltip"><div class="arrow"></div><div class="popover-content"></div></div>',placement:"autobottom",viewport:"body"})},getOptions:function e(t){var a=this;t=p.extend({},a.getDefaults(),a.$value.baData(n),t);if(!t.container){var i=a.$value.closest(".modal");if(i.length)t.container=i;else t.container="body"}if(t.delay&&typeof t.delay=="number")t.delay={show:t.delay,hide:t.delay};return t},getCalculatedOffset:function e(t,a,i,n){if(t=="bottom")return{top:a.top+a.height,left:a.left};else return{top:a.top-n,left:a.left}},autoPosition:function e(){var t=this;var a=t.tip();var i="bottom";var n=t.getPosition();var r=a[0].offsetWidth;var o=a[0].offsetHeight;var s=t.getPosition(t.$viewport);if(n.bottom+o>s.bottom)i="top";a.removeClass("top bottom").addClass(i);t.applyPlacement(t.getCalculatedOffset(i,n,r,o),i)},replaceArrow:function e(t,a,i){this.arrow().css("left",this.$wrap.offset().left-this.tip().offset().left+45+"px")},hasContent:function e(){return true},setContent:function e(){var n=this;var t=n.options;var r=n.$content;var a=function e(){var i=n.selectIndex.length;if(i>0){r.html("");n.selectIndex.map(function(e,t){var a=n.createPicker(n.pickerData[t],t,e);r.find(".ba--wrap-"+t).remove();r.append(a);if(!n.options.strict&&!n.options.multiple&&t===i-1)a.find("li.active").find("input").prop("checked",true)})}else if(n.pickerData.length)r.html(n.createPicker(n.pickerData[0],0,-1));else r.html('<div style="width: '+(n.$wrap.width()-2)+'px" class="ba--empty">'+t.emptyText+"</div>")};if((t.model||t.url)&&!t.list.length){var i=p('<div style="width: '+(n.$wrap.width()-2)+'px" class="ba--loading"><i class="fa fa-spinner fa-spin"></i> <span>'+t.locale.loading+"</span></div>");r.html(i);n.request(function(e){if(!e)i.remove();else{n.initDefault();a()}});return}a()},request:function e(i){var n=this;var t=n.options;var a={model:t.model,extend:t.modelExtend?1:0,id_field:t.modelIdField||"",name_field:t.modelNameField||"",parent_field:t.modelParentField||"",disabled_field:t.modelDisabledField||"",order:t.modelOrder||""};var r=s.scope(t.params);if(typeof r==="function")r=r.call(n,a);a=p.extend(true,{},r||{},a);n._abort();n.task=o.request(t.model?o.getConfig("linkagePicker").url:t.url).method(t.method).addHeader("Busy-Admin-Plugin","LinkagePicker").pending(false).params(a).complete(function(e,t,a){i(false)}).error(function(e,t,a){return false}).success(function(e,t,a){n.setList(e.result.data);i(true);return false}).exec()},_abort:function e(){if(this.task){this.task.abort();this.task=null}},setList:function e(t){t=t||[];if(!t.length)return;var a=this;if(t.length>0&&(t[0]||{}).hasOwnProperty(a.childField))a.options.list=t;else a.options.list=s.listToTree(t,a.idField,a.childField,a.parentField,a.parentRoot)},createPicker:function e(t,o,s){var l=this;var c="";var d=l.options.strict;var u=l.options.multiple;t.map(function(e,t){var a=e[l.childField]||[];var i="";var n=e[l.disabledField]?" disabled":"";var r=l.uuid+"_"+o+"_"+t;if(!d||u)if(u)i='<div class="ba--checkbox"><input '+n+' type="checkbox" id="__checkbox_'+r+'"/><label class="bicon" for="__checkbox_'+r+'"></label></div>';else i='<div class="ba--radio"><input '+n+' type="radio" id="__radio_'+r+'" name="__radio_'+l.uuid+'"/><label class="bicon" for="__radio_'+r+'"></label></div>';else i='<div class="ba--check"><i class="bicon bicon-check"></i></div>';c+="<li "+n+' class="'+(s===t?"active":"")+n+'" data-index="'+t+'" data-picker-index="'+o+'">                    '+i+"                    <span>"+e[l.nameField]+'</span>                    <i class="ba--angle fa fa-angle-right '+(a.length>0?"":"hide")+'"></i>                </li>'});return p('<div class="ba--wrap ba--wrap-'+o+'"><ul>'+c+"</ul></div>")},handleClick:function e(t){var a=this;var i=t.data();var n=i.index;var r=i.pickerIndex;var o=(a.pickerData[r]||[])[n]||null;var s=o[a.childField]||[];var l=a.pickerData.length;for(var c=l;c>r;c--){a.$content.find(".ba-linkage-picker-wrap-"+c).remove();a.pickerData=a.pickerData.del(c);a.selectData=a.selectData.del(c-1);a.selectIndex=a.selectIndex.del(c-1)}t.siblings().removeClass("active");t.addClass("active");a.selectData.push(o);a.selectIndex.push(n);if(s.length>0){a.pickerData.push(s);a.$content.find(".ba--wrap-"+(r+1)).remove();a.$content.append(a.createPicker(s,r+1,-1));a.autoPosition();return false}else return!o[a.disabledField]},selectComplete:function e(){var t=this;t.hide();t.setValue(true);s.execCallback(t,t.options.onChanged,t.$value[0],[t,t.selectData,t.selectIndex],t.$value,l.linkagePickerChanged)},setValue:function e(t){var a=this;var i=[];var n=[];a.selectData.map(function(e){i.push(e[a.nameField]);n.push(e[a.idField])});if(a.options.nameAllPath)a.$input.val(i.join(a.options.nameSpace));else a.$input.val(i[i.length-1]);a.$value.val(n.join(a.options.idSpace));t&&a.$value.baTriggerEvent("input").baTriggerEvent("change");if(n.length>0)a.$wrap.addClass("ba--has-value")},initDefault:function e(t){var a=this;var i=0;var n=a.options.list||[];a.selectData=[];a.selectIndex=[];a.pickerData=[];do{var r=a.values[i]||null;if(r===null)break;var o=null;var s=-1;p.each(n,function(e,t){if(t[a.idField]==r){o=t;s=e;return false}});if(!o||s==-1)break;a.selectData.push(o);a.pickerData.push(n);a.selectIndex.push(s);n=o[a.childField]||[];i++}while(true);n=a.options.list||[];if(!a.pickerData.length&&n.length>0)a.pickerData=[n];a.setValue(t)},setDisabled:function e(t){this.$wrap.toggleClass("disabled",t);this.$input.prop("disabled",t)}});var r=s.extends(a.prototype,{destroy:function e(){var t=this;if(t.destroyed)return;t.destroyed=true;t._abort();i.off("click."+t.uuid);c.off("resize."+t.uuid);t.$value.off(l.validateErrorPlacement);t.$form.off("reset."+t.uuid);s.override(r,"destroy",t,arguments)}});function d(e){return s.pluginFn(this,a,e,arguments)}return a.KEY=t,a.DEFAULTS={list:[],idField:null,nameField:null,childField:null,parentField:null,disabledField:null,parentRoot:"",strict:!0,multiple:!1,clear:!1,url:"",params:null,method:"get",model:"",modelExtend:!1,modelIdField:"",modelNameField:"",modelParentField:"",modelDisabledField:"",modelOrder:"",idSpace:",",nameSpace:"/",nameAllPath:!0,container:"",onChanged:p.noop,onClear:p.noop,onShow:p.noop,onShown:p.noop,onHide:p.noop,onHidden:p.noop,emptyText:"无选项",locale:p.extend({},{loading:"请稍后..."},((o.locale||{}).plugin||{}).linkagePicker||{})},p.fn.baLinkagePicker=d,p.fn.baLinkagePicker.Constructor=a,o.plugins.LinkagePicker=a,l.linkagePickerInitialized=e("initialized",n),l.linkagePickerShow=e("show",n),l.linkagePickerShown=e("shown",n),l.linkagePickerHide=e("hide",n),l.linkagePickerHided=e("hidden",n),l.linkagePickerChanged=e("changed",n),l.linkagePickerClear=e("clear",n),l.linkagePickerReady=e("ready",n),o.autoInit(n,s.pluginAttrs(n),function(){d.call(this)}),a}),define("./ba/plug/markdown",["busyAdmin","jquery"],function(s,l){"use strict";var c=s.helper,d=null,u=null,n="markdown",p=c.pluginKey(n);s.e.markdownInitialized=s.ee("initialized",n);var t=function e(t,a){var i=this;i.$element=l(t);i.$wrap=null;i.options=l.extend(true,{},e.DEFAULTS,i.$element.baData(n)||{},a||{});i.ready(i.init)};function e(e){return c.pluginFn(this,t,e,arguments)}return t.prototype={ready:function(a){var n=this;d&&l.fn.baHighCode.Constructor.highlight?a.call(n):requirejs([s.lib.marked,s.lib.highlight],function(e,t){(d=new(u=e).Renderer).paragraph=function(e){return'<p class="markdown-paragraph">'+e+"</p>"},d.blockquote=function(e){return'<blockquote class="markdown-blockquote">'+e+"</blockquote>"},d.list=function(e,t,a){var i=t?"ol":"ul";return"<"+i+' class="markdown-'+i+'" '+(t&&a?'start="'+a+'"':"")+">"+e+"</"+i+">"},d.table=function(e,t){t=l('<div class="table-responsive markdown-table-responsive"><table class="table table-hover table-striped table-bordered markdown-table"><thead> '+e+" </thead> <tbody> "+t+" </tbody></table></div>");return t.find("thead th").each(function(){var e=l(this).addClass("text-center"),t=e.text().trim();t.indexOf(":")&&(t=t.split(":"),e.attr("width",(t[1]||"").trim()),e.html((t[0]||"").trim()))}),t.find("tbody td").each(function(){var t,e=l(this).addClass("text-vtop"),a=e.html().trim();!a.indexOf(":")||"title"===((t=a.split(":"))[1]||"").trim()&&(a=e.closest("tr").addClass("info text-bold").find("td"),e.attr("colspan",a.length),a.each(function(e){0<e?l(this).remove():l(this).html((t[0]||"").trim())}))}),t[0].outerHTML},d.code=function(e,t){if(0!==t.indexOf("demo"))return'<div class="markdown-code">'+l.fn.baHighCode.Constructor.parse(e,t,"",n.options.locale.copy)+"</div>";var a=t.split(":")[1]||"实例",t=e.split("\n"),i={};t.map(function(e){-1!==(e=e.trim()).indexOf(":")&&(e=e.split(":"),i[e[0].trim()]=(e[1]||"").trim())});e=l(e.trim()),e=c.escapeToHtml(e.html().trim());return'<div class="ba-demo panel panel-default"><div class="ba-demo-title panel-heading"><h3 class="panel-title">'+a+'</h3></div><div class="panel-body ba-demo-content">'+e+'</div><div class="ba-demo-code">'+l.fn.baHighCode.Constructor.parse(e,"html","",n.options.locale.copy)+'</div><div class="panel-footer ba-demo-control"><a href="javascript:void(0)"><i class="fa fa-caret-down"></i> '+n.options.locale.showCode+"</a></div></div>"},d.heading=function(e,t){return"<h"+t+' class="markdown-heading" id="'+c.base64Encode(e+":"+t).replace(/([=\/+])/g,"")+'">'+e+"</h"+t+">"},d.link=function(e,t,a){return'<a class="markdown-link" href="'+e+'" target="_blank" title="'+(t||a)+'">'+a+"</a>"},l.fn.baHighCode.Constructor.highlight=t,a.call(n)})},init:function(){var e=this,t=e.$element,a=e.options,i=t.html();i=(i=i.replace(/<\\script/gi,"<script")).replace(/<\\\/script>/gi,"<\/script>");var n=u(i,{renderer:d}),r=l('<div class="row" />'),o=l('<div class="col-sm-12 ba-markdown-content" />'),i=l('<div class="col-sm-3 col-sm-push-9 ba-markdown-catalog" />');a.catalog&&(o=l('<div class="col-sm-9 col-sm-pull-3 ba-markdown-content"/>'),r.append(i)),r.append(o),o.html(n),e.$wrap=l('<div class="ba-markdown" />').append(r),t.hide().after(e.$wrap),o.find(".ba-demo-control a").on("click."+p,function(){var e=l(this),t=e.parent(".ba-demo-control").prev();t.data("opened")?t.slideUp(function(){t.data("opened",!1),e.html('<i class="fa fa-caret-down"></i> '+a.locale.showCode+"</a>")}):t.slideDown(function(){t.data("opened",!0),e.html('<i class="fa fa-caret-up"></i> '+a.locale.hideCode+"</a>")})}),a.catalog&&e.catalog(o,i),c.triggerPluginReady(t,e,"",s.e.markdownInitialized)},catalog:function(e,t){var a=l(document.body).offset().top+l(document.body).outerHeight(!0),e=e.offset().top+e.outerHeight(!0);this.$wrap.baCatalog({container:t,filterSelector:".ba-demo",scroll:this.options.catalogScroll,sticky:!s.app.isMobileSize()&&this.options.catalogSticky,top:s.app.getContentFrame().top+this.options.catalogTop,bottom:a-e+this.options.catalogBottom})},reload:function(){null!==this.$wrap&&this.$wrap.remove(),this.init()},destroy:function(){}},t.KEY=p,t.DEFAULTS={catalog:!0,catalogScroll:!0,catalogSticky:!0,catalogTop:15,catalogBottom:15,locale:l.extend({showCode:"显示代码",hideCode:"隐藏代码",copy:"复制"},((s.locale||{}).plugin||{}).markdown||{})},l.fn.baMarkdown=e,l.fn.baMarkdown.Constructor=t,s.plugins.Markdown=t,s.autoInit(n,c.pluginAttrs(n)+',script[type="text/x-markdown"]',function(){e.call(this)}),t}),define("./ba/plug/modal",["busyAdmin","jquery","bootstrap"],function(n,l){"use strict";var r=n.helper,i=n.ee,o=n.e,s="modal",c=r.pluginKey(s),d=l(window),u=l("body");o.modalRenderBefore=i("render-before",s),o.modalReady=i("ready",s),o.modalShow=i("show",s),o.modalShown=i("shown",s),o.modalHide=i("hide",s),o.modalHided=i("hidden",s),o.modalOk=i("ok",s),o.modalCancel=i("cancel",s);var a=r.extends(l.fn.modal.Constructor.prototype,{adjustDialog:function e(){var t=this;if(!t.$element.hasClass("ba-modal"))return;if(!t.$win)t.$win=l(window);var a=t.$dialog.height();var i=t.$win.height();var n=t.$win.width();var r=n<=767;var o=r?15:30;if(a+o*2>=i)t.$dialog.css("margin",o+"px auto");else{var s=(i-a)/2-1;t.$dialog.css("margin",s+"px auto")}},show:function e(){this.noFix=this.$body.hasClass("modal-open");r.override(a,"show",this,arguments);var t=this.options.zindex==="auto"?n.zIndex(2):this.options.zindex;this.$element.css("z-index",t);this.$backdrop&&this.$backdrop.addClass("ba-modal-backdrop").css("z-index",t-1)},hide:function e(){if(typeof this.options.hideCallback==="function")if(false===this.options.hideCallback.call(this))return;r.override(a,"hide",this,arguments)},hideModal:function e(){var t=this;if(!t.$element.hasClass("ba-modal")){r.override(a,"hideModal",t,arguments);return}t.$element.hide();t.backdrop(function(){if(!t.noFix){t.$body.removeClass("modal-open");t.resetAdjustments();t.resetScrollbar()}t.$element.trigger("hidden.bs.modal")})}}),p=function e(t){if(!t)return"";if(-1===t.indexOf(" "))t="fa "+t;return'<i class="'+t+'"></i> '},f=1,t=0,h=function e(){return"__ba_modal_"+t++},m=function e(t,a){var i=this;i.element=t;i.$element=l(t);i.options=l.extend(true,{},e.DEFAULTS,i.$element.baData(s)||{},a||{});i._defaults={};i.api=null;i.uuid=c+ ++f;var n=i.options;if(!n.url&&!n.content)n.url=i.$element.getUrl();if(n.ok!==false&&l.baIsEmpty(n.ok))n.ok=n.ok||n.locale.confirm;if(n.cancel!==false&&l.baIsEmpty(n.cancel))n.cancel=n.locale.cancel;if(typeof n.buttons==="string")n.buttons=r.scope(n.buttons,[]);if(l.baIsEmpty(n.title)||n.title==="")n.title=i.$element.attr("title")||"";i.ajax=!!n.url&&!n.content;i.leftButtons=[];i.rightButtons=[];i.resizeEvent="resize."+i.uuid;i.mountedEvent=o.vueMounted+"."+i.uuid;l(document).one(o.appRenderBefore,function(){i.destroy()})};function g(e){return r.pluginFn(this,m,e,arguments,"api",function(){this.options.show&&this.show()})}return m.prototype={resetNodes:function(){var t=this,a=t.options;return t.$dialogContent=t.$dialog.find(".modal-content"),t.$dialogHeader=t.$dialogContent.find(".modal-header"),t.$dialogClose=t.$dialogHeader.find(".close"),t.$dialogTitle=t.$dialogContent.find(".modal-title"),t.$dialogBody=t.$dialogContent.find(".modal-body"),t.$dialogFooterUse=t.$dialogContent.find(".modal-footer-use").hide(),t.$dialogFooter=t.$dialogContent.find(t.use?".modal-footer":".modal-footer-sys"),t.$cancelBtn=t.$dialogContent.find('[data-dismiss="modal"]:not(.close)'),t.$okBtn=t.$dialogContent.find('[data-primary="modal"]'),t.$okBtn.off("click").on("click",function(){if(!1!==l(this).data("click")){var e=[];if(!t.$form&&a.select){if("baTable"===a.select&&(e=t.$container.findBaTable("getSelections")),e=e||[],0<a.selectMin){if(e.length<=0)return void n.dialog.toast(a.selectTip||"请选择");if(e.length<a.selectMin)return void n.dialog.toast(r.sprintf(a.selectMinTip||"至少需要选择%s项",a.selectMin))}if(0<a.selectMax&&e.length>a.selectMax)return void n.dialog.toast(r.sprintf(a.selectMaxTip||"最多允许选择%s项",a.selectMax))}!1!==r.execCallback(t,a.onOk,t.element,[t,e],[t.$element,n.app.$doc],o.modalOk,!0,!1)&&(t.$form?t.submit():t.close())}}),t.resetView(),t},_create:function(){var e=this,t=e.options;return e.$container=l(m.TEMPLATE).addClass(t.className).data(m.KEY,e),e.$dialog=e.$container.find(".modal-dialog"),e.resetNodes(),e.setClose(),e.setSize(),e.setPadding(),e.setBorderTop(),e.setBorderBottom(),e.setHeight(),e.setTitle(),e.setFooter(),e.setFooterAlign(),t.cancelRight?(e.$dialogFooter.append(e.$okBtn),e.$dialogFooter.append(e.$cancelBtn)):(e.$dialogFooter.append(e.$cancelBtn),e.$dialogFooter.append(e.$okBtn)),e.setCancel(),e.setOk(),e.setButtons(),e._created=!0,e.$container},setClose:function(e){var t=this,a=t.options,i=t._defaults;i.close||(i.close={v:a.close}),e=a.close=l.baIsEmpty(e)?i.close.v:e,t.$dialogClose&&(e?t.$dialogClose.show():t.$dialogClose.hide())},setButtons:function(e){var t=this,a=t.options,i=t._defaults;i.buttons||(i.buttons={v:a.buttons}),e=a.buttons=l.baIsEmpty(e)?i.buttons.v:e,t.$dialogFooter&&(t.leftButtons&&t.leftButtons.map(function(e){e.remove()}),t.rightButtons&&t.rightButtons.map(function(e){e.remove()}),t.leftButtons=[],t.rightButtons=[],l.map(e||[],function(e){("left"===(e=e||{}).align?t.leftButtons:t.rightButtons).push(t._createBtn(e))}),l.map(t.leftButtons,function(e){t.$dialogFooter.prepend(e)}),l.map(t.rightButtons,function(e){t.$dialogFooter.append(e)}),t.resetView())},setOk:function(e,t,a){var i=this,n=i.options,r=i._defaults;r.ok||(r.ok={text:n.ok,icon:n.okIcon,skin:n.okSkin});var o=n.okSkin;e=n.ok=l.baIsEmpty(e)?r.ok.text:e,t=n.icon=l.baIsEmpty(t)?r.ok.icon:t,a=n.skin=l.baIsEmpty(a)?r.ok.skin:a,i.$okBtn&&(!1!==e?(i.$okBtn.html(p(t)+e).removeClass(o).addClass(a).show(),i.resetView()):i.$okBtn.hide())},setCancel:function(e,t,a){var i=this,n=i.options,r=i._defaults;r.cancel||(r.cancel={text:n.cancel,icon:n.cancelIcon,skin:n.cancelSkin});var o=n.cancelSkin;e=n.cancel=l.baIsEmpty(e)?r.cancel.text:e,t=n.cancelIcon=l.baIsEmpty(t)?r.cancel.icon:t,a=n.cancelSkin=l.baIsEmpty(a)?r.cancel.skin:a,i.$cancelBtn&&(!1!==e?(i.$cancelBtn.html(p(t)+e).removeClass(o).addClass(a).show(),i.resetView()):i.$cancelBtn.hide())},setFooterAlign:function(e){var t=this,a=t.options,i=t._defaults;i.footerAlign||(i.footerAlign={v:a.footerAlign}),e=a.footerAlign=l.baIsEmpty(e)?i.footerAlign.v:e,t.$dialogFooter&&(t.$dialogFooter.removeClass("text-center text-left text-right"),e&&t.$dialogFooter.addClass("text-"+e))},setFooter:function(e){var t=this,a=t.options,i=t._defaults;i.footer||(i.footer={v:a.footer}),e=a.footer=l.baIsEmpty(e)?i.footer.v:e,t.$dialogFooter&&("boolean"!=typeof e&&e?(t.$dialogFooter.hide(),t.$dialogFooterUse.empty().append(e).show()):(e?t.$dialogFooter.show():t.$dialogFooter.hide(),t.$dialogFooterUse.hide()),t.resetView())},setSize:function(e){var t=this,a=t.options,i=t._defaults;i.size||(i.size={v:a.size}),e=a.size=l.baIsEmpty(e)?i.size.v:e,t.$dialog&&(t.$dialog.css({width:""}).removeClass("modal-sm modal-lg modal-xl modal-full"),e&&(-1===["lg","sm","xl"].indexOf(e)?t.$dialog.css({width:e}).addClass("modal-full"):t.$dialog.addClass("modal-"+e)),t.resetView())},setPadding:function(e){var t=this,a=t.options,i=t._defaults;i.padding||(i.padding={v:a.padding}),e=a.padding=l.baIsEmpty(e)?i.padding.v:e,t.$dialogBody&&(l.isNumeric(e)&&(e+="px"),t.$dialogBody.css({padding:e||""}),t.resetView())},setBorderTop:function(e){var t=this,a=t.options,i=t._defaults;i.borderTop||(i.borderTop={v:a.borderTop}),e=a.borderTop=l.baIsEmpty(e)?i.borderTop.v:e,t.$dialogHeader&&(t.$dialogHeader.css("border-bottom-width",e?"":0),t.resetView())},setBorderBottom:function(e){var t=this,a=t.options,i=t._defaults;i.borderBottom||(i.borderBottom={v:a.borderBottom}),e=a.borderBottom=l.baIsEmpty(e)?i.borderBottom.v:e,t.$dialogFooter&&(t.$dialogFooter.css("border-top-width",e?"":0),t.$dialogFooterUse.css("border-top-width",e?"":0),t.resetView())},setHeight:function(e){var t=this,a=t.options,i=t._defaults;i.height||(i.height={v:a.height}),e=a.height=l.baIsEmpty(e)?i.height.v:e,t.$dialog&&(l.isNumeric(e)&&0<e&&(e+="px"),e?(t.$dialogBody.css("height",e),t.$dialog.addClass("modal-fixed-height")):(t.$dialogBody.css("height",""),t.$dialog.removeClass("modal-fixed-height")),t.resetView())},setContent:function(e){var t=this,a=t.options,i=t._defaults;i.content||(i.content={v:a.content,ajax:t.ajax}),(e=a.content=l.baIsEmpty(e)?i.content.v:e)||!i.content.ajax?(t.ajax=!1,t.render()):t.reload()},setTitle:function(e){var t=this,a=t.options,i=t._defaults;i.title||(i.title={v:a.title}),e=a.title=l.baIsEmpty(e)?i.title.v:e,t.$dialogHeader&&(!1===e?t.$dialogHeader.hide():(t.$dialogHeader.show(),t.$dialogTitle.empty().append(""===e||l.baIsEmpty(e)?a.locale.title:e)),t.resetView())},_renderContent:function(e,t,a){var i=this,n=h(),r="";l(e).each(function(){r+=this.outerHTML.replace(/:modal_id/g,n)}),i.$content=l("<div />").html(r),i.use=!1,0<i.$content.find(".modal-content").length?(i.$dialog.empty().append(i.$content).append(a||""),i.use=!0,i.resetNodes(),"string"==typeof(e=i.$dialogTitle.html())&&""!==(e=e.trim())&&(t=e)):i.$dialogBody.empty().append(i.$content).append(a||""),l.baIsEmpty(t)||""===t||""!==i._defaults.title.v?i.setTitle():i.setTitle(t)},render:function(){var e,t=this,a=t.options;l(document).off(t.mountedEvent).on(t.mountedEvent,function(e){e.$vue.closestBaModal()===t&&(t.vue=e.vue,t.$form&&t.renderForm())}),a.content&&!t.ajax&&("function"==typeof a.content?e=l(a.content()):(e=l(a.content)).length&&("script"!==e[0].tagName.toLowerCase()&&"template"!==e[0].tagName.toLowerCase()||(e="<div>"+l(a.content).html()+"</div>")),t._renderContent(l(e))),"page"!==a.type&&t.$content&&t.$content.length&&t.renderForm(),r.execCallback(t,a.onReady,t.element,[t],[t.$element,n.app.$doc],o.modalReady),t.api.isShown?t.resetView():t.api.show()},submit:function(){return!(!this.$form||0===this.$form.length)&&(this.$form.submit(),!0)},reset:function(){return!(!this.$form||0===this.$form.length)&&(this.$form[0].reset(),!0)},renderForm:function(){var e=this,t=e.options,a=e.$dialog.find("form");0===a.length?(e.$content.wrap("<form />"),e.$content=e.$content.parent("form"),a=e.$content):(t.formAction=a.getUrl()||t.url,t.formMethod=a.attr("method")||t.formMethod),e.$form=a.off(o.formDisabled).off(o.formEnabled).on(o.formDisabled,function(){e.$okBtn.prop("disabled",!0).addClass("disabled")}).on(o.formEnabled,function(){e.$okBtn.prop("disabled",!1).removeClass("disabled")}),0===a.find(":submit").length&&a.append('<button type="submit" style="position: absolute; left: -9999px;">submit</button>');var i=r.parseData(t,"form","validate");i.action=i.action||t.url,i.method=i.method||"post",a.baForm(i)},show:function(){var t=this,a=t.options;t.shown||(t.shown=!0,u.append(t._create()),t.$container.modal({show:!1,backdrop:a.backdrop,keyboard:a.keyboard,zindex:a.zindex,hideCallback:function(){if(!t.closed)return!1!==r.execCallback(t,a.onCancel,t.element,[t],[t.$element,n.app.$doc],o.modalCancel,!0,!1)&&void 0;t.closed=!1}}),t.$container.on("show.bs.modal shown.bs.modal hide.bs.modal hidden.bs.modal",function(e){"bs.modal"===e.namespace&&(r.execCallback(t,a[r.camel("on_"+e.type)],t.element,[t],[t.$element,n.app.$doc],i(e.type,"modal")),"show"===e.type&&d.on(t.resizeEvent,function(){t.resetView()}),"hidden"===e.type&&(t.offEvent(),t.shown=!1,t.$container.remove()))}),t.api=t.$container.data("bs.modal"),!1!==r.execCallback(t,a.onRenderBefore,t.element,[t],t.$element,o.modalRenderBefore,!0,!1)&&(t.ajax?t.load():t.render()))},offEvent:function(){var e=this;d.off(e.resizeEvent),l(document).off(e.mountedEvent),e.vue&&(e.vue.$destroy(),e.vue=null)},hide:function(){this.api&&this.api.hide()},close:function(){this.closed=!0,this.hide()},load:function(t){var a,i=this;i.ajax&&(a=i.options,i.task=n.request(r.scope(a.url)).method(a.method||m.DEFAULTS.method).params(r.scope(a.params)).addHeader("Busy-Admin-Plugin","Modal").addHeader("X-Requested-With","HTML").parse("html").success(function(e){return n.app.responseToHtml(e,function(e){e=n.app.extractContainer(e);i._renderContent(e.content,e.appTitle,e.trace),i.render(),t&&(r.execCallback(i,a.show,i.element,[i],[i.$element,n.app.$doc],o.modalShow),r.execCallback(i,a.shown,i.element,[i],[i.$element,n.app.$doc],o.modalShown))}),!1}).exec())},reload:function(e){var t=this.options,a=this._defaults;a.url||(a.url={v:t.url}),t.url=l.baIsEmpty(e)?a.url.v:e,this.ajax=!0,this.load(!0)},resetView:function(){this.api&&this._created&&this.api.adjustDialog()},setOption:function(e,t){this.options[e]=t},_createBtn:function(e){var t=this;if(e.element?e.$element=l(e.element):e.$element=l('<button type="button" class="btn"/>').addClass(e.classes||"btn-default").html(e.text),"function"==typeof e.events)e.$element.off("click.busy.modal").on("click.busy.modal",function(){e.events.call(this,t)});else for(var a in e.events=e.events||{},e.events)t._createBtnEvents(e.$element,a,e.events[a]);return e.$element},_createBtnEvents:function(e,t,a){var i=this;e.off(t).on(t,function(){"function"==typeof a&&a.call(this,i)})},destroy:function(){var e=this;e.shown=!1,u.removeClass("modal-open"),e.offEvent(),e.api&&(e.api.removeBackdrop(),e.api.resetAdjustments(),e.api.resetScrollbar(),e.api=null),e.task&&(e.task.abort(),e.task=null),e.$container&&(e.$container.remove(),e.$container=null)}},m.TEMPLATE='<div class="modal fade ba-modal">        <div class="modal-dialog">            <div class="modal-content">                <div class="modal-header">                    <button type="button" class="close" data-dismiss="modal"><span>&times;</span></button>                    <h4 class="modal-title"></h4>                </div>                <div class="modal-body"></div>                <div class="modal-footer modal-footer-sys clearfix">                    <button type="button" class="btn" data-primary="modal"/>                    <button type="button" class="btn" data-dismiss="modal"/>                </div>                <div class="modal-footer modal-footer-use clearfix"></div>            </div>        </div>    </div>',m.KEY=c,m.DEFAULTS={show:!0,type:"",backdrop:!0,keyboard:!0,size:"",title:"",footer:!0,footerAlign:null,content:"",url:"",method:"get",params:{},className:"",padding:void 0,borderTop:!0,borderBottom:!0,height:null,buttons:[],zindex:"auto",close:!0,select:null,selectTip:"",selectMin:1,selectMinTip:"",selectMax:0,selectMaxTip:"",ok:null,okSkin:"btn-primary",okIcon:"",cancel:null,cancelSkin:"btn-default",cancelIcon:"",cancelRight:n.getConfig("modal").cancel_right,onOk:l.noop,onCancel:l.noop,onReady:l.noop,onShow:l.noop,onShown:l.noop,onHide:l.noop,onHidden:l.noop,onRenderBefore:l.noop,formMethod:"post",formAction:"",formOnSuccess:"@modal.close",locale:l.extend({},{confirm:"确定",cancel:"取消",title:"操作",reset:"重置"},((n.locale||{}).plugin||{}).modal||{})},l.fn.baModal=g,l.fn.baModal.Constructor=m,n.plugins.Modal=m,n.regSugar(s,function(e,t,a){var i=l(this).closestBaModal();(i=i||l(this).data(m.KEY))&&i[e||"close"](t)}),l.fn.closestBaModal=function(e){e=r.pluginCall(m,"baModal",l(this).closest(".ba-modal"),e,arguments);return e?e.resetNodes():null},l.fn.getBaModal=function(e){e=r.pluginCall(m,"baModal",l(this),e,arguments);return e?e.resetNodes():null},u.on("click."+c,r.pluginAttrs(s),function(e){e.preventDefault(),g.call(l(this))}),m}),define("./ba/plug/print",["busyAdmin","jquery"],function(o,v){"use strict";var s,r,b,y=o.helper,e=o.ee,$=o.e,n="print",a=y.pluginKey(n);$.printInitialized=e("initialized",n),$.printExportData=e("export-data",n);var t=function e(t,a){var i=this;i.element=t;i.$element=v(t);i.options=v.extend(true,{},e.DEFAULTS,i.$element.baData(n)||{},a||{});if(v.baIsEmpty(i.options.title))i.options.title=i.$element.attr("title")||"";i.ready(i._init)};function i(e){return y.pluginFn(this,t,e,arguments)}return t.prototype={ready:function(i){var n=this;s&&r&&b?i.call(n):requirejs([o.lib.print,o.lib.html2canvas,o.lib.jspdf],function(e,t,a){s=e,b=a,r=t,i.call(n)})},_init:function(){var t=this;t.options.clickHandler?t.$element.on("click."+a,function(e){return e.preventDefault(),t.print(),!1}):t.print(),y.triggerPluginReady(t.$element,t,"",$.printInitialized)},print:function(){var m=this,g=m.options;if(g.target){var e=g.type.toLowerCase();switch(e){case"pdf":m.exec({printable:g.target,type:"pdf",base64:g.base64});break;case"image":m.exec({printable:g.target,type:"image"});break;default:var t=v(g.target);if(!t.length)return void o.dialog.toast("未找到需要打印的HTML节点");var a=t[0],t=v.extend({allowTaint:!0,useCORS:!0,scale:(window.devicePixelRatio||1)*(g.captureScale||1)},g.captureOptions||{});"capture"==e?(m.showLoad(),r(a,t).then(function(e){m.exec({printable:e.toDataURL("image/jpeg",1),type:"image"})}).catch(function(e){m.hideLoad(),o.dialog.toast(e)})):"export"==e?(m.showLoad("导出中..."),r(a,t).then(function(e){var t=g.width||210,a=g.height||297,i=10,n=10;v.isNumeric(g.padding)?n=i=g.padding:v.isArray(g.padding)&&(i=g.padding[0]||0,n=g.padding[1]||0);for(var r,o=t-2*i,s=a-2*n,l=new b.jsPDF({orientation:s<o?"l":"p",unit:g.unit,format:[t,a]}),c=e.getContext("2d"),d=Math.floor(s*e.width/o),u=Math.ceil(e.height/d),p=1,f=0;f<e.height;)m.showLoad(p+"/"+u),(r=document.createElement("canvas")).width=e.width,r.height=Math.min(d,e.height-f),r.getContext("2d").putImageData(c.getImageData(0,f,e.width,Math.min(d,e.height-f)),0,0),l.addImage(r.toDataURL("image/jpeg",1),"JPEG",i,n,o,Math.min(s,o*r.height/r.width)),(f+=d)<e.height&&l.addPage(),p++;r=null;var h=g.title;""===h&&(t=function(e){return e<10?"0"+e:e},h=[(a=new Date).getFullYear(),t(a.getMonth()+1),t(a.getDate()),t(a.getHours()),t(a.getMinutes()),t(a.getSeconds())].join(""));h+=".pdf";g.download&&l.save(h),m.hideLoad(),y.execCallback(m,g.onExportData,m.element,[l,h],m.$element,$.printExportData)}).catch(function(e){m.hideLoad(),o.dialog.toast(e)})):m.exec({printable:a,type:"html",targetStyles:["*"]})}}else o.dialog.toast("打印目标为空")},exec:function(e){var t=this,a=t.options,i=[],n=[];v(document).find('link[type="text/css"],style').each(function(){v(this).is("link")?i.push(v(this).attr("href")):n.push(v(this).html())});var r=o.getConfig("print",{});r.css&&(v.isArray(r.css)?r.css.map(function(e){i.push(e)}):i.push(r.css)),a.css&&(v.isArray(a.css)?a.css.map(function(e){i.push(e)}):i.push(a.css)),r.style&&n.push(r.style),a.style&&n.push(a.style);r={header:a.header,css:i,style:n.join("\n\n"),documentTitle:a.title};a.headerStyle&&(r.headerStyle=a.headerStyle),s(v.extend(r,e||{},a.printOptions||{},{onLoadingStart:function(){t.showLoad()},onLoadingEnd:function(){t.hideLoad()},onError:function(e){t.hideLoad(),o.dialog.toast(e)}}))},showLoad:function(e){this.pending?e&&this.pending&&this.pending.update(e):this.pending=o.dialog.pending(e||"预览中...")},hideLoad:function(){this.pending&&this.pending.close(),this.pending=null},destroy:function(){this.options.clickHandler&&this.$element.off("click."+a)}},t.KEY=a,t.DEFAULTS={target:null,type:"",header:null,headerStyle:null,css:null,style:null,title:null,width:0,height:0,padding:10,unit:"mm",download:!0,captureScale:2,captureOptions:{},printOptions:{},clickHandler:!0},v.fn.baPrint=i,v.fn.baPrint.Constructor=t,o.plugins.Print=t,o.autoInit(n,y.pluginAttrs(n),function(){i.call(this)}),t}),define("./ba/plug/random",["busyAdmin","jquery"],function(e,n){"use strict";var a=e.helper,r="random",t=a.pluginKey(r),i=function e(t,a){var i=this;i.element=t;i.$element=n(t);i.options=n.extend(true,{},e.DEFAULTS,i.$element.baData(r)||{},a||{})};function o(e){return a.pluginFn(this,i,e,arguments,[],function(){this.options.write&&this.value()})}return i.prototype={value:function(){var e,t=this.options;t.target&&((e=n(t.target)).is(":input")?e.val(a.random(t.length,t.char)).baTriggerEvent("input").baTriggerEvent("change"):(e.text(a.random(t.length,t.char)),e.trigger("change")))},destroy:function(){}},i.KEY=t,i.DEFAULTS={write:!0,target:null,length:32,char:null},n.fn.baRandom=o,n.fn.baRandom.Constructor=i,e.plugins.Random=i,n("body").on("click."+t,a.pluginAttrs(r),function(e){o.call(n(this))}),i}),define("./ba/plug/rangeSlider",["busyAdmin","jquery"],function(l,r){var i=null,c=l.helper,e=l.ee,d=l.e,o="range-slider",s=c.pluginKey(o),t=function e(t,a){var i=this;i.element=t;i.$element=r(t);i.index=e.INDEX++;i.options=this._parseOptions(r.extend(true,{},e.DEFAULTS,i.$element.baData(o)||{},a||{}));var n=i.options.values;if(n){i.$element.removeData("values").removeAttr("data-values");if(typeof n==="string")n=n.split(",");if(!Array.isArray(n))n=[];i.options.values=n}i.resetEvent="reset."+s+i.index;i.$form=i.$element.closest("form");i.$form.on(i.resetEvent,function(){i.setValue(i.defaultValue)});i.defaultValue=i.$element.val().trim();i._parseValue(i.defaultValue);i.ready(i._init)};function a(e){return c.pluginFn(this,t,e,arguments,"api")}return t.prototype={ready:function(t){var a=this;i?t.call(a):requirejs([l.lib.ionRangeSlider],function(e){i=e,t.call(a)})},_init:function(){var t=this,e=t.options,a=e.onStart,i=e.onChange,n=e.onFinish,r=e.onUpdate,o=t.$element,s=t.element;e.onStart=function(e){c.execCallback(t,a,s,[e],o,d.rangeSliderStart)},e.onChange=function(e){t.$element.baTriggerEvent("input").baTriggerEvent("change"),c.execCallback(t,i,s,[e],o,d.rangeSliderChange)},e.onFinish=function(e){c.execCallback(t,n,s,[e],o,d.rangeSliderFinish)},e.onUpdate=function(e){c.execCallback(t,r,s,[e],o,d.rangeSliderUpdate)},e.skin="round",e.extra_classes="ba-range-slider",t.api=o.ionRangeSlider(e).data("ionRangeSlider"),l.app.triggerResize(),c.triggerPluginReady(o,t,"",d.rangeSliderInitialized)},_parseOptions:function(e){for(var t in e){var a;"on"!==t.substring(0,2)&&("readonly"===t&&(e.block=e[t],delete e[t]),"disabled"===t&&(e.disable=e[t],delete e[t]),-1!==t.indexOf("_")||(a=c.snake(t,"_"))!=t&&(e[a]=e[t],delete e[t]))}return e},_parseValue:function(e,t){e=null==e?"":e+"";var a,i=this.options,n=i.values;0<n.length?"single"!=i.type?(a=e.split(i.input_values_separator),r.isNumeric(i.from)&&!t||(i.from=n.indexOf(a[0])),1<a.length?r.isNumeric(i.to)&&!t||(i.to=n.indexOf(a[1]),i.to=-1==i.to?null:i.to):t&&(i.to=null)):r.isNumeric(i.from)&&!t||(i.from=n.indexOf(e)):"single"!=i.type?(a=e.split(i.input_values_separator),i.from=a[0],1<a.length?i.to=a[1]:i.to=null):i.from=e},setOption:function(e,t){this.options[e]=t,this.setOptions()},setOptions:function(e){var t=this;t.options=t._parseOptions(r.extend(!0,{},t.options,e||{})),t.api&&t.api.update(t.options)},setValue:function(e){this.api&&(this._parseValue(e,!0),this.api.update(this.options))},getApi:function(){return this.api},destroy:function(){var e=this;e.$form.off(e.resetEvent),e.api&&(e.api.destroy(),e.api=null)}},t.INDEX=0,t.KEY=s,t.DEFAULTS={type:"single",min:0,max:100,from:null,to:null,step:1,minInterval:0,maxInterval:0,dragInterval:!1,values:[],fromFixed:!1,fromMin:null,fromMax:null,fromShadow:!1,toFixed:!1,toMin:null,toMax:null,toShadow:!1,prettifyEnabled:!0,prettifySeparator:" ",prettify:null,forceEdges:!1,keyboard:!0,grid:!1,gridMargin:!0,gridNum:4,gridSnap:!1,hideMinMax:!1,hideFromTo:!1,prefix:"",postfix:"",maxPostfix:"",decorateBoth:!0,valuesSeparator:" — ",inputValuesSeparator:",",disabled:!1,readonly:!1,scope:null,onStart:null,onChange:null,onFinish:null,onUpdate:null},r.fn.baRangeSlider=a,r.fn.baRangeSlider.Constructor=t,l.plugins.RangeSlider=t,d.rangeSliderInitialized=e("initialized",o),d.rangeSliderStart=e("start",o),d.rangeSliderChange=e("change",o),d.rangeSliderUpdate=e("update",o),d.rangeSliderFinish=e("finish",o),l.autoInit(o,c.pluginAttrs(o),function(){a.call(this)}),t}),define("./ba/plug/rate",["busyAdmin","jquery"],function(a,n){var i=null,s=a.helper,t=a.ee,l=a.e,c="rate",e=s.pluginKey(c),d="hover,hoverleave,focus,blur,keydown,mouseenter,mouseleave,clear,reset,refresh,change".split(",");l.rateInitialized=t("initialized",c),d.map(function(e){l[s.camel(c+"_"+e)]=t(e,c)});var r=function e(t,a){var i=this;i.element=t;i.$element=n(t);i.index=e.INDEX++;i.options=n.extend(true,{},e.DEFAULTS,i.$element.baData(c)||{},a||{});i.ready(i._init)};function o(e){return s.pluginFn(this,r,e,arguments,"api")}return r.prototype={ready:function(e){var t=this;i?e.call(t):requirejs([a.lib.bootstrapStarRating],function(){i=!0,e.call(t)})},_init:function(){var t=this,a=t.options;if(a.containerClass="ba-rate",a.clearCaption=a.clearCaption||a.locale.clearCaption,a.clearButtonTitle=a.clearButtonTitle||a.locale.clearButtonTitle,a.defaultCaption=a.defaultCaption||a.locale.caption,t._initDefaultCaption(a),!a.starTitles){for(var e={},i=1;i<=a.max;i++)e[i]=a.defaultCaption.replace(/\{rating}/g,i);a.starTitles=e}a.starCaptions||(a=t._initTexts(a));var n=[];d.map(function(e){n.push("rating:"+e)});var r=t.$element,o=t.element;r.on(n.join(" "),function(e){e=e.type.substring(7);"change"!==e&&"clear"!==e&&"reset"!==e||r.baTriggerEvent("input").baTriggerEvent("change"),s.execCallback(t,a[s.camel("on_"+e)],o,[],r,l[s.camel(c+"_"+e)])}),t.api=r.addClass("input-hidden").rating(a).data("rating"),s.triggerPluginReady(r,t,"",l.rateInitialized)},getApi:function(){return this.api},setValue:function(e){this.api&&this.api.update(e)},clear:function(){this.api&&this.api.clear()},reset:function(){this.api&&this.api.reset()},setOption:function(e,t){this.options[e]=t,this.setOptions(this.options)},setOptions:function(e){var t=this;t.api&&(t.options=n.extend(!0,{},t.options,e||{}),t.options=t._initDefaultCaption(t.options),t.options=t._initTexts(t.options),t.api.refresh(t.options))},_initTexts:function(e){var t=e.texts;if(0<t.length){for(var a={},i=[],n=e.step;n<=e.max;n+=e.step)a[n]=t.splice(0,1),i.push(a[n]);e.texts=i,e.starCaptions=a}return e},_initDefaultCaption:function(e){var t=e.defaultCaption;return-1===t.indexOf("{rating}")&&(t="{rating}"+e.defaultCaption),e.defaultCaption=t,e},destroy:function(){this.api&&(this.api.destroy(),this.api=null)}},r.INDEX=0,r.KEY=e,r.DEFAULTS={min:0,max:5,stars:5,size:"",step:1,showClear:!1,showCaption:!1,defaultCaption:"",captionElement:null,clearElement:null,texts:["极差","失望","一般","满意","惊喜"],animate:!1,onReset:null,onClear:null,onRefresh:null,onChange:null,locale:n.extend({},{caption:"{rating}分",clearButtonTitle:"清理",clearCaption:"未评分"},((a.locale||{}).plugin||{}).rate||{})},n.fn.baRate=o,n.fn.baRate.Constructor=r,a.plugins.Rate=r,a.autoInit(c,s.pluginAttrs(c),function(){o.call(this)}),r}),define("./ba/plug/request",["busyAdmin","jquery"],function(o,s){"use strict";var r=o.helper,e=o.ee,l=o.e,c="request",t=r.pluginKey(c);function d(e){return Array.prototype.slice.call(e)}l.requestBefore=e("before",c),l.requestComplete=e("complete",c),l.requestSuccess=e("success",c),l.requestError=e("error",c);var u=function e(t,a){var i=this;i.element=t;i.$element=s(t);i.options=s.extend(true,{},e.DEFAULTS,i.$element.baData(c)||{},a||{});var n=s.proxy(i.destroy,i);s(document).one(l.appRenderBefore,n);var r=i.$element.closestBaModal();if(r)r.$element.one(o.e.modalHide,n)};function a(e){return r.pluginFn(this,u,e,arguments,null,function(){this.options.show&&this.show()})}return u.prototype={show:function(){var e=this,t=e.options,a=t.confirm;a?e.dialog&&e.dialog.isShown()||("function"==typeof a&&(a=a.call(e)),e.dialog=o.dialog.confirm(a,{btn:[t.confirmOk||t.locale.confirm,t.confirmCancel||t.locale.cancel]},function(){e._exec()})):e._exec()},_exec:function(){var t=this,a=t.options,i=t.element,n=t.$element;t._abort(),t.task=o.request(a.url?r.scope(a.url):n.getUrl()).headers(r.scope(a.headers)).pending(a.pending,a.pendingMessage).params(r.scope(a.params)).method(a.method||u.DEFAULTS.method).before(function(){return!1!==r.execCallback(t,a.onBefore,i,d(arguments),n,l.requestBefore,!0,!1)}).complete(function(){return!1!==r.execCallback(t,a.onComplete,i,d(arguments),n,l.requestComplete,!0,!1)}).success(function(e){return!1===r.execCallback(t,a.onSuccess,i,d(arguments),n,l.requestSuccess,!0,!1)||!1===a.onSuccess||o.dialog.tipSuccess(e.message),!1}).error(function(e){return!1===r.execCallback(t,a.onError,i,d(arguments),n,l.requestError,!0,!1)||!1===a.onError||o.dialog.tipError(e.message),!1}).exec()},_abort:function(){this.task&&(this.task.abort(),this.task=null)},destroy:function(){this._abort()}},u.KEY=t,u.DEFAULTS={show:!0,url:void 0,params:{},headers:{},confirm:void 0,confirmOk:null,confirmCancel:null,method:"get",pending:!0,pendingMessage:void 0,onSuccess:s.noop,onError:s.noop,onComplete:s.noop,onBefore:s.noop,locale:s.extend({},{confirm:"确定",cancel:"取消"},((o.locale||{}).plugin||{}).request||{})},s.fn.baRequest=a,s.fn.baRequest.Constructor=u,o.plugins.Request=u,s("body").on("click."+t,r.pluginAttrs(c),function(e){e.preventDefault(),a.call(s(this))}),u}),define("./ba/plug/searchBar",["busyAdmin","jquery"],function(s,l){"use strict";var c=s.helper,n="search-bar",e=c.pluginKey(n);function d(e,t){return e.find('[data-search-id="'+t+'"]')}function u(e,t){return e.find('[data-template="'+t+'"]')}s.e.searchBarInitialized=s.ee("initialized",n);var p=function e(t,a){var i=this;i.$element=l(t);i.options=l.extend(true,{},e.DEFAULTS,i.$element.baData(n)||{},a||{});i._init()};function t(e){return c.pluginFn(this,p,e,arguments)}return p.prototype={_init:function(){var a,e=this,t=e.options;t.fields&&"string"==typeof t.fields&&(i=t.fields.split(","),a=[],i.map(function(e){var t=e.split(":"),e=(t[0]||"").trim(),t=(t[1]||"").trim();a.push({name:t,value:e})}),t.fields=a),t.contentLeft?e.contentLeftHtml=l(t.contentLeft).html():e.contentLeftHtml=u(e.$element,"left").html(),t.contentRight?e.contentRightHtml=l(t.contentRight).html():e.contentRightHtml=u(e.$element,"right").html(),t.toolbar?e.toolbarHtml=l(t.toolbar).html():e.toolbarHtml=u(e.$element,"toolbar").html(),t.url=t.url||document.URL;var i=p.TEMPLATE.replace("_toolbar_",e.toolbarHtml||"");i=(i=(i=i.replace("_content_left_",e.contentLeftHtml||"")).replace("_content_right_",e.contentRightHtml||"")).replace("_title_","<span>"+(e.options.title||e.options.locale.title)+"</span>"),e.$template=l(i),e.$form=d(e.$template,"form").attr("action",t.url),e.$fieldSelect=d(e.$template,"field"),e.$accurateInput=d(e.$template,"accurate").prop("checked",t.accurate).attr("title",t.locale.accurate).attr("name",t.accurateName).addClass(t.accurateClass),e.$wordInput=d(e.$template,"word").attr("name",e.options.wordName).attr("placeholder",e.options.placeholder||t.locale.placeholder),e.$keywords=d(e.$template,"keywords"),e.$btnReset=d(e.$template,"reset").html(t.resetText||t.locale.reset).addClass(t.resetClass).attr("href",t.url),e.$btnSubmit=d(e.$template,"submit").addClass(t.searchClass),e.$btnSubmit.find("span").html(t.searchText||t.locale.search),e.$accurateWrap=e.$accurateInput.closest(".checkbox");var n=[e.options.accurateName,e.options.fieldName,e.options.wordName];e.$template.find("[name]").each(function(){var e=l(this),t=e.attr("name");return!t||(-1!==n.indexOf(t)||-1!==t.indexOf("static[")||void e.attr("name","static["+t+"]"))});var r="";(t.fields||[]).map(function(e){var t=e.name||"",e=e.value||"";r+='<option value="'+e+'">'+t+"</option>"}),r?(e.$keywords.addClass("has-field"),o="",t.fieldUnlimited&&(o+='<option value="'+(t.fieldUnlimitedValue||"")+'">'+(!0===t.fieldUnlimited?t.locale.unlimited:t.fieldUnlimited)+"</option>"),o+=r,e.$fieldSelect.html(o)):(e.$fieldSelect.remove(),e.$keywords.addClass("no-field")),t.accurateShow||e.$accurateWrap.remove();i=c.parseURL(document.URL).params||{};e.$form.baFormVal(l.extend({},c.parseURL(t.url).params||{},i));var o=i.hasOwnProperty(t.searchMark);o||e.$form.append('<input type="hidden" name="'+t.searchMark+'" value="1"/>'),o&&!i.hasOwnProperty(t.locale.accurateName)&&!0===t.accurate&&e.$accurateInput.prop("checked",!1),e.$element.addClass("ba-search clearfix").prepend(e.$template),s.app.triggerResize(),c.triggerPluginReady(e.$element,e,"",s.e.searchBarInitialized)},destroy:function(){this.$element.removeClass("ba-search clearfix"),this.$template&&(this.$template.remove(),this.$template=null)}},p.TEMPLATE='<div class="ba-search-left fa fa-search">_title_</div>        <div class="ba-search-right clearfix">_toolbar_</div>\t\t<div class="ba-search-form">\t\t    <form data-search-id="form" method="get" class="form-inline">\t\t        _content_left_\t\t        <div class="form-group" data-search-id="keywords">\t\t            <div class="input-group">\t\t                <div class="input-group-btn"><select data-search-id="field" class="form-control" name="field"></select></div>\t\t                <input data-search-id="word" class="form-control" name="word" />\t\t            </div>\t\t        </div>\t\t        <div class="checkbox"><input class="pill" data-search-id="accurate" type="checkbox" data-toggle="busy-checkbox" value="1" /></div>\t\t        _content_right_\t\t        <div class="form-group btns--bar">\t\t            <button data-search-id="submit" class="btn" type="submit"><i class="fa fa-search"></i> <span></span></button>\t\t            <a type="reset" data-search-id="reset" class="btn"></a>\t\t        </div>\t\t    </form>\t\t</div>',p.KEY=e,p.DEFAULTS={url:"",fields:[],fieldUnlimited:!1,fieldName:"field",wordName:"word",placeholder:"",title:"",accurate:!1,accurateShow:!1,accurateClass:"",accurateName:"accurate",toolbar:"",contentLeft:"",contentRight:"",searchMark:"_search",searchClass:"btn-info",searchText:null,resetClass:"btn-default",resetText:null,locale:l.extend({search:"搜索",reset:"显示全部",placeholder:"请输入关键字",accurate:"精确搜索",unlimited:"不限",title:"按条件搜索"},((s.locale||{}).plugin||{}).searchBar||{})},l.fn.baSearchBar=t,l.fn.baSearchBar.Constructor=p,s.plugins.SearchBar=p,s.autoInit(n,c.pluginAttrs(n),function(){t.call(this)}),p}),define("./ba/plug/selectPicker",["busyAdmin","jquery"],function(c,d){var r=null,l=null,o=null,u=c.helper,p=c.ee,f=c.e,h="select",m="closing,close,opening,open,selecting,select,unselecting,unselect,clearing,clear".split(","),s=u.pluginKey(h);f.selectInitialized=p("initialized",h),m.map(function(e){f[u.camel("select_"+e)]=p(e,h)});var g=function e(t){return"select2:"+t},t=false,v=function e(){if(t)return;t=true;d.fn.select2.defaults.set("theme","ba");var a=u.extends(r.prototype,{render:function e(){var t=u.override(a,"render",this,arguments);t.addClass("ba--select");return t}})};function b(e){function t(e){return o[e]||e}return e.replace(/[^\u0000-\u007E]/g,t)}function y(e,t){if(e.term==null||e.term.trim()==="")return t;if(t.children&&t.children.length>0){var a=d.extend(true,{},t);for(var i=t.children.length-1;i>=0;i--){var n=t.children[i];var r=y(e,n);if(r==null)a.children.splice(i,1)}if(a.children.length>0)return a;return y(e,a)}if(!t.pinyin)t.pinyin=l.convert({text:t.text}).toUpperCase();if(!t.initials)t.initials=l.initials(t.text);var o=b(t.text).toUpperCase();var s=b(e.term).toUpperCase();if(o.indexOf(s)>-1||t.pinyin.indexOf(s)>-1||t.initials.indexOf(s)>-1)return t;return null}var a=function e(t,a){var i=this;i.index=e.INDEX++;i.element=t;i.$element=d(t);i.options=d.extend(true,{},e.DEFAULTS,i.$element.baData(h),a||{});i.isSelect=i.element.tagName==="SELECT";if(i.isSelect){i.$select=i.$element.wrap("<div />");i.$wrap=i.$select.parent()}else{i.$select=i.$element.find("select");i.$wrap=i.$element;if(!i.$select.length){i.$select=d("<select />");i.$select.attr("name",i.options.name||i.$wrap.attr("name")||"").attr("multiple",i.options.multiple||i.$wrap.attr("multiple")?"multiple":null);i.$wrap.append(i.$select)}}i.$select.addClass("form-control").addClass(i.options.selectClass);i.$wrap.addClass("ba-select");var n=i.options;n.data=u.scope(n.data);if(n.width){var r=n.width;if(typeof n.width==="number")r=n.width+"px";i.$wrap.css("width",r)}if(i.$select.attr("multiple"))i.options.multiple=true;i.resetEvent="reset."+s+i.index;i.defaultValue=d.baIsEmpty(i.options.value)?i.$select.val():i.options.value;i.$form=i.$element.closest("form");i.$form.on(i.resetEvent,function(){i.setValue(i.defaultValue)});i.formStatus=i.$select.baFormStatus(i).render();i.ready(i._init)};function e(e){return u.pluginFn(this,a,e,arguments,"api")}return a.prototype={ready:function(i){var n=this;t?i.call(n):c.require([c.lib.select2,c.lib.pinyin],function(t,a){c.plugins.Template.ready(function(){d.fn.select2.amd.require(["select2/diacritics"],function(e){o=e,l=a,r=t,v(),i.call(n)})})})},_init:function(){var n=this,i=n.options,e=n.$select,t=i.locale,a=d.proxy(n.destroy,n);d(document).one(f.appRenderBefore,a),n.modal=n.$wrap.closestBaModal(),n.modal&&n.modal.$element.one(f.modalHide,a),n.url=i.model?c.getConfig("selectPicker").url:"function"==typeof i.url?i.url():i.url,n.isAjax=i.url||i.model,n.singleInline=i.search&&!i.multiple,n.select2Options=d.extend(!0,{},i.select2||{},{minimumResultsForSearch:i.search?0:-1,placeholder:i.placeholder,allowClear:i.clear,multiple:i.multiple,width:"style",containerCssClass:":all:",data:"function"==typeof i.data?i.data():i.data,minimumInputLength:i.searchMin,maximumSelectionLength:i.max,tags:i.tags,tokenSeparators:i.tagsSpace,language:{errorLoading:function(){return t.errorLoading},inputTooLong:function(e){e=e.input.length-e.maximum;return u.sprintf(i.inputLongText||t.inputTooLong,e)},inputTooShort:function(e){e=e.minimum-e.input.length;return u.sprintf(i.inputShortText||t.inputTooShort,e)},loadingMore:function(){return i.loadingMoreText||t.loadingMore},maximumSelected:function(e){return i.maxSelectedText||u.sprintf(t.maximumSelected,e.maximum)},noResults:function(){return i.emptyText||t.noResults},searching:function(){return i.loadingText||t.searching}},ajax:n.isAjax?{delay:0===i.modelLength?0:i.delay,url:n.url,transport:function(e,t,a){if(0!==i.modelLength||!n.remoteData)return n._request(e.url,"list",e.data.q,e.data.page,function(e){n.remoteData=e.result,t(e.result)},function(){a()});t(n.remoteData)}}:null}),n.select2Options.matcher||(n.select2Options.matcher=y);var r=u.scope(i.selectedTemplate);r&&("function"==typeof r?n.select2Options.templateSelection=r:"string"==typeof r&&0===r.indexOf("@")&&(r=(""===(r=r.substring(1).trim())?n.$element.find('[data-template="selected"]'):d(r)).html()||"{{text}}",n.select2Options.templateSelection=function(e){return e.element?d('<div class="clearfix ba--value text-line-1"/>').append(c.plugins.Template.render(r,{id:e.id,text:e.text,selected:!!e.selected,disabled:!!e.disabled,option:e},!0)):e.text}));var o,s=u.scope(i.optionTemplate);s&&("function"==typeof s?n.select2Options.templateResult=s:"string"==typeof s&&0===s.indexOf("@")&&(s=(""===(s=s.substring(1).trim())?n.$element.find('[data-template="option"]'):d(s)).html()||"{{text}}",n.select2Options.templateResult=function(e){if(e.loading)return e.text;e={id:e.id,text:e.text,group:!(!e.element||"OPTGROUP"!==e.element.tagName),selected:!!e.selected,disabled:!!e.disabled,option:e};return d('<div class="clearfix ba--option"/>').toggleClass("ba--group",e.group).append(c.plugins.Template.render(s,e,!0))})),i.placeholder&&!i.multiple&&0===e.find("option").length&&e.prepend(new Option),n.api=e.select2(n.select2Options).data("select2"),n.api.$dropdown.addClass("ba-select--dropdown").css("z-index",c.zIndex()).find("> .select2-dropdown").append('<div class="arrow"/>'),i.multiple&&(n.api.$dropdown.addClass("ba--multiple"),i.clear&&n.api.$selection.addClass("ba--has-clear")),n.singleInline&&(n.api.$selection.after(n.api.dropdown.$searchContainer),n.$inlineSearch=n.api.dropdown.$search,n.$inlineSearch.on("input",function(){n.$inlineSearch.toggleClass("ba--has-val",0<d(this).val().length)})),n.isAjax&&0===i.modelLength&&(o=n.api.dataAdapter.query,n.api.dataAdapter.query=function(a,i){o.call(this,a,function(e){var t=[];return d.each(e.results,function(){var e=n.api.options.options.matcher(a,this);e&&t.push(e)}),i({results:t,pagination:{more:!1}})})}),i.search||i.multiple||n.api.dropdown.$searchContainer.addClass("hidden");var l=[];m.map(function(e){l.push(g(e))}),e.on(l.join(" "),function(e){e=e.type.substring(8);switch(e){case"opening":!i.search&&i.multiple&&n.api.selection.$search.prop("disabled",!0);break;case"open":n.singleInline&&(n.$inlineSearch.removeClass("ba--has-val"),n.$inlineSearch[0].focus(),clearTimeout(n._setFocusTimeId),n._setFocusTimeId=setTimeout(function(){n.$inlineSearch[0].focus()},100));break;case"closing":clearTimeout(n._setFocusTimeId),n._abort()}u.execCallback(n,i[u.camel("on_"+e)],n.element,[n],n.isSelect?n.$element:[n.$wrap,n.$select],p(e,h))}),e.on(f.validateErrorPlacement,function(e,t){return n.$wrap.after(t),!1}),d.baIsEmpty(i.value)?n.formStatus.rendered():n.setValue(i.value),u.triggerPluginReady(n.$element,n,"",f.selectInitialized)},_request:function(e,t,a,i,n,r){var o=this.options;return this._abort(),this.task=c.request(e).method("get").addHeader("Busy-Admin-Plugin","Select").params(this._parseParams({action:t,word:a,page:i,model:o.model,id_field:o.modelIdField||"",text_field:o.modelTextField||"",length:o.modelLength,order:o.modelOrder||"",extend:o.modelExtend?1:0})).pending(!1).success(function(e){return n(e),!1}).error(function(e){return r(e),!1}).exec()},_abort:function(){this.task&&(this.task.abort(),this.task=null)},_parseParams:function(e){var t=this.options,a=u.scope(t.params);return"object"===(void 0===a?"undefined":_typeof(a))?e=d.extend(!0,{},t.params,e):"function"==typeof a&&(e=a(e)),e},setValue:function(t){var a=this,i=a.$select;a.isAjax&&!d.baIsEmpty(t)?a._request(a.url,"value",t,0,function(e){e=e.result.results||[];e.length&&d.map(e,function(e){e.selected=!0}),i.append(a.api.dataAdapter.convertToOptions(e)).val(t).baTriggerEvent("change"),a.formStatus.rendered()},function(){i.val(t).baTriggerEvent("change"),a.formStatus.rendered()}):(i.val(t).baTriggerEvent("change"),a.formStatus.rendered())},setData:function(e,t,a){var i=this,n=[],r=i.$select;e=d.isArray(e)?e:[e],i.api.dataAdapter.convertToOptions?n=i.api.dataAdapter.convertToOptions(e):e.forEach(function(e){var t=i.api.dataAdapter.option(e);t.is("optgroup")&&e.children.forEach(function(e){t.append(i.api.dataAdapter.option(e))}),n.push(t)}),d.baIsEmpty(a)||a?r.html(n):t?r.prepend(n):r.append(n),r.baTriggerEvent("change")},append:function(e){this.setData(e,!1,!1)},prepend:function(e){this.setData(e,!0,!1)},getSelectedData:function(){return this.api.data()},destroy:function(){var e=this;e.remoteData=null,e._abort(),e.$select.off(f.validateErrorPlacement),e.$form.off(e.resetEvent),clearTimeout(e._setFocusTimeId);try{e.api&&(e.api.destroy(),e.api=null)}catch(e){}}},a.INDEX=0,a.KEY=s,a.DEFAULTS={placeholder:"",search:!0,searchMin:0,multiple:!1,clear:!1,data:null,max:0,value:null,width:null,url:!1,delay:250,params:null,model:"",modelExtend:!1,modelIdField:"",modelTextField:"",modelOrder:"",modelLength:20,selectedTemplate:null,optionTemplate:null,tags:!1,tagsSpace:null,select2:{},loadingText:null,inputLongText:null,inputShortText:null,loadingMoreText:null,maxSelectedText:null,emptyText:null,locale:d.extend({errorLoading:"数据加载失败",inputTooLong:"请删除%s个字符",inputTooShort:"至少需要输入%s个字符",loadingMore:"加载中...",maximumSelected:"最多能选择%s个选项",noResults:"无选项",searching:"请稍后..."},((c.locale||{}).plugin||{}).select||{})},d.fn.baSelect=e,d.fn.baSelect.Constructor=a,c.plugins.Select=a,c.autoInit(h,u.pluginAttrs(h),function(){e.call(this)}),a}),define("./ba/plug/shuttle",["busyAdmin","jquery"],function(r,s){var o=r.helper,l=r.e,n="shuttle",c=o.pluginKey(n),d=function e(t,a,i){var n=this;n.api=t;var r=t.options;n.$element=a;n.$header=a.find(".panel-heading");n.$title=n.$header.find("span");n.index=t.index;n.childClass="__ba_shuttle_"+(i?"l":"r")+"_child_"+n.index;n.parentClass="__ba_shuttle_"+(i?"l":"r")+"_parent_"+n.index;n.$checkAll=n.$header.find("input").attr("data-toggle","busy-checked-all").attr("data-child","."+n.childClass).addClass(n.parentClass).baCheckboxRadio();n.$searchBar=a.find(".panel-search");n.$searchInput=n.$searchBar.find("input");n.$body=a.find(".panel-body");n.$empty=n.$body.find(".empty-info").html(r.locale.noData);n.checkTimer=null;n.emptyTimer=null;n.list=[];n.isLeft=i;if(i){n.$title.html(r.leftTitle);n.$moveBtn=t.$btnRight;n.$moveBtn.find("span").html(r.locale.moveDown)}else{n.$title.html(r.rightTitle);n.$moveBtn=t.$btnLeft;n.$moveBtn.find("span").html(r.locale.moveUp)}n.$element.css("height",r.height+"px");var o=n.$header.outerHeight(true);if(!r.search)n.$searchBar.hide();else o+=n.$searchBar.outerHeight(true);n.$body.css("height",r.height-o+"px").on("change",":checkbox",function(){clearTimeout(n.checkTimer);n.checkTimer=setTimeout(function(){if(n.$body.find(":checked").length>0)n.$moveBtn.removeClass("btn-default").addClass("btn-primary").prop("disabled",false);else n.$moveBtn.removeClass("btn-primary").addClass("btn-default").prop("disabled",true)})});n.$searchInput.attr("placeholder",r.placeholder).on("input",function(){var t=(s(this).val()||"").trim();if(t===""){s.map(n.list,function(e){e.$item.removeClass("hide")});n.$empty.html(r.locale.noData);n.empty();return}s.map(n.list,function(e){if(-1!==e.text.indexOf(t))e.$item.removeClass("hide");else e.$item.addClass("hide");n.$empty.html(r.locale.noMatchData);n.empty()})})};d.prototype={append:function e(t){var a=this;if(!t.$item){t.$item=s('<div class="ba--checkbox'+(t.disabled?" disabled":"")+'"><label><input type="checkbox" value="'+t.id+'"'+(t.disabled?" disabled":"")+" /><span>"+t.text+"</span></label></div>");t.$checkbox=t.$item.find("input").attr("data-toggle","busy-checked-all").baCheckboxRadio()}t.$checkbox.off("change").on("change",function(){t.selected=s(this).prop("checked")});t.$checkbox.prop("checked",false).attr("data-parent","."+a.parentClass).attr("class",a.childClass);a.list.push(t);a.$body.append(t.$item);a.empty()},moveTo:function e(a){var t=this;if(a==t)return;var i=[];t.list=s.map(t.list,function(e,t){if(e.selected&&!e.disabled){e.selected=false;e.$item.remove();a.append(e);i.push({id:e.id,text:e.text,disabled:e.disabled});return null}return e});o.execCallback(t.api,t.api.options.onChange,t.api.element,[t.api,i,t.isLeft],t.api.$element,l.shuttleChange);t.$checkAll.prop("checked",false);t.$checkAll[0].indeterminate=false;t.$moveBtn.prop("disabled",true).removeClass("btn-primary").addClass("btn-default");t.empty()},empty:function e(){var t=this;clearTimeout(t.emptyTimer);t.emptyTimer=setTimeout(function(){if(t.$body.find(".ba--checkbox").length>0)t.$empty.hide();else t.$empty.show()})},clear:function e(){this.$body.children().each(function(){if(!s(this).hasClass("empty-info"))s(this).remove()})}};var u=function e(t,a){var i=this;i.element=t;i.$element=s(t);i.index=e.INDEX++;i.options=s.extend(true,{},e.DEFAULTS,i.$element.baData(n),a||{});i._init()};function e(e){return o.pluginFn(this,u,e,arguments)}return u.prototype={_init:function(){var a=this,e=a.options,t=a.$element;a.resetEvent="reset."+c+a.index,a.$form=a.$element.closest("form"),a.$form.on(a.resetEvent,function(){var t=a.defaultValue||[];e.data.map(function(e){e.selected=-1!==t.indexOf(e.id)}),a.render()});var i,n=o.scope(e.data);"function"==typeof n&&(n=n()),e.data=s.isArray(n)?n:[],a.$template=s(u.TEMPLATE),a.isSelect="select"===a.element.tagName.toLowerCase(),a.isSelect?(a.$select=t,a.$template.insertAfter(a.$select).append(a.$select),e.name=a.$select.attr("name"),i=[],a.$select.find("option").each(function(){i.push({id:this.value||"",text:s(this).text()||"",selected:this.hasAttribute("selected"),disabled:this.hasAttribute("disabled")})}),e.data.unshift.apply(e.data,i)):(a.$select=s("<select />"),a.$template.append(a.$select),t.html(a.$template)),a.$select.addClass("input-hidden").attr("name",e.name).attr("multiple","multiple"),a.$btnLeft=a.$template.find(".btn-left"),a.$btnRight=a.$template.find(".btn-right"),a.leftPanel=new d(a,a.$template.find(".panel-left"),!0),a.rightPanel=new d(a,a.$template.find(".panel-right"),!1),a.$btnLeft.on("click",function(){a.$btnLeft.prop("disabled")||(a.rightPanel.moveTo(a.leftPanel),a._setVal())}),a.$btnRight.on("click",function(){a.$btnRight.prop("disabled")||(a.leftPanel.moveTo(a.rightPanel),a._setVal())}),a.render(),t.on(l.validateErrorPlacement,function(e,t){return a.$template.after(t),!1}),r.app.triggerResize(),o.triggerPluginReady(t,a,"",l.shuttleInitialized)},render:function(){var t=this,e=t.options,a=[],i="";t.rightPanel.clear(),t.leftPanel.clear(),s.map(e.data,function(e){e.id=(e.id||"")+"",e.text=e.text||"",e.disabled=e.disabled||!1,e.selected=e.selected||!1,e.selected?(t.rightPanel.append(e),a.push(e.id)):t.leftPanel.append(e),i+='<option value="'+e.id+'"'+(e.selected?" selected":"")+(e.disabled?" disabled":"")+">"+e.text+"</option>"}),t.defaultValue||(t.defaultValue=a),t.$select.html(i)},_setVal:function(){var t=this;s.map(t.leftPanel.list,function(e){t.$select.find('[value="'+e.id+'"]').prop("selected",!1)}),s.map(t.rightPanel.list,function(e){t.$select.find('[value="'+e.id+'"]').prop("selected",!0)}),t.$select.baTriggerEvent("change")},getData:function(){return s.map(this.rightPanel.list,function(e){return{id:e.id,text:e.text,disabled:e.disabled}})},destroy:function(){var e=this;e.isSelect&&e.$select.removeClass("input-hidden").insertAfter(e.$template),e.$template.remove(),e.$element.off(l.validateErrorPlacement),e.$form.off(e.resetEvent)}},u.INDEX=0,u.TEMPLATE='<div class="ba-shuttle row">    <div class="col-sm-5">        <div class="panel panel-default panel-left">            <div class="panel-heading">                <div class="ba--checkbox">                    <label>                        <input type="checkbox"/>                        <span></span>                    </label>                </div>            </div>            <div class="panel-search"><div class="input-group input-group-sm"><div class="input-group-addon"><i class="fa fa-search"></i></div><input type="text" class="form-control"/></div></div>            <div class="panel-body"><div class="empty-info"></div></div>        </div>    </div>    <div class="col-sm-2">        <div class="toolbar">            <button type="button" disabled class="btn btn-default btn-block btn-right"><i class="fa fa-angle-double-right hidden-xs"></i><i class="fa fa-angle-double-down visible-xs-inline"></i> <span class="visible-xs-inline"></span></button>            <button type="button" disabled class="btn btn-default btn-block btn-left"><i class="fa fa-angle-double-left hidden-xs"></i><i class="fa fa-angle-double-up visible-xs-inline"></i> <span class="visible-xs-inline"></span></button>        </div>    </div>    <div class="col-sm-5">        <div class="panel panel-default panel-right">            <div class="panel-heading">                <div class="ba--checkbox">                    <label>                        <input type="checkbox"/>                        <span></span>                    </label>                </div>            </div>            <div class="panel-search"><div class="input-group input-group-sm"><div class="input-group-addon"><i class="fa fa-search"></i></div><input type="text" class="form-control"/></div></div>            <div class="panel-body"><div class="empty-info"></div></div>        </div>    </div></div>',u.KEY=c,u.DEFAULTS={leftTitle:"列表1",rightTitle:"列表2",placeholder:"关键词搜索",search:!1,height:320,data:null,locale:s.extend({noData:"无数据",noMatchData:"无匹配数据",moveUp:"上移",moveDown:"下移"},((r.locale||{}).plugin||{}).table||{})},u.Panel=d,s.fn.baShuttle=e,s.fn.baShuttle.Constructor=u,r.plugins.Shuttle=u,l.shuttleInitialized=r.ee("initialized",n),l.shuttleChange=r.ee("change",n),r.autoInit(n,o.pluginAttrs(n),function(){e.call(this)}),u}),define("./ba/plug/table",["busyAdmin","jquery","bootstrap"],function(w,k){var C="table",_=w.helper,o=w.ee,s=w.e,p=_.override,r="table.state",l="table.tree",e="check,check-all,check-some,click-cell,click-row,collapse-row,column-switch,dbl-click-cell,dbl-click-row,expand-row,load-error,load-success,page-change,init-table-after,post-body,post-footer,post-header,pre-body,refresh,refresh-options,reset-view,search-view,scroll-body,sort-view,toggle,uncheck,uncheck-all,uncheck-some,before-refresh,export-saved,export-started,resume-url".split(","),f=_.pluginKey(C),S=k("body"),E=0,i;s.tableInitialized=o("initialized",C),k.map(e,function(e){s[_.camel("table_"+e.replace(/-/g,"_"))]=o(e,C)});var t=function e(a){a=typeof a==="string"?[a]:a;a.map(function(e,t){a[t]=e+".bs.table"});return a.join(" ")},T=function e(t,a){return w.plugins.Template.render(t,a,true)},c=function e(t){return typeof t.state==="boolean"?document.URL:t.state},D=function e(t,a){if(a===true)if(w.app.isInContent(t))return w.app.isMobileSize()?0:k(window).height()-t.offset().top-w.app.getContentFrame().paddingBottom;else return 0;else if(typeof a==="string"&&a){if(0===a.indexOf("parent")){a=a.substring(6);if(!a)return t.parent().height();return t.closest(a).height()}return k(a).height()}else if(a instanceof k)return a.height();return a},h=function e(t,a){var i=a.options;t._data=t._data||{};t._data["tree-node"]=!k.baIsEmpty(t[i.idField])?t[i.idField]:"";t._data["tree-parent"]=!k.baIsEmpty(t[i.parentField])?t[i.parentField]:"";t._data["tree-branch"]=!!t[i.hasChildrenField];a.handleRow(t)},d=function e(t,a,i){if(!t.treeState)return;var n=JSON.parse(localStorage.getItem(w.app.cacheKey(l))||"{}");var r=c(t);n[r]=n[r]||[];var o=n[r].indexOf(a);if(i){if(-1!==o)n[r].splice(o,1)}else if(-1===o)n[r].push(a);localStorage.setItem(w.app.cacheKey(l),JSON.stringify(n))},m=function e(t){if(!t.treeState)return[];var a=JSON.parse(localStorage.getItem(w.app.cacheKey(l))||"{}");var i=c(t);return a[i]||[]},n=function e(){if(i)return;i=true;var u=_.extends(k.BootstrapTable.prototype,{initContainer:function e(){var t=this;p(u,"initContainer",t,arguments);t._initFixedColumns()},_initFixedColumns:function e(){var t=this;if(!t.options.stickyHeader)return;var a=s.modalShow;var i=s.modalHided;k(document).off(a).on(a,function(){if(t.needFixedColumns&&t.options.fixedRightNumber){var e=t.options.stickyHeaderOffsetRight||0;e+=_.getScrollbarWidth();t.$fixedColumnsRight.find(".sticky-header-container").css("right",e+"px");t.$stickyContainer.css("right",e+"px")}}).off(i).on(i,function(){if(t.needFixedColumns&&t.options.fixedRightNumber){var e=t.options.stickyHeaderOffsetRight||0;t.$fixedColumnsRight.find(".sticky-header-container").css("right",e+"px");t.$stickyContainer.css("right",e+"px")}})},initToolbar:function e(){var t=this;t._initExportWayButton();p(u,"initToolbar",t,arguments);t._initToolbarSystem();t._initExportWay()},_initExportWay:function e(){var a=this;var t=a.constants.html;var i=a.options;var n=i.exportDataType;var r=i.exportTypes;var o=function e(t){a.exportTable({type:t,escape:false});i.exportDataType=n};var s=function e(){if(r.length===1)o(r[0]);else{var t=[];r.forEach(function(e){t.push({name:k.fn.bootstrapTable.exportTypeName[e],value:e})});w.dialog.prompt("请选择导出类型",r[0],{formType:"select",selectOptions:t,minlength:1,btn:["导出","取消"]},function(e){o(e)},function(){i.exportDataType=n})}};if(!a.options.showExportWay)return;var l=false;a.columns.forEach(function(e){if(e.checkbox||e.radio)l=true});a.$exportWay=a.$toolbar.find(".columns div.ba--export-way");a.$exportWayCurrent=k(_.sprintf(t.pageDropdownItem,"","导出当页数据"));a.$exportWaySelected=k(_.sprintf(t.pageDropdownItem,"","导出选中数据"));a.$exportWayAll=k(_.sprintf(t.pageDropdownItem,"","导出全部数据"));a.$exportWayMenu=k(t.toolbarDropdown.join(""));a.$exportWayMenu.append(a.$exportWayCurrent);if(l)a.$exportWayMenu.append(a.$exportWaySelected);if(i.pagination)a.$exportWayMenu.append(a.$exportWayAll);a.$exportWay.append(a.$exportWayMenu);a.$exportWayMenu.children().off("click").on("click",function(e){e.preventDefault();var t=k(this);if(t.is(a.$exportWayAll)){i.exportDataType="all";w.dialog.confirm('确认要导出全部记录吗？<div class="text-danger size-13">如果数据量过大可能会造成浏览器卡顿，属于正常现象，请耐心等待。</div>',function(){s()},function(){i.exportDataType=n})}else if(t.is(a.$exportWaySelected)){if(a.getSelections().length===0){w.dialog.toast("请选择导出的数据行");return}i.exportDataType="selected";s()}else{i.exportDataType="basic";s()}})},_initExportWayButton:function e(){var t=this;var a=t.constants;var i=t.options;if(!t.options.showExportWay)return;t.buttons=Object.assign(t.buttons,{exportWay:{html:'<div class="ba--export-way '+a.classes.buttonsDropdown+'">    <button type="button" title="'+i.formatExport()+'" class="'+a.buttonsClass+' dropdown-toggle" '+a.dataToggle+'="dropdown">        '+(i.showButtonIcons?_.sprintf(a.html.icon,i.iconsPrefix,i.icons.export):"")+"        "+(i.showButtonText?i.formatExport():"")+"        "+a.html.dropdownCaret+"    </button></div>"}})},_initToolbarSystem:function e(){var l=this;if(l.$toolbarSystem)return;var t=l.$toolbar.children();var a=l.options.toolbarSelector;if(a)l.$toolbarSystem=k(a);else l.$toolbarSystem=k('<div class="fixed-table-toolbar-system clearfix"/>');l.$toolbarSystem.append(t);l.$toolbarSearchBar=k('<div class="fixed-table-toolbar-search clearfix"/>');l.$toolbar.prepend(l.$toolbarSearchBar);if(!a)l.$toolbar.append(l.$toolbarSystem);if(t.length){l.$toolbar.show();l.$toolbarSystem.show()}else{l.$toolbar.hide();l.$toolbarSystem.hide()}l.$toolbarSystem.on("click","[data-url]",function(){var e=k(this);var i=e.data()||{};if(i.hasOwnProperty("toggle"))return;var n=i.field||"id";var r="";if(-1!==n.indexOf(",")){var t=n.split(",");n=t[1].trim();r=t[0].trim()}var o=i.name||n;var s=_.scope(i.params);e.baRequest({params:function e(){if(s===false)return{};var t=((typeof s==="undefined"?"undefined":_typeof(s))==="object"?s:{})||{};if(n){var a=r?{}:[];(i.checked?l.getSelections():l.getData()).map(function(e){if(r)t[o+"["+e[r]+"]"]=e[n];else a.push(e[n])});if(!r)t[o]=a}if(typeof s==="function")return s.call(l,t);return t},confirm:function e(){if(i.confirm&&i.checked)return _.sprintf(i.confirm,l.getSelections().length);return i.confirm}})})},initHeader:function e(){var t=this;p(u,"initHeader",t,arguments);t.prepareTree()},initBody:function e(){var t=this;if(t.treeTableEnable)t.options.virtualScroll=false;p(u,"initBody",t,arguments);t.initTree()},prepareTree:function e(){var t=this;var a=t.options.treeShowField;t.treeTableEnable=false;if(a)for(var i in t.header.fields)if(t.header.fields[i]===a){t.treeTableEnable=true;break}},initTree:function e(){var o=this;var s=o.options;o.destroyTree();if(!o.treeTableEnable)return;var t=-1;var a=-1;o.columns.map(function(e){if(e.visible)a++;if(e.field==s.treeShowField&&e.visible)t=a});if(t<0)return;var i=null;var n=null;var l=function e(){if(i===null)i=m(s);if(!i.length)return;var a=[];i.map(function(e){var t=n.tree[e];if(!t)a.push(e);else if(t.isBranchNode())t.expand()});i=a};o.$el.treetable({expandable:true,column:t,indenterTemplate:'<span class="ba--tree-indenter"><i></i></span>',expanderTemplate:'<span class="fa"></span>',indent:s.treeIndent,stringCollapse:"",stringExpand:"",branchAttr:"treeBranch",nodeIdAttr:"treeNode",parentIdAttr:"treeParent",collapsedClassName:"ba--tree-collapsed",expandedClassName:"ba--tree-expanded",branchClassName:"ba--tree-branch",leafClassName:"ba--tree-leaf",onInitialized:function e(){n=this;l();o.resetView()},onNodeCollapse:function e(){var t=this;if(t._treeTask){t._treeTask.abort();t._treeTask=null}t.expander.removeClass("fa-spin");d(o.options,t.id,true);o.resetView()},onNodeExpanded:function e(){var t=this;if(t.children.length)o.resetView()},onNodeExpand:function e(){var n=this;if(n.children.length||!s.treeLazy){d(o.options,n.id,false);return}var r=function e(){n.expander.removeClass("fa-spin")};var t=function e(t){var a=[];var i=s.data.length;t.map(function(e){s.data.push(e);h(e,o);a.push(p(u,"initRow",o,[e,i]));i++});o.initData(s.data);o.initSearch();o.initSort();o.$el.treetable("loadBranch",n,a.join("")).treetable("expandNode",n.id);o.initBodyEvent();o.updateSelected();o.initFooter();o.resetView();d(o.options,n.id);r();l()};var a=function e(t){w.dialog.tipError(t);r()};n.expander.addClass("fa-spin");n._treeTask&&n._treeTask.abort();var i=_.scope(s.treeLoad);if(typeof i==="function")n._treeTask=i.apply(o,[o.options,o.options.data[n.row.data("index")],t,a]);else n._treeTask=w.request(s.url).addHeader("Busy-Admin-Plugin","Table").pending(false).params({action:"get_children",model:s.model,extend:s.modelExtend?1:0,order:s.sortOrder||"",sort:s.sortName||"",tree_parent_field:s.parentField,tree_parent_root:s.parentRoot,tree_parent_id:n.id,tree_id_field:s.idField,tree_has_children_field:s.hasChildrenField}).method(s.method).error(function(e){a(e.message);return false}).success(function(e){t(e.result.list);return false}).exec();o._treeTask=o._treeTask||[];o._treeTask.push(n._treeTask)}},true)},renderTree:function e(t,a,i,n){var r=this;var o=r.options;var s=i.filter(function(e){return t[o.idField]==e[o.parentField]});n.append(p(u,"initRow",r,arguments));var l=s.length-1;for(var c=0;c<=l;c++){var d=s[c];h(d,r);r.renderTree(d,k.inArray(d,i),i,n)}},destroyTree:function e(){var t=this;if(t._treeTask){(t._treeTask||[]).map(function(e){e&&e.abort&&e.abort()});t.$el.treetable("destroy")}t._treeTask=null},initRow:function e(t,a,i,n){var r=this;if(r.treeTableEnable){if(r.options.parentRoot==t[r.options.parentField]||!t[r.options.parentField]){h(t,r);r.renderTree(t,a,i,n);return true}return false}return p(u,"initRow",r,arguments)},initResizable:function e(){var i=this;if(!i.options.resizable)return;var t=f+".col-resize"+i.tableIndex;var a="mousemove."+t;var n="mouseup."+t;var r="mousedown."+t;var o="mouseleave."+t;var s=i.$tableContainer;var l={};var c="cursor-col-resize";var d;var u=function e(){i._colResizeStart=false;i._colResizeAllow=false;i._colResize=null;d.hide();S.removeClass(c)};i.columns.map(function(e){l[e.field]=e});i._colResizeStart=false;d=i._$colResizeLine=(i._$colResizeLine||k('<div class="ba--resizable-line"/>')).hide().remove();s.append(d);i.$container.addClass("ba--resizable");i.$header.find("th[data-field]").off([a,o,r,n].join(" ")).on(a,function(e){var t=k(this);i._colResizeAllow=t.width()-(e.clientX-t.offset().left)<5;S.toggleClass(c,i._colResizeAllow||i._colResizeStart)}).on(o,function(){if(!i._colResizeStart)u()}).on(r,function(e){if(!i._colResizeAllow)return;e.preventDefault();var t=k(this);var a=t.outerWidth(true);i._colResizeStart=true;i._colResize={column:l[t.data("field")],width:a,newWidth:a,start:e.clientX,left:e.clientX-s.offset().left};d.show().css("left",i._colResize.left)});S.off([a,n].join(" ")).on(a,function(e){if(!i._colResizeStart)return;var t=e.clientX-i._colResize.start;i._colResize.newWidth=i._colResize.width+t;if(i._colResize.newWidth<=30){i._colResize.newWidth=30;return}d.css("left",i._colResize.left+t)}).on(n,function(){if(i._colResize){i._colResize.column.width=i._colResize.newWidth;i.initHeader();i.initFooter();i.resetView()}u()})},resetView:function e(t){var a=this;if(!t||t&&!t.hasOwnProperty("height"))a.options.height=D(a.$container.parent(),a.options._height);a.initResizable();p(u,"resetView",a,arguments)},trigger:function e(t){var a=this;var i=a.options;var n=Array.prototype.slice.call(arguments),r;if(-1!==["check","uncheck","check-all","uncheck-all","pre-body"].indexOf(t)){var o=a.getSelections().length===0;a.$toolbarSystem.find("[data-disabled]").prop("disabled",o).toggleClass("disabled",o)}switch(t){case"init-table-after":if(i.state){r=v(i);if(!r.columns||Object.keys(r.columns).length!=a.columns.length){r.columns={};a.columns.map(function(e){r.columns[e.field]=e.visible});g(i,r)}else a.columns.map(function(e){e.visible=!!r.columns[e.field]});if(k.isNumeric(r.pageSize))a.options.pageSize=r.pageSize}break;case"column-switch":if(i.state){var s=n[1];var l=n[2];var c=v(i);c.columns=c.columns||{};c.columns[s]=l;g(i,c)}break;case"page-change":if(i.state){r=v(i);r.pageSize=n[2];g(i,r)}break}p(u,"trigger",a,arguments)},destroy:function e(){p(u,"destroy",this,arguments);S.off("."+f);this.destroyTree()}})},I=function e(t,a,i,n,r,o){return T(t,{index:n,item:i,value:a,field:r,is_print:o})},g=function e(t,a){var i=w.app.cacheKey(r);var n=JSON.parse(localStorage.getItem(i)||"{}");n[c(t)]=a;localStorage.setItem(i,JSON.stringify(n))},v=function e(t){var a=JSON.parse(localStorage.getItem(w.app.cacheKey(r))||"{}");return a[c(t)]||{}},a=function n(e,t){var g=this;g.element=e;g.$element=k(e);g.libs=[];g.api=null;g.index=E++;g.options=k.extend(true,{},n.DEFAULTS,g.$element.baData(C)||{},t||{},{classes:"table",tableBorderExtra:3,fixedColumnsBorderExtra:2,fixedColumnsExtra:1,iconsPrefix:"fa",queryParamsType:"limit",paginationLoop:false,silentSort:false,flex:true,loadingTemplate:function e(){return'<i class="ba-pending-icon"></i>'}});g.table=g.element.tagName==="TABLE";if(g.table){g.$table=g.$element.wrap('<div class="ba-table"/>');g.$wrap=g.$table.parent()}else{g.$wrap=g.$element;g.$table=g.$element.addClass("ba-table").find("table");g.$table.data(n.KEY,g)}g.$wrap.data(n.KEY,g);var v=g.options;v.buttons=_.scope(v.buttons);v.customSearch=_.scope(v.customSearch);v.icons=_.scope(v.icons);v.headerStyle=_.scope(v.headerStyle);v.customSort=_.scope(v.customSort);v.rowStyle=_.scope(v.rowStyle);v.rowAttributes=_.scope(v.rowAttributes);v.detailFilter=_.scope(v.detailFilter);v.footerStyle=_.scope(v.footerStyle);if(v.stickyHeader){var a=w.app.getContentFrame();var i=a.left+a.paddingLeft;var r=a.paddingRight;if(!v.stickyHeaderOffsetY)v.stickyHeaderOffsetY=a.top-1;if(!v.stickyHeaderOffsetLeft)v.stickyHeaderOffsetLeft=i;if(!v.stickyHeaderOffsetRight)v.stickyHeaderOffsetRight=r}if(v.filterControl){g.libs.push(w.lib.bootstrapTableFilterControl);if(!v.filterControlContainer){var o="ba_table__filter_control_"+g.index;g.$filterControlContainer=k('<div id="'+o+'"/>');v.filterControlContainer="#"+o;S.append(g.$filterControlContainer)}}if(v.reorderableRows)g.libs.push(w.lib.bootstrapTableReorderRows);if(v.reorderableColumns)g.libs.push(w.lib.bootstrapTableReorderColumns);if(v.treeShowField)g.libs.push(w.lib.treeTable);if(v.showPrint){v.icons.print="fa-print";v.printPageBuilder=v.printPageBuilder||function(e){return'<html lang="zh-CN">    <head>        <title>打印</title>        <style type="text/css" media="print">            @page {size: auto; margin: 25px 0 25px 0;}        </style>        <style type="text/css" media="all">            table { border-collapse: collapse; font-size: 12px; }            table, th, td { border: 1px solid grey; }            th, td { text-align: center; vertical-align: middle; }            p { font-weight: bold; margin-left:20px; }            table { width:94%; margin-left:3%; margin-right:3%; }            div.bs-table-print { text-align:center; }        </style>    </head>    <body><div class="bs-table-print">'+e+"</div></body></html>"};g.libs.push(w.lib.bootstrapTablePrint)}if(v.showExport||v.showExportWay){if(typeof v.exportTypes==="string")v.exportTypes=v.exportTypes.split(",");var s=v.exportFilename||"%s";v.exportFilename=function(){return _.sprintf(s,moment().format(v.exportFilenameDateFormat||"YYYYMMDDHHmmss"))};var l="fa-download";if(!k.isArray(v.exportTypes)){var c=[];v.exportTypes.split(",").map(function(e){e=e.trim();if(e)c.push(e)});v.exportTypes=c}var d=v.exportTypes;if(d.length===1)switch(d[0]){case"excel":case"csv":case"xlsx":l="fa-file-excel-o";break;case"png":l="fa-file-image-o";break;case"txt":l="fa-file-txt-o";break;case"doc":l="fa-file-word-o";break;case"xml":case"json":l="fa-file-code-o";break}var u=function e(t,a){if(-1!==d.indexOf(t))g.libs.push(a)};u("png",{module:w.lib.html2canvas,exports:"html2canvas"});u("xlsx",{module:w.lib.xlsx,exports:"XLSX"});v.icons.export=l;g.libs.push(w.lib.bootstrapTableExport,{module:w.lib.moment,exports:"moment"})}if(v.model)v.url=w.getConfig("table").url;if(v.url){var p=_.scope(v.queryParams);v.queryParams=function(e){var t=g._searchParams||{};for(var a in t)e[a]=t[a];if(typeof p==="function")e=p.call(this,e);if(e===false)return false;return k.extend(true,{},e,{model:v.model,extend:v.modelExtend?1:0},v.treeLazy?{tree_lazy:1,tree_parent_field:v.parentField,tree_parent_root:v.parentRoot,tree_id_field:v.idField,tree_has_children_field:v.hasChildrenField}:{})};if(typeof v.pagination!=="boolean")v.pagination=true;v.url=v.url===true?document.URL:v.url;v.sidePagination="server";v.ajax=function(i){if(v.route&&!v.model)if(!g._routeInit)g._routeInit=true;else if(!g._noRecordRoute||g._needReplaceRoute){g._noRecordRoute=false;g._needReplaceRoute=false;var e=_.parseURL(v.url);var t=k.extend(true,{},e.params||{},i.data);var a=_.scope(v.routeFilterKeys);if(typeof a==="function")a=a.call(g);if(!k.isArray(a))a=[];a.concat(n.ROUTE_FILTER_KEYS).map(function(e){delete t[e]});w.route.show(e.path+"?"+k.param(t),{popStateDispatch:false},false,true)}g._abort();g.task=w.request(i.url).addHeader("Busy-Admin-Plugin","Table").pending(false).cache(i.cache).params(i.data).method(i.type).error(function(e,t,a){i.error(a)}).success(function(e,t,a){i.success(e.result||{},t,a);return false}).exec()}}else if(typeof v.pagination!=="boolean")v.pagination=false;g.searchImplant=false;if(v.search&&typeof v.search==="string"){g.searchSelector=v.search;v.search=false;if(0===g.searchSelector.indexOf("@")){g.searchSelector=g.searchSelector.substring(1).trim();g.searchImplant=true;if(!g.searchSelector)g.searchSelector=k(g.$wrap.find('[data-template="search"]').html())}}v._height=v.height;v.height=D(g.$wrap,v._height);g.$table.find("> thead > tr").each(function(){var e=k(this);e.find("> th").each(function(e){var t=k(this);var a=t.attr("width");if(a)t.attr("data-width",a);if(v.url)if(t.attr("data-searchable")===undefined)t.attr("data-searchable","false");if(typeof v.clickToSelect!=="boolean"&&t.data("checkbox"))v.clickToSelect=true;var i="ba-backups-print-formatter";var n="ba-backups-formatter";var r="ba-backups-footer-formatter";var o="data-print-formatter";var s="data-formatter";var l="data-footer-formatter";var c="print-formatter";var d=t.attr(o);var u;d=(k.baIsEmpty(d)?t.attr(i):d)||"";if(0===d.indexOf("@")){u=d.substring(1).trim();var p=(u===""?t.find('[data-template="print"]').html():g.$element.find('[data-template="print@'+u+'"]').html())||"{{value}}";t.removeAttr(o).attr(i,d).data(c,function(e,t,a){return I(p,e,t,a,this.field,true)})}d=t.attr(s);d=(k.baIsEmpty(d)?t.attr(n):d)||"";if(0===d.indexOf("@")){u=d.substring(1).trim();var f=(u===""?t.find('script[type="text/html"],script[type="text/template"],template').not('[data-template="print"]').html():g.$element.find('[data-template="formatter@'+u+'"]').html())||"{{value}}";t.removeAttr(s).attr(n,d).data("formatter",function(e,t,a,i){return I(f,e,t,a,i,false)});if(!t.data(c))t.data(c,function(e,t,a){return I(f,e,t,a,this.field,true)})}d=t.attr(l);d=(k.baIsEmpty(d)?t.attr(r):d)||"";if(d){var h=d.replace(/\\@/g,_.encodeUnicode("@")).replace(/\\\(/g,_.encodeUnicode("(")).replace("\\)",_.encodeUnicode(")")).replace(/\\u/g,"#$u");var m=/(@[a-z]+\(.*?\))/gim;if(h.match(m))t.removeAttr(l).attr(r,d).data("footer-formatter",function(i){var a=this.field;var n=function e(){var t=0;i.map(function(e){t+=+(e[a]||0)});return t};return _.decodeUnicode(h.replace(m,function(e){var a=e.match(/([a-z]+)\((.*?)\)/i);if(a){var t=function e(t){if(a[2])return t.toFixed(+a[2]);return t};switch(a[1].toLowerCase()){case"sum":return t(n());case"average":return t(n()/i.length);case"count":return i.length;default:return a[0]}}}).replace(/#\$u/g,"\\u"))})}})});if(typeof v.clickToSelect!=="boolean")v.clickToSelect=false;if((v.fixedNumber>0||v.fixedRightNumber>0)&&typeof v.fixedColumns!=="boolean")v.fixedColumns=true;if(v.data){v.data=_.scope(v.data);if(typeof v.data==="function")v.data=v.data()}var f="ba-backups-detail-formatter";var h=g.$element.attr(f);if(h&&!v.detailFormatter)v.detailFormatter=h;if(v.detailView&&typeof v.detailFormatter==="string"&&0===v.detailFormatter.indexOf("@")){g.$element.attr(f,v.detailFormatter);var m=g.$element.find('[data-template="detail"]').html();v.detailFormatter=function(e,t,a){return T(m||"{{item}}",{index:e,item:t})}}v.detailFormatter=_.scope(v.detailFormatter);f="ba-backups-toolbar";h=g.$element.attr(f);if(h&&!v.toolbar)v.toolbar=f;if(typeof v.toolbar==="string"&&0===v.toolbar.indexOf("@")){g.$element.attr(f,v.toolbar);g.toolbarTpl=true;v.toolbar=k(g.$element.find('[data-template="toolbar"]').html())}var b=_.scope(v.ignoreClickToSelectOn);v.ignoreClickToSelectOn=function(e){var t=k(e);var a=e.tagName;var i=t.closest("label");if(t.data("click-to-select")===false||t.closest("a").length||t.closest("button").length||t.parent().closest(".bs-checkbox").length||t.closest(".ba--tree-indenter").length||["A","BUTTON","INPUT","TEXTAREA","SELECT"].includes(a)||i.length&&i.attr("for"))return true;if(typeof b==="function")return b.call(this,e);return false};var y=v.locale;if(v.noDataText)y.noMatches=v.noDataText;v.locale="";for(var $ in y){var x=y[$];if($==="showingRowsHasFilter")continue;v["format"+$.charAt(0).toUpperCase()+$.slice(1)]=new Function('var args = Array.prototype.slice.call(arguments);\nif (args[3] !== undefined && args[2] !== undefined && args[3] > 0 && args[3] > args[2]) {\n    args.unshift("'+x+y.showingRowsHasFilter+'")\n} else {\n    args.unshift("'+x+'");\n}\nreturn busyAdmin.helper.sprintf.apply(null, args);')}g.ready(g.init)};function u(e){return _.pluginFn(this,a,e,arguments,"api")}return a.prototype={ready:function(e){function t(){w.requireQueue(a.libs,function(){e.call(a)})}var a=this;i?t():w.requireQueue([w.lib.bootstrapTable,w.lib.bootstrapTableStickyHeader,w.lib.bootstrapTableFixedColumns],function(){w.plugins.Template.ready(function(){n(),t()})})},init:function(){var r=this,e=k.proxy(r.destroy,r);r.eventNamespace="."+a.KEY+r.index,r.routeNoDispatchEvent=""+s.routeNoDispatch+r.eventNamespace,r.modalReadyEvent=""+s.modalReady+r.eventNamespace,k(document).one(s.appRenderBefore,e).off(r.routeNoDispatchEvent).on(r.routeNoDispatchEvent,function(){var e=r.resumeByUrl();0<e&&r.api.refresh({pageNumber:e})}).on(r.modalReadyEvent,function(e,t){t.$element.closestBaTable()===r&&(t._bindBaTable=r)}),r.modal=r.$wrap.closestBaModal(),r.modal&&r.modal.$element.one(w.e.modalHide,e),r.$table.on(t("all"),function(e,t,a){t=t.replace(".bs.table","");var i=r.api=e.sender;switch(a.unshift(i),r.modal&&-1!==["post-body","load-success"].indexOf(t)&&r.modal.resetView(),t){case"init-table-after":r.$wrap.addClass("ba--ready");var n=r.resumeByUrl();0<n&&(i.options.pageNumber=n);break;case"pre-body":r.initCustomSearch();break;case"post-body":r._needResumeScroll&&(r._needResumeScroll=!1,i.scrollTo(r._scrollTop)),r.initialized||(r.initialized=!0,_.triggerPluginReady(r.$element,r,"",s.tableInitialized));break;case"before-refresh":r._scrollTop=i.getScrollPosition(),r._needResumeScroll=!0,r._noRecordRoute=!0}_.execCallback(r,r.options.onAll,r.element,a,r.$element,o(t,C))}).bootstrapTable(r.options),r.api=r.$table.data("bootstrap.table")},resumeByUrl:function(){var e=this,t=e.options,a=e.api;if(!a||!t.route||t.model)return 0;var i=_.parseURL(document.URL).params||{},n=1,r=+(i.limit||a.options.pageSize||0),o=+(i.offset||0);0<r&&0<o&&(n=Math.ceil(o/r)+1,a.options.pageSize=r);o=k.trim(i.sort||""),r=k.trim(i.order||"");return o&&r&&(a.options.sortName=o,a.options.sortOrder=r),a.options.search&&(a.options.searchText=k.trim(i.search),a.initSearchText()),delete i.limit,delete i.offset,delete i.sort,delete i.order,delete i.search,e.$searchBarForm&&e.$searchBarForm.length&&(e.$searchBarForm[0].reset(),e.$searchBarForm.baFormVal(i)),_.execCallback(e,t.onResumeUrl,e.element,[i],e.$element,s.tableResumeUrl),e._searchParams=i,n},initCustomSearch:function(){var i=this,e=i.api,t=i.options;e&&t.url&&i.searchSelector&&!i.$searchBar&&e.$toolbarSearchBar&&(i.$searchBar=k(i.searchSelector),i.searchImplant&&i.$searchBar.length&&(k(document).on(w.e.appPluginReady,function(e,t,a){a instanceof w.plugins.SearchBar&&t.closest(i.$searchBar).length&&i.initCustomSearchEvent()}),i.$searchBarMark=k("<div />").insertAfter(i.$searchBar),e.$toolbarSearchBar.append(i.$searchBar),e.$toolbar.show()),i.initCustomSearchEvent())},initCustomSearchEvent:function(){var t=this,a=t.api;t.$searchBar&&t.$searchBar.length&&a&&(t.$searchBarForm=t.$searchBar.find("form"),t.$searchBarReset=t.$searchBarForm.find('[type="reset"]'),t.$searchBarForm.off("submit."+f).on("submit."+f,function(e){return e.preventDefault(),t._searchParams={},k(this).serializeArray().map(function(e){-1===["offset","limit","sort","order","search","searchable","filter"].indexOf(e.name)&&(t._searchParams[e.name]=e.value)}),t._needReplaceRoute=!0,a.refresh({pageNumber:1}),!1}),t.$searchBarReset.off("click."+f).on("click."+f,function(e){return e.preventDefault(),t.reset(),!1}))},reset:function(e){var t=this.api;this._searchParams=e||{},this._needReplaceRoute=!0,this.$searchBarForm&&this.$searchBarForm.length&&(this.$searchBarForm[0].reset(),this.$searchBarForm.baFormVal(this._searchParams)),t&&(t.options.sortName=void 0,t.options.sortOrder=void 0,t.getCaret(),t.refresh({pageNumber:1}))},getQueryParams:function(e,t){var a=this.api,i={};return!0===e&&(t=!(e=null)),a&&(i=a.initServer(!1,e,null,!0)),t?k.param(i):i},_abort:function(){this.task&&(this.task.abort(),this.task=null)},destroy:function(){var e=this;e.$searchBar&&(e.$searchBarForm&&(e.$searchBarForm.off("."+f),e.$searchBarReset.off("."+f)),e.$searchBarMark&&(e.$searchBar.insertBefore(e.$searchBarMark),e.$searchBarMark.remove()),e.$searchBar=null),e._abort(),e.$filterControlContainer&&(e.$filterControlContainer.remove(),e.$filterControlContainer=null),e.api&&(e.api.destroy(),e.api=null),k(document).off(e.eventNamespace),e.$table.off(t("all")).removeData("bootstrap.table"),e.table&&(e.$element.insertAfter(e.$wrap),e.$wrap.remove()),e.toolbarTpl&&e.options.toolbar.remove()}},a.KEY=f,a.ROUTE_FILTER_KEYS=["model","extend","searchable","tree_lazy","tree_parent_field","tree_parent_root","tree_id_field","tree_has_children_field"],a.DEFAULTS={type:"ajax",route:!1,fixedLayout:!0,showColumns:!1,showPrint:!1,search:!1,showSearchButton:!0,showSearchClearButton:!0,searchOnEnterKey:!0,bordered:!1,resizable:!0,reorderableRows:!1,reorderableColumns:!1,showExport:!1,exportTypes:"excel",showExportWay:!1,idField:"id",selectItemName:"id[]",noDataText:"",state:!1,treeShowField:null,treeState:!1,treeIndent:16,treeLazy:!1,treeLoad:null,parentField:"parent_id",parentRoot:0,hasChildrenField:"has_children",pageList:[10,20,30,40,50,100,200],pageSize:20,model:"",modelExtend:!1,icons:{paginationSwitchDown:"fa-chevron-down",paginationSwitchUp:"fa-chevron-up",refresh:"fa-refresh",toggleOff:"fa-list-alt",toggleOn:"fa-list-alt",columns:"fa-th",detailOpen:"fa-angle-right",detailClose:"fa-angle-down",fullscreen:"fa-arrows-alt",search:"fa-search",clearSearch:"fa-repeat"},onBeforeRefresh:k.noop,onInitTableAfter:k.noop,locale:k.extend({copyRows:"复制行",print:"打印",loadingMessage:"请稍候...",recordsPerPage:"每页%s条",showingRows:"%s-%s/%s条",showingRowsHasFilter:", (从%s条中过滤)",sRPaginationPreText:"上一页",sRPaginationPageText:"第%s页",sRPaginationNextText:"下一页",detailPagination:"共%s条",clearSearch:"重置",search:"搜索",noMatches:"暂无相关记录",paginationSwitch:"隐藏/显示分页",paginationSwitchDown:"显示分页",paginationSwitchUp:"隐藏分页",refresh:"刷新",toggle:"切换",toggleOn:"显示卡片视图",toggleOff:"隐藏卡片视图",columns:"列",columnsToggleAll:"切换所有",fullscreen:"全屏",allRows:"所有",autoRefresh:"自动刷新",export:"导出",jumpTo:"跳转",advancedSearch:"高级搜索",advancedCloseButton:"关闭",filterControlSwitch:"隐藏/显示过滤",filterControlSwitchHide:"隐藏过滤",filterControlSwitchShow:"显示过滤"},((w.locale||{}).plugin||{}).table||{})},k.fn.baTable=u,k.fn.baTable.Constructor=a,w.plugins.Table=a,k.fn.closestBaTableEl=function(){return this.closest(".ba-table")},k.fn.findBaTableEl=function(){return this.find(".ba-table")},k.fn.closestBaTable=function(e){return _.pluginCall(a,"baTable",this.closestBaTableEl(),e,arguments)},k.fn.findBaTable=function(e){return _.pluginCall(a,"baTable",this.findBaTableEl(),e,arguments)},k.fn.elInBaTable=function(e){if(e=void 0===e||e,!this.closestBaTableEl().length)return!1;if(e){e=this.closest(".fixed-table-body").parent();return!e.hasClass("fixed-columns")&&!e.hasClass("fixed-columns-right")}return!0},w.regSugar(C,function(e,t,a){var i=k(this),n=i.closestBaModal();if(n&&(i=n.$element,n._bindBaTable&&(i=n._bindBaTable.$element)),"reload"===e&&(e=""),e=e||"refresh",i.closestBaTableEl().length)i.closestBaTable(e,t);else{if(n)i=n.$container;else{if(!w.app.isInContent(i))return;i=w.app.$contentBody}i.findBaTable(e,t)}}),w.autoInit(C,_.pluginAttrs(C),function(){u.call(this)}),a}),define("./ba/plug/tabs",["busyAdmin","jquery"],function(p,f){var h=p.helper,m=p.e,g="tabs",v=f(window),d=["show","hide","shown","hidden"];d.map(function(e){m[h.camel("tabs_"+e)]=p.ee(e,g)}),m.tabsBeforeRemove=p.ee("before-remove",g),m.tabsRemoved=p.ee("removed",g),m.tabsBeforeClear=p.ee("before-clear",g),m.tabsCleared=p.ee("cleared",g),m.tabsAdded=p.ee("added",g);var b=function e(t,a){return t+"."+u.KEY+"-"+a.index},u=function e(t,a){var i=this,n,r;i.index=e.INDEX++;i.resizeEvent=b("resize",i);i.element=t;n=i.$element=f(t).removeClass("nav-justified");r=i.options=f.extend(true,{},e.DEFAULTS,n.baData(g)||{},a||{});i.$content=r.content?f(r.content).addClass("tab-content"):i.$element.next(".tab-content");i.tabs=[];var o=!f.baIsEmpty(r.active)&&r.active!=="";var s=i.$content.find("> .tab-pane");n.find("> li > a").each(function(e){var t=f(this);var a=i._createTab(e,t.attr("data-name"),t,s.eq(e));if(a.err){t.parent().remove();s.eq(e).remove();return}if(t.parent().hasClass("active")&&!o){r.active=a;o=true}});if(!o&&i.tabs.length){o=true;r.active=i.tabs[0]}i.$container=f('<div class="ba-tabs dropdown ba-tabs--'+i.index+'">    <div class="ba--container">        <div class="ba--prev"><i class="fa fa-angle-left"></i></div>        <div class="ba--body"></div>        <div class="ba--toolbar">            <div class="ba--next"><i class="fa fa-angle-right"></i></div>            <div class="ba--more" data-toggle="dropdown" data-target=".ba-tabs--'+i.index+'"><i class="fa fa-angle-down"></i></div>            <div class="ba--clear"><i class="bicon bicon-close"></i></div>            <div class="ba--plus"><i class="bicon bicon-plus"></i></div>        </div>    </div>    <div class="dropdown-menu dropdown-menu-right"><div class="ba--menu-head"><ul><li><a>关闭所有标签</a></li></ul></div><ul class="ba--menu-list"></ul></div></div>').insertBefore(n);i.$prev=i.$container.find(".ba--prev");i.$next=i.$container.find(".ba--next");i.$plus=i.$container.find(".ba--plus");i.$clear=i.$container.find(".ba--clear");i.$toolbar=i.$container.find(".ba--toolbar");i.$more=i.$container.find(".ba--more");i.$menu=i.$container.find(".dropdown-menu");i.$menuHead=i.$menu.find(".ba--menu-head");i.$menuList=i.$menu.find(".ba--menu-list");i.$body=i.$container.find(".ba--body").html(n);i.$container.toggleClass("ba--addable",r.addable||r.editable);i.$container.toggleClass("ba--show-more",r.more);if(r.card){i.$card=i.$container.parent(".panel");i.isCard=!!i.$card.length;if(!i.isCard){i.$card=f('<div class="panel" />').insertBefore(i.$container);i.$card.append(i.$container);if(!r.content)i.$card.append(i.$content.addClass("panel-body"))}var l=r.card===true?"":"panel-"+r.card;var c=[];["default","primary","secondary","dark","light","success","warning","danger","info"].map(function(e){c.push("panel-"+e)});i.$card.removeClass(c).addClass(l);i.$card.toggleClass("ba--no-body",i.$card.find("> .panel-body").length<1)}(n.attr("class")||"").split(" ").map(function(e){e=e.trim();if(e&&e!=="nav")i.$container.addClass("ba-tabs--"+e)});i.$plus.on("click",function(){var e=h.scope(i.options.add);if(typeof e==="function"){var t=e();if((typeof t==="undefined"?"undefined":_typeof(t))==="object"&&t!==null)i.add(t.name,t.label,t.pane,t.show)}else i.add(null,null,null,true)});i.$clear.on("click",function(){if(false!==h.execCallback(i,r.onBeforeClear,i.element,[i],n,m.tabsBeforeClear,true,false))i.clear()});i.$menuHead.find("a").on("click",function(){i.$clear.trigger("click")});i.$container.on("shown.bs.dropdown",function(){var e=i.$menuList;e.animate({scrollTop:e.find("li.active").position().top+e.position().top+e.scrollTop()},0)});i.$body.on("scroll",f.proxy(i.onScroll,i));i.$prev.on("click",f.proxy(i.prev,i));i.$next.on("click",f.proxy(i.next,i));v.off(i.resizeEvent).on(i.resizeEvent,f.proxy(i.update,i));var d=f.proxy(i.destroy,i);f(document).one(m.appRenderBefore,d);var u=i.$element.closestBaModal();if(u)u.$element.one(p.e.modalHide,d);i.show(r.active)};function e(e){return h.pluginFn(this,u,e,arguments)}return u.prototype={getTab:function(e){if(e instanceof jQuery)return e.data(u.KEY+"-item");if("object"===(void 0===e?"undefined":_typeof(e))&&null!==e)return e;e+="";for(var t=0;t<this.tabs.length;t++){var a=this.tabs[t];if(a.name===e)return a}return null},_createTab:function(e,t,a,i){var n,r,o=this,s=o.options,l="ba--tabs-pane-"+o.index+"-"+e;if(a=a||f("<a />"),!f.baIsEmpty(t)&&""!==(t+"").trim()||(t=e),n=o.getTab(t)){var c=h.scope(s.error);return c?c.call(o,n):console.error("选项卡已存在",n),n.err=!0,n}return a.attr("data-target","."+l).attr("data-name",t).attr("data-index",e),s.html||(i=i||f('<div class="tab-pane"/>'),a.attr("data-toggle","tab"),i.toggleClass("fade",s.fade).addClass(l),(s.closable||s.editable)&&(a.addClass("ba--closable").append('<span class="bicon bicon-close ba--close" data-close="tab"></span>'),a.find(".bicon-close").on("click",function(){return!1!==h.execCallback(o,s.onBeforeRemove,o.element,[o,t],o.$element,m.tabsBeforeRemove,!0,!1)&&o.remove(t),!1})),r=[],d.map(function(e){r.push(b(e+".bs.tab",o)+"."+l)}),a.on(r.join(" "),function(e){var t=f(e.target),a=f(e.relatedTarget);"show"===e.type&&(o.active=n,o.update()),h.execCallback(o,s[h.camel("on_"+e.type)],o.element,[o,t,a],o.$element,m[h.camel("tabs_"+e.type)])})),o.tabs.push(n={index:e,name:t+"",$tab:a,$pane:i,target:"."+l}),a.data(u.KEY+"-item",n),n},add:function(e,t,a,i){var n=this,r=n.tabs.length,e=n._createTab(r,e);e.err||(n.$element.append(f("<li />").append(e.$tab.prepend(f.baIsEmpty(t)?"选项卡"+r:t))),e.$pane&&n.$content.append(e.$pane.html(a)),h.execCallback(n,n.options.onAdded,n.element,[n,e.name],n.$element,m.tabsAdded),i?n.show(e):n.update())},remove:function(e){this._remove(e),h.execCallback(this,this.options.onRemoved,this.element,[this,e],this.$element,m.tabsRemoved)},_remove:function(e){var t,a,i,n=this.getTab(e);n&&(a=(t=n.$tab.parent()).parent(),i=t.prev(),e=t.next(),n.$pane&&n.$pane.remove(),t.remove(),a.children().length<=0&&(this.tabs=[]),this.isActive(n)?i.length?this.show(i.find("> a").data(u.KEY+"-item")):e.length?this.show(e.find("> a").data(u.KEY+"-item")):this.update():this.update())},clear:function(){var t=this;t.tabs.map(function(e){t._remove(e)}),h.execCallback(t,t.options.onCleared,t.element,[t],t.$element,m.tabsCleared)},isActive:function(e){e=this.getTab(e);return!!e&&e.$tab.parent().hasClass("active")},show:function(e){e=this.getTab(e);if(e){if(this.options.html)return this.active=e,void this.update();e.$tab.parent().removeClass("active"),e.$tab.tab("show")}},update:function(){var a=this,i=a.options;a.tabWidth=a.$element.outerWidth(!0),a.bodyWidth=a.$body.width();var e=a.tabWidth>a.bodyWidth;a.$container.toggleClass("ba--clearable",i.clearable&&0<a.tabs.length),a.$element.toggleClass("ba--scrollable",e),a.$container.toggleClass("ba--scrollable",e),a.onScroll(),e?(e=i.html,a.frist||(e=a.frist=!0),a.scrollTo(a.active,e)):a._scroll(0,!0);var n=a.getTab(a.active);a.$menuList.html(a.$element.children().clone().removeClass("active").each(function(){var e=f(this),t=e.find("> a[data-target]").removeAttr("data-toggle");n&&n.target==t.data("target")&&e.addClass("active"),i.html||(t.on("click",function(e){e.preventDefault(),a.show(f(this).data("name"))}),t.find('> span[data-close="tab"]').on("click",function(e){e.preventDefault(),a.$element.find('a[data-target="'+f(this).parent().data("target")+'"]').find('> span[data-close="tab"]').trigger("click")}))}))},prev:function(){this._scroll(this.$body.scrollLeft()-this.bodyWidth)},next:function(){this._scroll(this.$body.scrollLeft()+this.bodyWidth)},_scroll:function(e,t){!0===t?this.$body.scrollLeft(e):this.$body.stop().animate({scrollLeft:e})},onScroll:function(){var e=this.$body.scrollLeft(),t=e<=0;this.$prev.toggleClass("disabled",t).attr("disabled",function(){return t?"disabled":null});var a=e+this.$body[0].clientWidth>=this.$body[0].scrollWidth;this.$toolbar.toggleClass("ba--end",a),this.$next.toggleClass("disabled",a).attr("disabled",function(){return a?"disabled":null})},scrollTo:function(e,t){var a=this.getTab(e);a&&(a=(e=a.$tab.parent()).position().left,e=e.outerWidth(!0),this._scroll(a-this.bodyWidth/2+e/2,t))},destroy:function(){var t=this;v.off(t.resizeEvent),t.tabs.map(function(e){e.$tab.off(b("",t))}),t.$element.removeClass("ba--scrollable"),!t.isCard&&t.options.card?(t.$element.insertBefore(t.$card),t.$content.removeClass("panel-body").insertAfter(t.$element),t.$card.remove()):(t.$element.insertBefore(t.$container),t.$container.remove())}},u.INDEX=0,u.KEY=h.pluginKey(g),u.DEFAULTS={fade:!0,active:null,closable:!1,addable:!1,editable:!1,clearable:!1,more:!0,card:!1,content:null,html:!1},f.fn.baTabs=e,f.fn.baTabs.Constructor=u,p.plugins.Tabs=u,p.autoInit(g,h.pluginAttrs(g),function(){e.call(this)}),u}),define("./ba/plug/template",["busyAdmin","jquery"],function(i,r){var o,n=i.helper,s="template",l=function e(t){if(o)t();else requirejs([i.lib.artTemplate],function(e){o=e;n.initArt(o);t()})},a=function e(t,a,i,n){if(i===true||n===true){i=i===true?{}:i||{};if(!o)throw"ArtTemplate is not define";return o.render(t,a||{},i)}if(typeof i==="function"){n=i;i={}}if(typeof n!=="function")n=r.noop;l(function(){n(o.render(t,a||{},i))})},t=function e(t,a){var i=this;i.element=t;i.$element=r(t);i.options=r.extend(true,{},e.DEFAULTS,i.$element.baData(s)||{},a||{});i.$template=i.options.template?r(i.options.template):i.$element;i.tmpl=i.$template.html();i.init()};function e(e){return n.pluginFn(this,t,e,arguments)}return t.prototype={init:function(){var t=this,a=t.options.onDone;t.options.onDone=function(e){n.execCallback(t,a,t.element,[e],t.$element,i.e.templateDone),t.first||(t.first=!0,n.triggerPluginReady(t.$element,t,"",i.e.templateInitialized))},t.apply()},apply:function(e){var t=this;e=e||("function"==typeof(e=n.scope(t.options.data))?e():t.options.data),a(t.tmpl,e||{},t.options,function(e){t.options.onDone(e),t.$element.html(e)})}},t.KEY=n.pluginKey(s),t.DEFAULTS={data:{},template:null,onDone:null},t.render=a,t.ready=l,r.fn.baTemplate=e,r.fn.baTemplate.Constructor=t,i.plugins.Template=t,i.e.templateDone=i.ee("done",s),i.e.templateInitialized=i.ee("initialized",s),i.autoInit(s,n.pluginAttrs(s),function(){e.call(this)}),t}),define("./ba/plug/appNotice",["busyAdmin","jquery"],function(r,n){var e,i=false,o={"Busy-Admin-Plugin":"AppMessage"};r.e.topBarInitialized=r.ee("initialized","top-bar");var t=function e(){var t=this;t.app=r.app;t.url=r.getConfig("topBar").url;t.root=r.root();t.messageTimer=null;t.messageLoading=false;t.init()};t.prototype={init:function e(){var t=this;var a=t.app.data||{};if(a.message_notice){t.$noticeLi=n('<li><a href="javascript:void(0)"><i class="bicon bicon-bell"></i><span class="badge badge-danger badge-pill hide">0</span></a></li>');t.$noticeA=t.$noticeLi.find("a");t.$noticeBadge=t.$noticeLi.find(".badge");t.app.$barRefreshWrap.after(t.$noticeLi);t._initNotice()}if(a.message_todo){t.$todoLi=n('<li><a href="javascript:void(0)"><i class="bicon bicon-wait-handle"></i><span class="badge badge-danger badge-pill hide">0</span></a></li>');t.$todoA=t.$todoLi.find("a");t.$todoBadge=t.$todoLi.find(".badge");(a.message_notice?t.$noticeLi:t.app.$barRefreshWrap).after(t.$todoLi);t._initTodo()}if(a.message_notice||a.message_todo)t.messageTimer=setTimeout(function(){t.refreshUnread()},1e3);r.helper.triggerPluginReady(t.app.$barRefreshWrap,t,"",r.e.topBarInitialized);i=true},_initNotice:function e(){var i=this;i.$noticeA.on("click",function(){i.$noticeLi.addClass("active");i.dialogPage=r.dialog.fullRight(t.NOTICE_TEMPLATE,"ba-notice-panel",function(){r.require([r.lib.vue],function(e){i.vueApp=new e({el:"#busyAdminNoticeVueApp",data:{list:[],body:null,page:1,timer:null,showLast:false,load:false},created:function e(){this.loadList()},methods:{loadList:function e(){var a=this;if(a.load)return;a.load=true;r.request(i.url+"?action=list&type=notice&page="+this.page).headers(o).pending(false).complete(function(){a.load=false}).success(function(e){var t=e.result.list||[];t.map(function(e){e.url=e.url||"javascript:void(0)";e.target=0===e.url.indexOf(i.root)?"":"_blank"});if(t.length>0){a.page++;a.list=a.list.concat(t);a.showLast=false}else if(a.list.length>0)a.showLast=true;return false}).exec()},onScroll:function e(){var t=this;if(this.body==null)this.body=n(this.$el).find(".ba-right-panel-body");if(this.body.scrollTop()+this.body[0].offsetHeight>=this.body[0].scrollHeight){clearTimeout(this.timer);this.timer=setTimeout(function(){t.loadList()},300)}},onClear:function e(){var t=this;r.request(i.url+"?action=clear&type=notice").headers(o).success(function(){t.list=[];i.refreshUnread()}).exec()},onAllRead:function e(){var t=this;r.request(i.url+"?action=all_read&type=notice").headers(o).success(function(){t.list.map(function(e){e.read=true});i.refreshUnread()}).exec()},onItemClick:function e(t){var a=this.list[t];if(!a.read){r.request(i.url+"?action=read&type=notice&id="+a.id).pending(false).headers(o).success(function(){i.refreshUnread();return false}).exec();this.list[t].read=true}},onClose:function e(){i.close()}}})})},function(){i.$noticeLi.removeClass("active")})})},_initTodo:function e(){var i=this;i.$todoA.on("click",function(){i.$todoLi.addClass("active");i.dialogPage=r.dialog.fullRight(t.TODO_TEMPLATE,"ba-todo-panel",function(){r.require([r.lib.vue],function(e){i.vueApp=new e({el:"#busyAdminTodoVueApp",data:{list:[],load:false},created:function e(){this.loadList()},methods:{loadList:function e(){var a=this;if(a.load)return;a.load=true;r.request(i.url+"?action=list&type=todo").headers(o).pending(false).complete(function(){a.load=false}).success(function(e){var t=e.result.list||[];t.map(function(e){e.url=e.url||"javascript:void(0)"});a.list=t;return false}).exec()},onItemClick:function e(t){var a=this.list[t];r.request(i.url+"?action=read&type=todo&id="+a.id).headers(o).pending(false).success(function(){i.refreshUnread();return false}).exec()},onClose:function e(){i.close()}}})})},function(){i.$todoLi.removeClass("active")})})},refreshUnread:function e(){var n=this;clearTimeout(n.messageTimer);if(n.messageLoading)return;n.messageLoading=true;n.request=r.request(n.url).headers(o).pending(false).complete(function(){n.messageLoading=false;n.messageTimer=setTimeout(function(){n.refreshUnread()},1e3*10)}).error(function(e,t,a){if(n.isAbort)return false}).success(function(e){var t=e.result||{};var a=t.notice_total||0;var i=t.todo_total||0;if(n.$todoBadge)if(i>0)n.$todoBadge.removeClass("hide").text(i>=100?"99+":i);else n.$todoBadge.addClass("hide");if(n.$noticeBadge)if(a>0)n.$noticeBadge.removeClass("hide").text(a>=100?"99+":a);else n.$noticeBadge.addClass("hide");return false}).exec()},refreshList:function e(){if(!this.vueApp)return;this.vueApp.loadList()},close:function e(){var t=this;if(t.dialogPage){t.dialogPage.close();t.dialogPage=null}},destroy:function e(){var t=this;clearTimeout(t.messageTimer);if(t.request){t.isAbort=true;t.request.abort();t.request=null}t.close()}},t.NOTICE_TEMPLATE='<div class="ba-right-panel" id="busyAdminNoticeVueApp">    <div class="ba-right-panel-head">通知</div>    <div class="ba-right-panel-body" v-on:scroll="onScroll">        <template v-if="list.length > 0">            <a class="media" v-for="(item, index) in list" :class="item.read ? \'read\' : \'\'" :data-index="index" @click="onItemClick(index)" :href="item.url" v-bind="item.attrs">                <div class="media-left" v-if="item.icon.length > 0">                    <i class="media-object icon" :class="item.icon" :style="{backgroundColor: item.icon_color}" v-if="-1 === item.icon.indexOf(\'/\')"></i>                    <img class="media-object" :src="item.icon" v-else>                </div>                <div class="media-body">                    <h5 class="media-heading">                        <span v-if="!item.read"></span>                        {{item.title}}                    </h5>                    <p class="text-muted size-14" v-if="item.desc.length > 0">{{item.desc}}</p>                    <p class="text-gray size-12">{{item.create_time}}</p>                </div>            </a>            <div class="media text-muted text-center size-12" v-if="showLast">没有消息了</div>        </template>        <template v-else>            <div class="empty-info" v-if="load">                <i class="fa fa-spinner fa-spin size-30"></i><br/><br/>加载中...            </div>            <div class="empty-info" v-else>暂无通知</div>        </template>    </div>    <div class="ba-right-panel-foot">        <div class="btn-group">            <a class="btn btn-warning" @click="onAllRead"><i class="fa fa-trash"></i> 全部已读</a>            <a class="btn btn-danger" @click="onClear"><i class="fa fa-trash"></i> 清空</a>            <a class="btn btn-default" @click="onClose"><i class="fa fa-close"></i> 关闭</a>        </div>    </div></div>',t.TODO_TEMPLATE='<div class="ba-right-panel" id="busyAdminTodoVueApp">    <div class="ba-right-panel-head">待办</div>    <div class="ba-right-panel-body">        <template v-if="list.length > 0">            <a class="media" v-for="(vo, index) in list" :href="vo.url" :data-index="index" @click="onItemClick(index)" v-bind="vo.attrs">                <div class="media-body">                    <h5 class="media-heading text-bold">                        <span class="badge badge-pill badge-danger" v-if="vo.total > 0">{{vo.total}}</span>                        {{vo.title}}                        <span class="badge badge-outline" :class="\'badge-outline-\' + vo.level_style" v-if="vo.level_name.length > 0">{{vo.level_name}}</span>                    </h5>                    <p class="text-muted size-14" v-if="vo.desc.length > 0">{{vo.desc}}</p>                </div>            </a>        </template>        <template v-else>            <div class="empty-info" v-if="load">                <i class="fa fa-spinner fa-spin size-30"></i><br/><br/>加载中...            </div>            <div class="empty-info" v-else>暂无待办</div>        </template>    </div>    <div class="ba-right-panel-foot">        <a class="btn btn-default btn-block" @click="onClose"><i class="fa fa-close"></i> 关闭</a>    </div></div>',n(document).on(r.e.appReadies,function(){if(!r.app.isFrame){i=false;if(r.app._topBar){r.app._topBar.destroy();r.app._topBar=null}return}if(i)return;r.app._topBar=new t})}),define("./ba/plug/tree",["busyAdmin","jquery"],function(p,f){"use strict";var o="init,loading,loaded,ready,destroy,set_state,refresh,load_node,load_all,redraw,model,before_open,open_node,after_open,close_node,after_close,open_all,close_all,enable_node,disable_node,hide_node,show_node,hide_all,show_all,activate_node,hover_node,dehover_node,select_node,deselect_node,changed,select_all,deselect_all,refresh_node,set_id,set_text,create_node,rename_node,delete_node,move_node,copy_node,cut,copy,paste,clear_buffer,disable_checkbox,enable_checkbox,check_node,uncheck_node,check_all,uncheck_all".split(","),h=p.helper,s=p.ee,d=p.e,u="tree",m=h.pluginKey(u);d.treeInitialized=s("initialized",u),d.treeOperate=s("operate",u),f.map(o,function(e){d[h.camel("tree_"+e)]=s(e,u)});var a=false,i=function e(){if(a)return;a=true;var u=h.extends(f.jstree.core.prototype,{redraw_node:function e(t,a,i,n){var r=this;var o=h.override(u,"redraw_node",r,arguments);if(!o)return false;var s=r.settings.core;if(!s._nodeExtend)return o;var l=f(o);var c=r.get_node(t);var d="";c.group=c.children&&c.children.length>0;if(typeof s._nodeExtend==="function")d=s._nodeExtend.call(r,c);else d=p.plugins.Template.render(""+s._nodeExtend,c,true);l.find("> .jstree-anchor").append('<span class="ba--custom">'+d+"</span>");return o}})},t=function e(t,a){var s=this;s.index=e.INDEX++;s.element=t;s.$element=f(t);s._$element=s.$element.clone(true,true);s.options=f.extend(true,{},e.DEFAULTS,s.$element.baData(u)||{},a||{});s.$container=f('<div class="ba-tree"/>');s.$container.insertAfter(s.$element).append(s.$element);var l=s.options;var i=s.$element.find("select");s.$selectMain=s.$element.find('select[data-template="main"]');s.$selectUncertain=s.$element.find('select[data-template="uncertain"]');if(!s.$selectMain.length&&i.length>0)s.$selectMain=i.eq(0);if(!s.$selectUncertain.length&&i.length>1)s.$selectUncertain=i.eq(1);if(!s.$selectMain.length)s.$selectMain=f("<select />");if(!s.$selectUncertain.length)s.$selectUncertain=f("<select />");if(!l.name)l.name=s.$selectMain.attr("name")||"";if(!l.uncertainName)l.uncertainName=s.$selectUncertain.attr("name")||"";s.$selectMain.addClass("input-hidden").attr("multiple","multiple").attr("name",function(){if(l.name)return l.name.indexOf("[]")>0?l.name:l.name+"[]";return null});s.$selectUncertain.addClass("input-hidden").attr("multiple","multiple").attr("name",function(){if(l.uncertainName)return l.uncertainName.indexOf("[]")>0?l.uncertainName:l.uncertainName+"[]";return null});s.defaultValue=[];s.resetEvent="reset."+m+s.index;s.$form=s.$element.closest("form");s.$form.on(s.resetEvent,function(){if(!s.api||!s.defaultValue)return;s.api.uncheck_all();if(s.defaultValue.length)s.api.check_node(s.defaultValue)});var n=h.scope(l.nodeExtend);if(typeof n==="string"&&0===n.indexOf("@"))n=s.$element.find('[data-template="node-extend"]').html();s.api=null;s.jstreeOpt={core:{_nodeExtend:n,animation:l.animation,multiple:l.multiple,expand_selected_onload:l.expandSelectedOnload,force_text:l.forceText,dblclick_toggle:false,check_callback:function e(t,a,i,n,r){if(f.isArray(l.operate))return-1!==(l.onOperate||[]).indexOf(t);var o=Array.prototype.slice.call(arguments);o.unshift(s);return h.execCallback(s,l.operate,s.element,o,s.$element,d.treeOperate,true,"boolean",true)},themes:{dots:l.dots,icons:l.icons,ellipsis:l.ellipsis,stripes:l.stripes},strings:{"Loading ...":l.locale.loading,"New node":l.locale.newNode,nodes:l.locale.nodes}},types:{default:{}},plugins:["types"]};if(l.leafTile)s.$element.addClass("leaf-tile");if(l.border)s.$element.addClass("show-border");var r=s.jstreeOpt;if(l.checkbox){r.plugins.push("checkbox");r.checkbox={keep_selected_style:l.checkboxKeepSelectedStyle,tie_selection:l.checkboxTieSelection,three_state:l.checkboxRelation,cascade:l.checkboxRelationDir,cascade_to_disabled:l.checkboxRelationDisabled,cascade_to_hidden:l.checkboxRelationHidden}}if(l.block)r.plugins.push("wholerow");if(l.dnd)r.plugins.push("dnd");if(l.contextmenu){var o=h.scope(l.contextmenuItems);r.plugins.push("contextmenu");r.contextmenu={items:function e(t){p.dialog.toast("没有配置右键菜单项");return{}}};if(typeof o==="function")r.contextmenu.items=o;else r.contextmenu.items=o||{}}if(l.url||l.model)r.core.data=function(e,i){var n=this;var t={model:l.model,extend:l.modelExtend?1:0,id_field:l.modelIdField||"",parent_field:l.modelParentField||"",name_field:l.modelNameField||"",icon_field:l.modelIconField||"",disabled_field:l.modelDisabledField||"",async_node:l.asyncNode?1:0,async_parent_id:e.id==="#"?"":e.id,order:l.modelOrder||""};var a=h.scope(l.params);if(typeof a==="function")a=a.call(s,t);t=f.extend(true,{},a||{},t);s._abort();s.task=p.request(l.model?p.getConfig("tree").url:l.url).method(l.method).addHeader("Busy-Admin-Plugin","Tree").pending(false).params(t).error(function(e,t,a){i.call(n,[])}).success(function(e,t,a){i.call(n,e.result.data);return false}).exec()};else if(l.data){var c=h.scope(l.data);if(typeof c==="function")c=c();r.core.data=c||[]}s.formStatus=s.$element.baFormStatus(s).render();s.ready(s._init)};function e(e){return h.pluginFn(this,t,e,arguments,["api",function(e){return{name:"api",method:h.snake(e)}}])}return t.prototype={ready:function(e){var t=this;a?e.call(t):requirejs([p.lib.tree],function(){p.plugins.Template.ready(function(){i(),e.call(t)})})},_abort:function(){this.task&&(this.task.abort(),this.task=null)},_init:function(){var i=this,n=i.$element,r=i.options,e=f.proxy(i.destroy,i);f(document).one(d.appRenderBefore,e);var t=n.closestBaModal();t&&t.$element.one(d.modalHided,e),n.find("[disabled],[data-disabled],[data-icon],[data-opened],[data-selected],[data-jstree]").each(function(){var e=f(this),t=e.data();e.removeData(),this.hasAttribute("disabled")&&(t.disabled=!0),t.hasOwnProperty("jstree")&&"object"===_typeof(t.jstree)&&delete(t=f.extend(t.jstree,t)).jstree,e.data("jstree",t)});var a=[];o.map(function(e){a.push(e+".jstree")}),n.on(a.join(" "),function(e,t){var a=e.type,e=Array.prototype.slice.call(arguments);e.shift(),!i.api&&t&&t.instance&&(i.api=t.instance),e.unshift(i),-1<["ready","refresh","delete_node","create_node"].indexOf(a)&&(t=i.api.get_json()||[],i.$empty&&i.$empty.remove(),0==t.length&&(i.$empty=f('<div class="ba-tree-empty">'+r.emptyText+"</div>"),n.append(i.$empty))),-1<["after_open","after_close","ready"].indexOf(a)&&p.app.triggerResize(),-1<["ready","changed"].indexOf(a)&&(i.$selectMain.empty(),i.api.get_checked().map(function(e){i.$selectMain.append('<option value="'+e+'" selected/>')}),i.$selectMain.baTriggerEvent("change"),i.$selectUncertain.empty(),i.api.get_undetermined().map(function(e){i.$selectUncertain.append('<option value="'+e+'" selected/>')}),i.$selectUncertain.baTriggerEvent("change")),"ready"===a&&(r.checkbox&&i.$container.append(i.$selectMain).append(i.$selectUncertain),i.defaultValue=i.api.get_checked(),i.formStatus.rendered()),h.execCallback(i,r[h.camel("on_"+a)],i.element,e,n,s(a,u))}),n.jstree(i.jstreeOpt),i.api=n.jstree(!0),h.triggerPluginReady(n,i,"",d.treeInitialized),i.$selectMain.on(d.validateErrorPlacement,function(e,t){return i.$element.after(t),!1}),i.$selectUncertain.on(d.validateErrorPlacement,function(e,t){return i.$element.after(t),!1})},destroy:function(){var e=this;e._abort(),e.api&&(e.api.destroy(),e.api=null),e._$element.insertBefore(e.$container),e.$container.remove(),e.$form.off(e.resetEvent),e.$selectMain.off(d.validateErrorPlacement),e.$selectUncertain.off(d.validateErrorPlacement)}},t.KEY=m,t.INDEX=0,t.DEFAULTS={dots:!0,icons:!0,ellipsis:!1,stripes:!1,onOperate:!1,animation:200,multiple:!0,expandSelectedOnload:!1,forceText:!1,leafTile:!1,border:!0,url:null,method:"get",params:null,emptyText:"无选项",model:"",modelExtend:!1,modelIdField:"",modelNameField:"",modelDisabledField:"",modelIconField:"",modelParentField:"",asyncNode:!1,modelOrder:"",data:null,name:null,uncertainName:null,checkbox:!1,checkboxKeepSelectedStyle:!1,checkboxTieSelection:!0,checkboxRelation:!0,checkboxRelationDir:"",checkboxRelationDisabled:!0,checkboxRelationHidden:!0,block:!1,contextmenu:!1,contextmenuItems:null,nodeExtend:null,locale:f.extend({},{loading:"请稍后...",newNode:"未命名",nodes:"节点"},((p.locale||{}).plugin||{}).tree||{})},f.fn.baTree=e,f.fn.baTree.Constructor=t,p.plugins.Tree=t,p.autoInit(u,h.pluginAttrs(u),function(){e.call(this)}),t}),define("./ba/plug/upload",["busyAdmin","jquery"],function(C,_){var S={},E=null,f=null,d=null,s=false,T=undefined,D=C.helper,e=C.ee,u=C.e,I="upload",l=D.pluginKey(I),h=function e(t,a){return t.find('[data-upload-id="'+a+'"]')},A=function e(){C.app.triggerResize()},m=function e(t,a){var i=this;i.element=t;i.$element=_(t);i.options=_.extend(true,{},e.DEFAULTS,i.$element.baData(I),a||{});i.uploader=null;i.category={};i.headers={};i.$uploadBtn=null;i.$selectBtn=null;i.module=null;i.isInput=i.$element.is(":input");i.options.disabled=i.$element.prop("disabled")||i.options.disabled;i.callback={responseSuccess:_.noop};i.formStatus=i.$element.baFormStatus(i).render();i.ready(i.init)};m.prototype={ready:function e(r){var o=this;var t=C.lib;requirejs([t.bootstrap,t.webUploader,t.sortable,t.uploadConfig,t.sparkMd5],function(e,t,a,i,n){if(s){r.call(o);return}s=true;E=t;f=a;d=n;S=i;S.disks=S.disks||{};E.Uploader.register({init:"init","before-send-file":"beforeSendFile","before-send":"beforeSend","after-send-file":"afterSendFile"},{init:function e(t){var a=t._busy;if(!a)return;if(a.use)return D.execCallback(a.me,a.asyncInit,a.el[0],[this.owner,t],a.el,u.uploadAsyncInit,null);var i=S.disks[a.disk].asyncInit;if(typeof i==="function")return i.call(this,t)},beforeSendFile:function e(n){var r=this;var i=r.options;var o=i._busy;if(!o)return;if(o.use)return D.execCallback(o.me,o.asyncBeforeSendFile,o.el[0],[this.owner,n],o.el,u.uploadAsyncBeforeSendFile,null);n.doneParts=[];var s=E.Deferred();var l=r.owner;var t=function e(){var t=i.chunkSize;var a=t?Math.ceil(n.source.size/t):1;m.md5File(n.source.source,t).progress(function(e){l.trigger("uploadProgress",n,.049*e,"hash")}).done(function(e){C.request(S.prepare).method("post").pending(false).params({md5:e,mimetype:n.type||"",filesize:n.size,filename:n.name,class_type:o.classType,class_value:o.classValue,part:a>1?1:0,disk:o.disk}).success(function(e){var t=e.result;n.prepareResult=t;if(t.fast){l.skipFile(n);l.trigger("uploadProgress",n,1)}else{var a=S.disks[o.disk].asyncBeforeSendFile;if(typeof a==="function"){var i=a.call(r,n,t);if(E.isPromise(i)){i.done(function(){l.trigger("uploadProgress",n,.05,"hash");s.resolve()}).fail(function(e){s.reject(e)});return false}}l.trigger("uploadProgress",n,.05,"hash")}s.resolve();return false}).error(function(e){s.reject(e.message);return false}).exec()}).fail(function(e){s.reject("Hash error")})};if(i.compress)l.waitCompressTimeId=setInterval(function(){if(n._compressed){clearInterval(l.waitCompressTimeId);t()}},10);else t();return s.promise()},beforeSend:function e(t){var a=this.options;var i=a._busy;if(!i)return;if(i.use)return D.execCallback(i.me,i.asyncBeforeSend,i.el[0],[this.owner,t],i.el,u.uploadAsyncBeforeSend,null);var n=S.disks[i.disk].asyncBeforeSend;if(typeof n==="function")return n.call(this,t)},afterSendFile:function e(t,a){var i=this.options;var n=i._busy;if(!n)return;if(n.use)return D.execCallback(n.me,n.asyncAfterSendFile,n.el[0],[this.owner,t,a],n.el,u.uploadAsyncAfterSendFile,null);var r=E.Deferred();var o=function e(t){r.reject(t)};var s=function e(t){r.resolve(t)};var l=function e(){if(t.prepareResult&&!t.prepareResult.fast)C.request(S.done).method("post").pending(false).params({file_id:t.prepareResult.file_id,upload_id:t.prepareResult.upload_id,parts:JSON.stringify(t.doneParts||[])}).success(function(){s();return false}).error(function(e){o(e.message);return false}).exec();else s()};var c=S.disks[n.disk].asyncAfterSendFile;if(typeof c==="function"){var d=c.call(this,t,a);if(E.isPromise(d)){d.done(l).fail(o);return r.promise()}}l();return r.promise()}});r.call(o)})},init:function e(){var t=this;var a=t.options;t.category=S.category[a.classType]||null;t.category=t.category||S.category[""]||{};if(!a.title){a.title=t.$element.attr("title");if(!a.title)a.title=t.category.name||t.options.locale.file}if(_.baIsEmpty(a.allowExtensions))a.allowExtensions=(t.category.allow_extensions||[]).join(",");else t.useExtensions=true;if(_.baIsEmpty(a.allowMimetypes))a.allowMimetypes=(t.category.allow_mimetypes||[]).join(",");else t.useMimetypes=true;if(!_.isNumeric(a.maxSingleSize))a.maxSingleSize=_.isNumeric(t.category.max_size)?t.category.max_size:2*1024*1024;else t.useMaxSingleSize=true;if(!a.placeholder)a.placeholder=D.sprintf(a.locale.pleaseUploadOrSelect,a.title);if(!a.objectFit)a.objectFit="cover";if(t.isInput){var i=t.$element.val();var n=t.$element.attr("name");var r=t.$element.attr("placeholder");if(i)a.value=i;if(n)a.name=n;if(r)a.placeholder=r}else{a.value=D.scope(a.value);if(typeof a.value==="function")a.value=a.value()}switch(a.type.toLowerCase()){case"files":t.module=new c(t);break;case"card":t.module=new p(t);break;case"use":t.module=new g(t);break;default:t.module=new o(t)}D.triggerPluginReady(t.$element,t,"",u.uploadInitialized)},_initUploader:function e(t,a,i,n){var l=this;var c=l.$element;var d=c[0];var u=l.options;var r=u.pasteContainer;var p=C.e;var f=D;if(typeof r==="string")r=_(r);if(r instanceof jQuery)if(r.length>0)r=r[0];else u.paste=false;l.multiple=n;l.$uploadBtn=t;l.$selectBtn=i;l.$uploadIcon=_("<i icon/>");l.$uploadName=_("<span text/>");u.uploadName=u.uploadName||f.sprintf(u.locale.uploadFile,u.title);l._updateUploadBtn();l.$selectIcon=_("<i icon/>");l.$selectName=_("<span text/>");u.selectName=u.selectName||f.sprintf(u.locale.selectFile,u.title);l._updateSelectBtn();var o=S.url;var s="POST";var h=false;var m=false;var g=I;var v=u.server!==true;var b={};var y={};var $=true;var x=u.classType||"";var w=u.classValue||"";var k=u.disk||S.disk;if(v){b=D.scope(u.params||{});if(typeof b==="function")b=b();y=D.scope(u.headers||{});if(typeof y==="function")y=y();s=u.method||"POST";h=u.binary||false;m=u.credential||false;g=u.fileVal||"file";b=b||{};y=y||{};$=u.chunked||false;if(u.server===false){b["class_type"]=x;b["class_value"]=w;b["disk"]=k;y["Busy-Admin-Plugin"]="Upload";g=I}else o=u.server}l.uploader=new E.Uploader({server:o,auto:u.auto,fileVal:g,method:s,runtimeOrder:"html5",sendAsBinary:h,withCredentials:m,dnd:u.dnd&&a&&a.length>0?a[0]:T,paste:u.paste?r:T,disableGlobalDnd:true,chunked:$,chunkSize:u.chunkSize,threads:u.threads,duplicate:u.duplicate,fileNumLimit:u.maxTotal||T,fileSizeLimit:u.maxSize||T,fileSingleSizeLimit:u.maxSingleSize,compress:u.compress?{width:u.compressWidth,height:u.compressHeight,quality:u.compressQuality,allowMagnify:u.compressZoom,crop:u.compressCrop,preserveHeaders:u.compressMeta,noCompressIfLarger:u.compressLarger,compressSize:u.compressSize}:false,pick:{id:t[0],multiple:n},formData:b,headers:y,accept:{title:f.sprintf(u.locale.selectFile,u.title),extensions:u.allowExtensions,mimeTypes:u.allowMimetypes},_busy:{me:l,use:v,el:c,disk:k,classType:x,classValue:w,asyncInit:u.asyncInit,asyncBeforeSendFile:u.asyncBeforeSendFile,asyncBeforeSend:u.asyncBeforeSend,asyncAfterSendFile:u.asyncAfterSendFile}});l.uploader.on("ready",function(){l.$uploadIcon=l.$uploadBtn.find("[icon]");l.$uploadName=l.$uploadBtn.find("[text]");l.formStatus.rendered();A();f.execCallback(l,u.ready,d,[this],c,p.uploadReady)}).on("uploadBeforeSend",function(e,t,a){["id","lastModifiedDate","name","size","type","chunk","chunks"].map(function(e){delete t[e]});if(v)f.execCallback(l,u.beforeSend,d,[this,e,t,a],c,p.uploadBeforeSend,null);else{var i=S.disks[k].syncBeforeSend;if(typeof i==="function")i.call(this,e,t,a)}e.file._requestHeaders=a;e.file._requestParams=t}).on("uploadAccept",function(e,a,t){var i=this.options;var n=function e(t){a._result=t};if(!v){var r=S.disks[k].syncUploadAccept;if(typeof r==="function")return r.call(this,e,a,n,t)!==false}else{var o=f.execCallback(l,u.resultAccept,d,[this,e,a,n,t],c,p.uploadAccept,null);if(typeof o==="boolean")return o}var s;C.response.parse(a._raw,{url:i.server,type:i.method,data:_.param(e.file._requestParams||{}),headers:e.file._requestHeaders||{}},function(e){s=true;n(e.result)},function(e){t(e.message);s=false});return s}).on("error",function(e,t,a){var i;if(t instanceof E.File)i=t;else if(a instanceof E.File)i=a;f.execCallback(l,u.fileError,d,[this,i,l._parseCodeError(e)],c,p.uploadFileError)}).on("fileQueued",function(e){f.execCallback(l,u.fileQueued,d,[this,e],c,p.uploadFileQueued)}).on("filesQueued",function(e){f.execCallback(l,u.filesQueued,d,[this,e],c,p.uploadFilesQueued)}).on("fileDequeued",function(e){f.execCallback(l,u.fileDequeued,d,[this,e],c,p.uploadFileDequeued)}).on("reset",function(){f.execCallback(l,u.reset,d,[this],c,p.uploadReset)}).on("startUpload",function(){u.bindForm&&l.formStatus.run();f.execCallback(l,u.begin,d,[this],c,p.uploadBegin)}).on("stopUpload",function(){f.execCallback(l,u.stop,d,[this],c,p.uploadStop)}).on("uploadFinished",function(){u.bindForm&&l.formStatus.ran();f.execCallback(l,u.finished,d,[this],c,p.uploadFinished)}).on("uploadStart",function(e){f.execCallback(l,u.start,d,[this,e],c,p.uploadStart)}).on("uploadProgress",function(e,t,a){if(a!=="hash")t=.05+t*.95;f.execCallback(l,u.progress,d,[this,e,t,a],c,p.uploadProgress)}).on("uploadComplete",function(e){f.execCallback(l,u.complete,d,[this,e],c,p.uploadComplete)}).on("uploadError",function(e,t){f.execCallback(l,u.error,d,[this,e,l._parseServerError(t)],c,p.uploadError)}).on("uploadSuccess",function(e,t){var a=e.prepareResult||t._result;f.execCallback(l,u.success,d,[this,e,a],c,p.uploadSuccess);l._triggerResult(a,true)})},_updateSelectBtn:function e(){var a=this;var t=this.options;if(!a.$selectBtn||!a.$selectBtn.length)return;if(!a.$selectBtn.data("init-click"))a.$selectBtn.data("init-click",true).off("click").on("click",function(){_(this).baFilePicker({classType:t.classType,classValue:t.classValue,title:D.sprintf(t.locale.selectFile,t.title),count:a.multiple?0:1,extensions:a.useExtensions?t.allowExtensions:T,mimetypes:a.useMimetypes?t.allowMimetypes:T,maxSize:a.useMaxSingleSize?t.maxSingleSize:T,success:function e(t){typeof a.module.setSelectFiles==="function"&&a.module.setSelectFiles(t)}})});if(t.type=="use")return;if(!a.$selectBtn.data("init-icon"))a.$selectBtn.data("init-icon",true).addClass(t.selectClass).append(a.$selectIcon).append(" ");if(!a.$selectBtn.data("init-name")&&t.type!=="card")a.$selectBtn.data("init-name",true).append(a.$selectName);if(t.select)a.$selectBtn.removeClass("hide").parent().removeClass("no-select");else a.$selectBtn.addClass("hide").parent().addClass("no-select");if(t.selectIcon)a.$selectIcon.removeAttr("class").addClass(t.selectIcon);else a.$selectIcon.addClass("hide");if(t.selectName)a.$selectName.removeAttr("class").html(t.selectName);else a.$selectName.addClass("hide")},_updateUploadBtn:function e(){var t=this;var a=this.options;if(a.type=="use"||!t.$uploadBtn||!t.$uploadBtn.length)return;if(!t.$uploadBtn.data("init-icon"))t.$uploadBtn.data("init-icon",true).addClass(t.options.uploadClass).append(t.$uploadIcon).append(" ");if(!t.$uploadBtn.data("init-name")&&a.type!=="card")t.$uploadBtn.data("init-name",true).append(t.$uploadName);if(a.upload)t.$uploadBtn.removeClass("hide").parent().removeClass("no-upload");else t.$uploadBtn.addClass("hide").parent().addClass("no-upload");if(a.uploadIcon)t.$uploadIcon.removeAttr("class").addClass(a.uploadIcon);else t.$uploadIcon.addClass("hide");if(a.uploadName)t.$uploadName.removeAttr("class").html(a.uploadName);else t.$uploadName.addClass("hide");if(t.uploader)t.uploader.refresh()},showUpload:function e(t){this.options.upload=t;this._updateUploadBtn()},setUploadName:function e(t){this.options.uploadName=t;this._updateUploadBtn()},setUploadIcon:function e(t){this.options.uploadIcon=t;this._updateUploadBtn()},showSelect:function e(t){this.options.select=t;this._updateSelectBtn()},setSelectName:function e(t){this.options.selectName=t;this._updateSelectBtn()},setSelectIcon:function e(t){this.options.selectIcon=t;this._updateSelectBtn()},_parseCodeError:function e(t){var a=this.options.locale;var i=this.uploader.options;switch(t){case"Q_EXCEED_NUM_LIMIT":t=D.sprintf(a.uploadExceedNumLimit,i.fileNumLimit);break;case"Q_EXCEED_SIZE_LIMIT":t=D.sprintf(a.uploadExceedSizeLimit,this.formatSize(i.fileSizeLimit));break;case"Q_TYPE_DENIED":var n=i.accept[0]||{};var r=n.extensions||"";if(r)t=D.sprintf(a.uploadTypeDeniedDetail,r);else t=a.uploadTypeDenied;break;case"F_EXCEED_SIZE":case"exceed_size":t=D.sprintf(a.uploadExceedSize,this.formatSize(i.fileSingleSizeLimit));break;case"F_DUPLICATE":t=a.uploadDuplicate;break;default:t=a.unknownError+": "+t}return t},formatSize:function e(t){return E.Base.formatSize(t,1,["B","KB","MB","GB","TB"])},_parseServerError:function e(t){var a=this.options.locale;switch(t){case"server":t=a.serverError;break;case"http":t=a.httpError;break;case"abort":t=a.httpAbort;break;case"timeout":t=a.httpTimeout;break}return t},_changeDisabled:function e(t){var a=this;var i=a.uploader;if(t){if(i)i.disable();if(a.$selectBtn)a.$selectBtn.addClass("disabled").prop("disabled",true);if(a.$uploadBtn)a.$uploadBtn.addClass("disabled").prop("disabled",true)}else{if(i)i.enable();if(a.$selectBtn)a.$selectBtn.removeClass("disabled").prop("disabled",false);if(a.$uploadBtn)a.$uploadBtn.removeClass("disabled").prop("disabled",false)}},_previewHandler:function e(t,a,i,n,r){var o=this;D.urlPreviewHandler({url:t,image:a,video:i,audio:n,file:r})},_triggerResult:function e(t,a){var i=null;if(t)if(a)i={id:t.file_id,url:t.file_url,size:t.size||0,name:t.name,extension:t.extension};else i={id:t.id,url:t.url,size:t.size,name:t.name,extension:t.extension};D.execCallback(this,this.options.result,this.$element[0],[i],this.$element,u.uploadResult)},_triggerChange:function e(t){D.execCallback(this,this.options.change,this.$element[0],[t],this.$element,u.uploadChange);this.options.value=t},setOption:function e(t,a){this.options[t]=a},destroy:function e(){var t=this;if(t.uploader){clearInterval(t.uploader.waitCompressTimeId);t.uploader.destroy();t.uploader=null}if(t.module){t.module.destroy();t.module=null}}},m.md5File=function(a,i){i=i||a.size;var t=E.Deferred();var n=File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice;if(!n){t.reject();return t.promise()}var r=Math.ceil(a.size/i);var o=0;var s=new d.ArrayBuffer;var l=new FileReader;l.onerror=function(e){t.reject(e)};l.onload=function(e){s.append(e.target.result);o++;t.notify(o/r);if(o<r)c();else t.resolve(s.end())};function c(){var e=o*i;var t=e+i>=a.size?a.size:e+i;l.readAsArrayBuffer(n.call(a,e,t))}c();return t.promise()},m.CARD_TEMPLATE='<div class="ba-upload-card">\n        <div class="upload-container">\n            <div class="block" data-upload-id="block"></div>\n            <div class="upload-btn" data-upload-id="upload-btn2"><i data-upload-id="icon"></i><span data-upload-id="placeholder"></span><span data-upload-id="desc"></span></div>\n            <div class="preview" data-upload-id="preview"></div>\n            <div class="pending" data-upload-id="progress"><div><i class="ba-pending-icon"></i><span data-upload-id="speed"></span></div></div>\n            <div class="toolbar" data-upload-id="toolbar">\n                <div class="tool-upload" data-upload-id="upload-btn"><i class="fa fa-cloud-upload"></i></div>\n                <div class="tool-select" data-upload-id="select-btn"></div>\n                <div class="tool-remove" data-upload-id="remove-btn"><i class="fa fa-remove"></i></div>\n            </div>\n        </div>\n    </div>',m.SINGLE_TEMPLATE='<div class="ba-upload-single">\n        <div class="input-group" data-upload-id="input-group">\n            <i data-upload-id="input"></i>\n            <div class="input-group-btn">\n                <button class="btn" data-upload-id="upload-btn" type="button"></button>\n                <button class="btn" data-upload-id="select-btn" type="button"></button>\n            </div>\n        </div>\n        <div class="upload-wait" style="display: none" data-upload-id="wait">\n            <div class="media" data-upload-id="item">\n                <a class="close" data-upload-id="close">&times;</a>\n                <div class="media-left" data-upload-id="thumb-box">\n                    <img class="media-object" src="" data-upload-id="thumb-img"/>\n                </div>\n                <div class="media-body">\n                    <div class="media-heading size-13 text-bold" data-upload-id="title"></div>\n                    <div class="progress">\n                        <div class="progress-bar progress-bar-success progress-bar-striped active" data-upload-id="progress" style="width: 0%">\n                            <span class="progress-number" data-upload-id="speed">0%</span>\n                        </div>\n                    </div>\n                    <div class="media-foot size-12 clearfix">\n                        <div class="pull-right" data-upload-id="file-size"></div>\n                        <div class="pull-left" data-upload-id="status"></div>\n                    </div>\n                    <div class="media-toolbar clearfix" data-upload-id="toolbar">\n                        <button class="btn btn-success btn-sm pull-right" data-upload-id="operate-btn"></button>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class="clearfix"></div>\n        <div class="upload-preview" style="display: none;" data-upload-id="preview"></div>\n    </div>',m.FILES_TEMPLATE='<div class="ba-upload-files">\n        <div class="panel panel-default no-margin-bottom">\n            <div class="panel-heading">\n                <button class="btn btn-sm" data-upload-id="upload-btn" type="button"></button>\n                <button class="btn btn-sm" data-upload-id="select-btn" type="button"></button>\n            </div>\n            <div class="table-responsive file-queue-list" data-upload-id="file-queue-container">\n                <table class="table table-hover table-bordered table-striped">\n                    <thead>\n                        <tr>\n                            <th class="text-center size-12" data-upload-id="locale-filename"></th>\n                            <th class="text-center size-12" data-upload-id="locale-fileSize" width="80"></th>\n                            <th class="text-center size-12" data-upload-id="locale-progress" width="150"></th>\n                            <th class="text-center size-12" data-upload-id="locale-operate" width="100"></th>\n                        </tr>\n                    </thead>\n                    <tfoot data-upload-id="toolbar">\n                        <tr>\n                            <td colspan="4">\n                                <button class="btn btn-sm btn-success pull-right" data-upload-id="operate-btn"></button>\n                                <div class="text-gray size-12" data-upload-id="tip"></div>\n                            </td>\n                        </tr>\n                    </tfoot>\n                    <tbody data-upload-id="queue-list"></tbody>\n                </table>\n            </div>\n            <div class="table-responsive image-queue-list" data-upload-id="image-queue-container">\n                <table class="table table-hover table-bordered table-striped">\n                    <tfoot data-upload-id="toolbar">\n                        <tr>\n                            <td colspan="4">\n                                <button class="btn btn-sm btn-success pull-right" data-upload-id="operate-btn"></button>\n                                <div class="text-gray size-12" data-upload-id="tip"></div>\n                            </td>\n                        </tr>\n                    </tfoot>\n                    <tbody><tr><td data-upload-id="queue-list"></td></tr></tbody>\n                </table>\n            </div>\n            <div class="table-responsive file-result-list" data-upload-id="file-result-container">\n                <table class="table table-hover table-bordered table-striped">\n                    <tbody data-upload-id="result-list"></tbody>\n                </table>\n            </div>\n            <div class="table-responsive image-result-list" data-upload-id="image-result-container">\n                <table class="table table-hover table-bordered table-striped">\n                    <tbody><tr><td data-upload-id="result-list"></td></tr></tbody>\n                </table>\n            </div>\n        </div>\n    </div>',m.FILES_TEMPLATE_FILE_QUEUE_EMPTY='<tr>\n        <td class="text-center empty" colspan="4">\n            <div data-upload-id="message" class="text-gray"></div>\n            <div data-upload-id="desc" class="text-gray"></div>\n        </td>\n    </tr>',m.FILES_TEMPLATE_FILE_QUEUE_ITEM='<tr>\n        <td data-upload-id="name" class="text-vcenter text-left text-bold"></td>\n        <td data-upload-id="size" class="text-vcenter text-center text-gray"></td>\n        <td class="text-vcenter text-center">\n            <div class="progress no-margin height-10" data-upload-id="progress-bar">\n                <div class="progress-bar progress-bar-success progress-bar-striped active" data-upload-id="progress" style="width: 0%"></div>\n            </div>\n            <div class="status" data-upload-id="status"></div>\n        </td>\n        <td class="text-center text-vcenter">\n            <a class="btn btn-danger btn-xs" data-upload-id="delete"><i class="fa fa-trash"></i></a>\n        </td>\n    </tr>',m.FILES_TEMPLATE_FILE_RESULT_ITEM='<tr>\n        <td data-upload-id="content" class="text-vcenter">\n            <a href="javascript:void(0)" class="name" data-upload-id="name"></a>\n            <code data-upload-id="size"></code>\n        </td>\n        <td class="text-center" width="100">\n            <a class="btn btn-default btn-xs" data-upload-id="preview"><i class="fa fa-search-plus"></i></a>\n            <a class="btn btn-success btn-xs" data-upload-id="replace"><i class="fa fa-folder-open"></i></a>\n            <a class="btn btn-danger btn-xs" data-upload-id="delete"><i class="fa fa-trash"></i></a>\n        </td>\n    </tr>',m.FILES_TEMPLATE_IMAGE_QUEUE_EMPTY='<div class="text-center empty">\n         <div data-upload-id="message" class="text-gray"></div>\n        <div data-upload-id="desc" class="text-gray"></div>\n    </div>',m.FILES_TEMPLATE_IMAGE_QUEUE_ITEM='<div class="item">\n        <div>\n            <div class="name" data-upload-id="name"></div>\n            <div class="thumb"><img data-upload-id="thumb"/></div>\n            <div class="item-content">\n                <div class="toolbar" data-upload-id="toolbar">\n                    <a href="javascript:void(0)" class="fa fa-trash" data-upload-id="delete"></a>\n                </div>\n                <div class="progress no-margin" data-upload-id="progress-bar">\n                    <div class="progress-bar progress-bar-success progress-bar-striped active" data-upload-id="progress" style="width: 0%"></div>\n                </div>\n                <div class="status" data-upload-id="status"></div>\n            </div>\n        </div>\n    </div>',m.FILES_TEMPLATE_IMAGE_RESULT_ITEM='<div class="item">\n        <div>\n            <div class="thumb"><img src="" data-upload-id="thumb"/></div>\n            <div class="item-content">\n                <div class="toolbar" data-upload-id="toolbar">\n                    <a href="javascript:void(0)" class="fa fa-search-plus" data-upload-id="preview"></a>\n                    <a href="javascript:void(0)" class="fa fa-folder-open" data-upload-id="replace"></a>\n                    <a href="javascript:void(0)" class="fa fa-trash" data-upload-id="delete"></a>\n                </div>\n                <a href="javascript:void(0)" class="fa fa-edit name" data-upload-id="name"></a>\n            </div>\n        </div>\n    </div>',m.KEY=l,m.DEFAULTS={type:"single",name:"",classType:"",classValue:"",value:"",dnd:false,paste:false,pasteContainer:document.body,chunked:false,chunkSize:5242880,threads:3,duplicate:false,className:"",placeholder:"",auto:true,disabled:false,bindForm:true,previewPlaceholder:null,disk:T,server:true,fileVal:"file",method:"post",binary:false,credential:false,params:{},headers:{},allowExtensions:T,allowMimetypes:T,title:"",select:true,selectName:"",selectIcon:"fa fa-folder-open",selectClass:"btn-default",upload:true,uploadName:"",uploadIcon:"fa fa-cloud-upload",uploadClass:"btn-primary",compress:false,compressWidth:1600,compressHeight:1600,compressQuality:90,compressZoom:false,compressCrop:false,compressMeta:true,compressLarger:false,compressSize:0,objectFit:"",singleInput:true,singlePreview:true,singlePreviewSize:"",singleSize:"",filesEditFilename:true,filesUi:"all",filesImageWidth:null,cardType:"",cardIcon:"fa fa-cloud-upload",useSelect:"",useDnd:"",useProgress:false,useError:false,maxSize:T,maxSingleSize:T,maxTotal:T,result:T,fileError:T,fileQueued:T,filesQueued:T,fileDequeued:T,reset:T,begin:T,stop:T,finished:T,start:T,progress:T,complete:T,error:T,success:T,resultAccept:T,beforeSend:T,asyncInit:T,asyncBeforeSendFile:T,asyncBeforeSend:T,asyncAfterSendFile:T,locale:_.extend({uploadFile:"上传%s",selectFile:"选择%s",replaceFile:"替换%s",pleaseUploadOrSelect:"请上传或选择%s",uploadSuccess:"上传成功",uploadLoading:"上传中...",uploadWait:"等待上传",uploadCanceled:"已取消上传",file:"文件",filename:"文件名",fileSize:"文件大小",progress:"进度",operate:"操作",uploadStart:"开始上传",uploadPause:"暂停上传",uploadContinue:"继续上传",uploadPaused:"暂停中",preview:"预览",replace:"替换",delete:"删除",modifyFileName:"修改文件名",pleaseInputFileName:"请输入文件名",confirmDeleteThat:"确认要删除%s吗？",uploadExceedSizeLimit:"所有文件总大小超过%s",uploadTypeDenied:"请选择有效的文件",uploadTypeDeniedDetail:"仅支持格式为%s的文件",uploadExceedSize:"文件大小超过%s",uploadDuplicate:"选择的文件重复",uploadExceedNumLimit:"单次最多允许选择%s个文件",unknownError:"未知错误",serverError:"服务器错误",httpError:"HTTP请求错误",httpTimeout:"请求超时",httpAbort:"请求被中断",uploadTipSelected:"共%s个文件，合计%s",uploadTipSuccess:"共%s个文件，已上传%s个文件",uploadTipComplete:"共%s个文件，已上传%s个，失败%s个"},((C.locale||{}).plugin||{}).upload||{})};var o=function e(t){var a=this;a.api=t;a.$template=null;a.$input=null;a.init()};o.prototype={init:function e(){var r=this;var n=r.api;var o=n.options;var a=r.$template=_(m.SINGLE_TEMPLATE).addClass(o.className);var t=h(a,"input");var i=n.$element;if(n.isInput){r.$input=i;i.after(a)}else{r.$input=_('<input type="text"/>');i.html(a)}r.$input.val(o.value).attr("name",o.name||"").addClass("form-control");r.setPlaceholder(o.placeholder);t.after(r.$input);t.remove();r.$inputGroup=h(a,"input-group");r.$uploadBtn=h(a,"upload-btn");r.$selectBtn=h(a,"select-btn");r.$wait=h(a,"wait");r.$close=h(a,"close");r.$item=h(a,"item");r.$thumbBox=h(a,"thumb-box");r.$thumbImg=h(a,"thumb-img");r.$title=h(a,"title");r.$progress=h(a,"progress");r.$speed=h(a,"speed");r.$fileSize=h(a,"file-size");r.$status=h(a,"status");r.$preview=h(a,"preview");r.$toolbar=h(a,"toolbar");r.$operateBtn=h(a,"operate-btn").html(o.locale.uploadStart);r.closeTimer=null;if(o.singleSize)r.setSize(o.singleSize);if(!o.singleInput)r.showInput(false);r.$operateBtn.on("click",function(){if(_(this).hasClass("disabled"))return;r.setOperateDisabled(true);n.uploader.upload()});n._initUploader(r.$uploadBtn,a,r.$selectBtn,false);i.on(u.uploadFileError,function(e,t,a,i){t.reset();C.dialog.tipError(i)}).on(u.uploadReset,function(){r.setDisabled(false)}).on(u.uploadFileQueued,function(e,t,a){r.$thumbImg.attr("src","");t.makeThumb(a,function(e,t){if(e)r.$thumbBox.hide();else{r.$thumbImg.attr("src",t);r.$thumbBox.show()}},60,60);r.$close.show().off("click").on("click",function(){t.removeFile(a,true)});r.$title.html(a.name);r.$speed.html("0%");r.$fileSize.html(n.formatSize(a.size));r.$progress.removeClass("progress-bar-danger").addClass("progress-bar-success").css("width","0%");r.setStatus(o.locale.uploadWait,"gray",true,false);r.setOperateDisabled(false);o.auto?r.$toolbar.hide():r.$toolbar.show();r.$wait.show()}).on(u.uploadFileDequeued,function(e,t){t.reset();r.setStatus(o.locale.uploadCanceled,"gray",false);r.setOperateDisabled(true)}).on(u.uploadProgress,function(e,t,a,i){var n=(i*100).toFixed(2)+"%";r.$progress.css("width",n);r.$speed.text(n);r.setStatus(o.locale.uploadLoading,"gray",true,false)}).on(u.uploadComplete,function(e,t){t.reset()}).on(u.uploadError,function(e,t,a,i){r.setStatus(n._parseServerError(i),"danger",false)}).on(u.uploadSuccess,function(e,t,a,i){r.setStatus(o.locale.uploadSuccess,"success",true);r.setValue(i.file_url)});n.uploader.on("beforeFileQueued",function(e){r.setDisabled(true);return true});r.inputTimer=null;r.$input.off("input."+l).on("input."+l,function(e){var t=r.$input.val();n._triggerChange(t);clearTimeout(r.inputTimer);if(r._mustPreview){r._mustPreview=false;r.showPreview(t)}else r.inputTimer=setTimeout(function(){r.showPreview(t)},500)});r._mustPreview=true;r.$input.baTriggerEvent("input").baTriggerEvent("change");r.$input.on(u.validateErrorPlacement,function(e,t){a.after(t);return false});r.setDisabled(o.disabled)},setValue:function e(t){var a=this;a.api.options.value=t;a._mustPreview=true;a.$input.val(t).baTriggerEvent("input").baTriggerEvent("change")},showInput:function e(t){if(!t){this.$template.addClass("no-input");this.$input.hide()}else{this.$template.removeClass("no-input");this.$input.show()}A()},setSize:function e(t){if(t){this.setSize("");this.$inputGroup.addClass("input-group-"+t)}else this.$inputGroup.removeClass("input-group-xs input-group-sm input-group-lg");if(this.api.uploader)this.api.uploader.refresh();A()},setPlaceholder:function e(t){this.$input.attr("placeholder",t)},setSelectFiles:function e(t){t=t||[];if(t.length<=0)return;var a=t[0];this.setValue(a.url);this.api._triggerResult(a,false)},setPreview:function e(t){this.api.options.singlePreview=t;this.showPreview(this.api.options.value)},setPreviewSize:function e(t){this.api.options.singlePreviewSize=t;this.showPreview(this.api.options.value)},showPreview:function e(t){var a=this;var i=a.api;if(a.$prevElement){a.$prevElement.off("load");a.$prevElement=null}t=(t||"").trim();if(t.length===0||!i.options.singlePreview){a.$preview.empty().hide();A();return}var n=i.options.singlePreviewSize||"";var r,o,s;if(!_.isArray(n))n=n.split(",");r=n[0]||"";o=n[1]||"";if(r&&_.isNumeric(r)&&r>0)r+="px";if(o&&_.isNumeric(o)&&r>0)o+="px";a.$delete=_('<a class="trash">&times;</a>');a.$delete.on("click",function(){a._mustPreview=true;a.$input.val("").baTriggerEvent("input").baTriggerEvent("change");a.api._triggerResult(null)});a.$preview.removeClass("upload-preview-image upload-preview-video upload-preview-audio upload-preview-file");i._previewHandler(t,function(){var e="";if(i.options.previewPlaceholder===true)e='data-avatar="true"';else if(i.options.previewPlaceholder)e='data-placeholder="'+i.options.previewPlaceholder+'"';a.$preview.addClass("upload-preview-image").html(a.$prevElement=s=_('<img src="'+t+'" class="img-thumbnail cursor-zoom-in" data-title="false" '+e+"/>"));if(r)s.width(r);else s.width(100);if(o)s.height(o);s.css("object-fit",i.options.objectFit);s.on("load",function(){a.$prevElement=null;A()});s.baImageViewer();a.$preview.append(a.$delete);a.$preview.show();A()},function(){a.$preview.addClass("upload-preview-video").html(s=_('<video><source src="'+t+'"/></video>'));if(r)s.width(r);else s.width(100);if(o)s.height(o);else s.height(100);s.css("object-fit",i.options.objectFit);s.baVideoViewer();a.$preview.append(a.$delete);a.$preview.show();A()},function(){a.$preview.addClass("upload-preview-audio").html(s=_('<audio src="'+t+'" preload="auto"></audio>'));s.baAudio();a.$preview.append(a.$delete);a.$preview.show();A()},function(){var e=D.parseURL(t);a.$preview.addClass("upload-preview-file").html(s=_('<div class="text-line-1"><i class="fa fa-file-o"></i><a href="'+t+'" target="_blank">'+e.filename+"</a></div>"));s.append(a.$delete);a.$preview.show();A()})},setStatus:function e(t,a,i,n){var r=this;clearTimeout(r.closeTimer);r.$status.html('<span class="text-'+a+'">'+t+"</span>");var o;if(!i){r.$progress.removeClass("progress-bar-success").addClass("progress-bar-danger");o=3e3}else o=1500;n=n===T?true:n;if(n){r.$close.hide();r.closeTimer=setTimeout(function(){r.$wait.fadeOut(function(){A()})},o)}else r.$close.show()},setDisabled:function e(t){var a=this;a.api._changeDisabled(t);a.$input.prop("readonly",t);a.$preview.toggleClass("disabled",t)},setOperateDisabled:function e(t){if(t)this.$operateBtn.prop("disabled",true).removeClass("btn-success").addClass("disabled btn-default");else this.$operateBtn.prop("disabled",false).removeClass("disabled btn-default").addClass("btn-success")},destroy:function e(){var t=this;var a=t.api.$element;if(a[0].tagName==="INPUT"){t.$template.before(a);t.$template.remove()}else a.empty();t.$input.off(u.validateErrorPlacement)}};var c=function e(t){this.api=t;this.uploadInProgress=false;this.fileTotal=0;this.fileSize=0;this.successIndex=0;this.successList={};this.sortable=null;this.addSuccessFileTimer=null;this.init()};c.prototype={init:function e(){var n=this;var r=n.api;var t=r.options;var a=t.locale;var i=n.$template=_(m.FILES_TEMPLATE).addClass(t.className);n.$uploadBtn=h(i,"upload-btn").addClass(t.uploadClass);n.$selectBtn=h(i,"select-btn").addClass(t.selectClass);n.$fileQueueContainer=h(i,"file-queue-container").hide();n.$fileResultContainer=h(i,"file-result-container").hide();n.$imageQueueContainer=h(i,"image-queue-container").hide();n.$imageResultContainer=h(i,"image-result-container").hide();n.$queueContainer=null;n.$resultContainer=null;if(r.category.type==="image"){n.$waitEmpty=_(m.FILES_TEMPLATE_IMAGE_QUEUE_EMPTY);n.$queueContainer=n.$imageQueueContainer.show();n.$resultContainer=n.$imageResultContainer}else{n.$waitEmpty=_(m.FILES_TEMPLATE_FILE_QUEUE_EMPTY);n.$queueContainer=n.$fileQueueContainer.show();n.$resultContainer=n.$fileResultContainer;h(i,"locale-filename").html(a.filename);h(i,"locale-fileSize").html(a.fileSize);h(i,"locale-progress").html(a.progress);h(i,"locale-operate").html(a.operate)}var o=n.$queueContainer;n.$queueList=h(o,"queue-list").addClass("no-list");n.$toolbar=h(o,"toolbar");n.$operateBtn=h(o,"operate-btn").html(a.uploadStart);n.$tip=h(o,"tip");n.$resultList=h(n.$resultContainer,"result-list").addClass("no-list");n.$waitMessage=h(n.$waitEmpty,"message");if(r.isInput){n.$input=r.$element;r.$element.after(i)}else{n.$input=_('<input type="text" name="'+t.name+'"/>');r.$element.html(i).append(n.$input)}n.$input.addClass("input-hidden");if(t.auto)n.$toolbar.hide();r._initUploader(n.$uploadBtn,i,n.$selectBtn,true);n.setOperateDisabled(true);n.$operateBtn.on("click",function(){if(_(this).hasClass("disabled"))return;if(n.uploadInProgress){n.uploadInProgress=false;r.uploader.stop()}else{n.uploadInProgress=true;r.uploader.upload()}});r.$element.on(u.uploadFileError,function(e,t,a,i){if(a){n.addFile(a);n.setFileStatus(a,i,"danger",false,false,true)}else C.dialog.tipError(i)}).on(u.uploadReset,function(){n.setDisabled(false);n.uploadInProgress=false;n.$operateBtn.html(a.uploadStart);n.setOperateDisabled(true);n.setTip(true)}).on(u.uploadFileQueued,function(e,t,a){n.fileSize+=a.size;n.fileTotal+=1;n.addFile(a);n.setFileStatus(a,n.api.options.locale.uploadWait,"gray",false,true,false);n.setOperateDisabled(false);n.setTip(false)}).on(u.uploadBegin,function(){n.setDisabled(true);n.$operateBtn.html(a.uploadPause).removeClass("btn-warning btn-default").addClass("btn-success")}).on(u.uploadStop,function(){n.$operateBtn.html(a.uploadContinue).removeClass("btn-success btn-default").addClass("btn-warning")}).on(u.uploadStart,function(e,t,a){a.$status.hide();a.$progressBar.show()}).on(u.uploadFinished,function(e,t){t.reset()}).on(u.uploadProgress,function(e,t,a,i){a.$progress.css("width",(i*100).toFixed(2)+"%")}).on(u.uploadError,function(e,t,a,i){n.setTip(false);n.setFileStatus(a,r._parseServerError(i),"danger",false,false,true)}).on(u.uploadSuccess,function(e,t,a,i){n.setTip(false);n.setFileStatus(a,r.options.locale.uploadSuccess,"success",true,false,true);n.addSuccessFile(i.file_url,i.name,i.file_size||0,i.file_id)});n.$input.on(u.validateErrorPlacement,function(e,t){i.after(t);return false});n.setUi(t.filesUi);n.setPlaceholder(t.placeholder);n.setDisabled(t.disabled)},parseValue:function e(t){var a=[];if(_.isArray(t))a=t;else if(typeof t==="string")try{a=JSON.parse(t);if(!_.isArray(a))throw new Error("")}catch(e){a=[];t.split(",").map(function(e,t){e=e.trim();if(e.length>0)a.push({url:e})})}return a},setPlaceholder:function e(t){this.$waitMessage.html(t)},setUi:function e(t){var a=this;var i=a.api.options;i.filesUi=t;a.$resultList.empty();a.$queueList.empty();if(t=="result")a.$resultList.html(a.$waitEmpty);else a.$queueList.html(a.$waitEmpty);a.successList={};a.successIndex=0;a.parseValue(i.value).map(function(e){a.addSuccessFile(e.url,e.name,e.size,e.id)});a.displayWaitEmpty()},setValue:function e(t){this.api.options.value=t;this.setUi(this.api.options.filesUi)},setSelectFiles:function e(t){t=t||[];if(t.length<=0)return;var a=this;_.map(t,function(e){a.addSuccessFile(e.url,e.name,e.size,e.id);a.api._triggerResult(e,false)})},addSuccessFile:function e(t,a,i,n,r){var o=this;var s=o.api;var l=s.options;var c=l.locale;var d={};var u=function e(){var t=[];for(var a in o.successList)t.push(o.successList[a].data);t.sort(function(e,t){return e.sort-t.sort});var i=t.length==0?"":JSON.stringify(t);o.$input.val(i).baTriggerEvent("input").baTriggerEvent("change");s._triggerChange(i);o.displayWaitEmpty()};a=(a||"").trim();if(a.length===0)a=t.substring(t.lastIndexOf("/")+1);d.data={url:t||"",name:a,size:i||0,id:n||"",sort:r||o.successIndex};switch(s.category.type){case"image":d.$item=_(m.FILES_TEMPLATE_IMAGE_RESULT_ITEM);if(l.filesImageWidth>0)d.$item.width(l.filesImageWidth);d.$thumb=h(d.$item,"thumb").attr("src",t).attr("data-src",t).attr("alt",a).css("background-image","url("+t+")").css("background-size",l.objectFit).on("error",function(){_(this).addClass("error")});if(l.previewPlaceholder===true)d.$thumb.attr("data-avatar","true");else if(l.previewPlaceholder)d.$thumb.attr("data-placeholder",l.previewPlaceholder);break;default:d.$item=_(m.FILES_TEMPLATE_FILE_RESULT_ITEM)}d.$item.attr("data-index",o.successIndex).attr("data-upload-id","item");d.$delete=h(d.$item,"delete").attr("title",c.delete).attr("data-index",o.successIndex);d.$preview=h(d.$item,"preview").attr("title",c.preview).attr("data-index",o.successIndex);d.$replace=h(d.$item,"replace").attr("title",c.replace).attr("data-index",o.successIndex);d.$name=h(d.$item,"name").attr("title",c.modifyFileName).attr("data-index",o.successIndex).html(a);d.$size=h(d.$item,"size").attr("data-index",o.successIndex).html(s.formatSize(i));d.index=o.successIndex;o.successList[o.successIndex]=d;o.successIndex++;if(l.filesEditFilename)d.$name.on("click",function(){C.dialog.prompt(c.modifyFileName,d.data.name,"text",function(e){e=(e||"").trim();if(e.length===0){C.dialog.toast(c.pleaseInputFileName);return false}d.data.name=e;d.$name.html(e);u()})});d.$delete.on("click",function(){C.dialog.confirm(D.sprintf(c.confirmDeleteThat,"<code>"+d.data.name+"</code>"),function(){d.$item.remove();delete o.successList[d.index];u()})});d.$preview.on("click",function(){o.api._previewHandler(d.data.url,function(){d.$preview.baImageViewer({clickHandler:false,src:d.data.url,alt:d.data.name},true)},function(){d.$preview.baVideoViewer({clickHandler:false,src:d.data.url},true)},function(){d.$preview.baAudioViewer({src:d.data.url},true)},function(){window.open(d.data.url)})});d.$replace.on("click",function(){_(this).baFilePicker({classType:l.classType,classValue:l.classValue,title:D.sprintf(c.replaceFile,l.title),extensions:o.api.useExtensions?l.allowExtensions:T,mimetypes:o.api.useMimetypes?l.allowMimetypes:T,maxSize:o.api.useMaxSingleSize?l.maxSingleSize:T,count:1,success:function e(t){if(t.length<=0)return;var a=t[0];d.$name.html(a.name);d.$size.html(s.formatSize(i));if(d.$thumb)d.$thumb.removeClass("error").attr("src",a.url).attr("data-src",a.url).attr("alt",a.name).css("background-image","url("+a.url+")");d.data.url=a.url;d.data.name=a.name;d.data.size=a.size;d.data.id=a.id;u()}})});var p=[d.$delete,d.$preview,d.$replace];if(l.filesEditFilename)p.push(d.$name);_(p).tooltip({container:o.$template,trigger:"hover"});i>0?d.$size.show():d.$size.hide();o.$resultList.append(d.$item);clearTimeout(o.addSuccessFileTimer);o.addSuccessFileTimer=setTimeout(function(){u();if(this.sortable)this.sortable.destroy();o.sortable=new f(o.$resultList[0],{animation:150,onEnd:function e(){h(o.$resultList,"item").each(function(e){o.successList[_(this).data("index")].data.sort=e});u()}})},10)},setImageWidth:function e(t){this.api.options.filesImageWidth=t;this.setUi(this.api.options.filesUi)},addFile:function e(a){var i=this;var n=i.api;var r=i.api.options.locale;if(n.category.type==="image"){a.$item=_(m.FILES_TEMPLATE_IMAGE_QUEUE_ITEM);if(n.options.filesImageWidth>0)a.$item.width(n.options.filesImageWidth);a.$thumb=h(a.$item,"thumb");a.$toolbar=h(a.$item,"toolbar");a.rotation=0;a.$thumb.attr("src","");n.uploader.makeThumb(a,function(e,t){if(e);else a.$thumb.attr("src",t)},150,150)}else a.$item=_(m.FILES_TEMPLATE_FILE_QUEUE_ITEM);a.$item.attr("data-upload-id","wait-item");a.$name=h(a.$item,"name");a.$size=h(a.$item,"size");a.$progressBar=h(a.$item,"progress-bar");a.$progress=h(a.$item,"progress");a.$delete=h(a.$item,"delete");a.$status=h(a.$item,"status");a.$name.html(a.name);a.$size.html(i.api.formatSize(a.size));a.$progress.css("width","0%");a.$delete.on("click",function(){a.isDelete=true;n.uploader.removeFile(a,true)});a.on("statuschange",function(e,t){switch(e){case"error":i.setFileStatus(this,n._parseServerError(this.statusText),"danger",false,false,true);break;case"invalid":i.setFileStatus(this,n._parseCodeError(this.statusText),"danger",false,false,true);break;case"interrupt":i.setFileStatus(this,r.uploadPaused,"warning",false,true,false);break;case"cancelled":i.fileTotal-=1;i.fileSize-=a.size;i.setTip(false);i.setFileStatus(this,r.uploadCanceled,"danger",false,false,true);break}});i.$queueList.append(a.$item);i.displayWaitEmpty()},setFileStatus:function e(t,a,i,n,r,o){var s=this;t.$progressBar.hide();t.$status.html('<span class="text-'+i+'">'+a+"</span>").show();r?t.$delete.show():t.$delete.hide();clearTimeout(t.closeTimer);if(o)t.closeTimer=setTimeout(function(){t.$item.fadeOut(function(){t.$item.remove();s.displayWaitEmpty()})},n?1500:2500)},displayWaitEmpty:function e(){var t=this;var a=t.api.options.filesUi;var i=0;for(var n in t.successList)i++;t.$resultContainer.removeClass("only-result").show();t.$resultList.removeClass("no-list");t.$queueList.removeClass("no-list");t.$queueContainer.show();switch(a){case"result":if(h(t.$queueList,"wait-item").length===0){t.$queueContainer.hide();t.$resultContainer.addClass("only-result")}else{t.$queueContainer.show();t.$resultContainer.removeClass("only-result")}if(i==0){t.$waitEmpty.show();t.$resultList.addClass("no-list");t.$resultContainer.show()}else{t.$waitEmpty.hide();t.$resultList.removeClass("no-list");t.$resultContainer.show()}break;default:if(a=="queue")t.$resultContainer.hide();else if(i==0)t.$resultContainer.hide();else t.$resultContainer.show();if(h(t.$queueList,"wait-item").length===0){t.$waitEmpty.show();t.$queueList.addClass("no-list")}else{t.$waitEmpty.hide();t.$queueList.removeClass("no-list")}}A()},setTip:function e(t){var a=this;var i=a.api;var n=i.options.locale;clearTimeout(a.tipTimer);if(t){a.tipTimer=setTimeout(function(){a.$tip.fadeOut()},2500);a.fileTotal=0;a.fileSize=0}else{var r=i.uploader.getStats();if(r.uploadFailNum>0)a.$tip.html(D.sprintf(n.uploadTipComplete,"<code>"+a.fileTotal+"</code>","<code>"+r.successNum+"</code>","<code>"+r.uploadFailNum+"</code>"));else if(r.successNum>0)a.$tip.html(D.sprintf(n.uploadTipSuccess,"<code>"+a.fileTotal+"</code>","<code>"+r.successNum+"</code>"));else a.$tip.html(D.sprintf(n.uploadTipSelected,"<code>"+a.fileTotal+"</code>","<code>"+i.formatSize(a.fileSize)+"</code>")).show();if(a.fileTotal===0){a.setOperateDisabled(true);a.setTip(true)}}},setOperateDisabled:function e(t){if(t)this.$operateBtn.prop("disabled",true).removeClass("btn-success btn-warning").addClass("disabled btn-default");else this.$operateBtn.prop("disabled",false).removeClass("disabled btn-default").addClass("btn-success")},setDisabled:function e(t){this.$resultList.toggleClass("disabled",t);this.api._changeDisabled(t)},destroy:function e(){var t=this;t.$template.remove();t.$input.off(u.validateErrorPlacement);if(t.api.isInput)t.api.$element.removeClass("input-hidden");else t.$input.remove()}};var p=function e(t){this.api=t;this.init()};p.prototype={init:function e(){var n=this;var t=n.api;var r=t.options;var a=t.$element.outerWidth();var i=t.$element.outerHeight();var o=n.$template=_(m.CARD_TEMPLATE).addClass(r.className);n.$toolbar=h(o,"toolbar");n.$uploadBtn=h(o,"upload-btn").addClass(r.uploadClass);n.$uploadBtn2=h(o,"upload-btn2");n.$selectBtn=h(o,"select-btn").addClass(r.selectClass);n.$block=h(o,"block");n.$icon=h(o,"icon").addClass(r.cardIcon);n.$preview=h(o,"preview").hide();n.$progress=h(o,"progress").hide();n.$speed=h(o,"speed");n.$delete=h(o,"remove-btn");if(t.options.cardType==="circle")o.addClass("upload-card-type-circle");if(t.options.cardSize==="parent"){t.$element.parent().addClass("ba-upload-card-parent");a=true}if(t.options.cardRadius)o.css("border-radius",t.options.cardRadius);if(t.isInput){n.$input=t.$element;o.insertAfter(n.$input).append(n.$input)}else{n.$input=_('<input type="text" name="'+r.name+'"/>');t.$element.html(o).append(n.$input)}n.$input.addClass("input-hidden").on(u.validateErrorPlacement,function(e,t){o.after(t);return false});n.$delete.on("click",function(){n.showPreview("")});n.setSize(a,i);r.auto=true;t._initUploader(n.$uploadBtn,o,n.$selectBtn,false);n.$toolbar.hide();t.uploader.addButton({id:n.$uploadBtn2,multiple:false}).then(function(){n.$placeholder=h(o,"placeholder");n.$icon=h(o,"icon");n.setPlaceholder(r.placeholder)});t.$element.on(u.uploadFileError,function(e,t,a,i){t.reset();C.dialog.tipError(i)}).on(u.uploadReset,function(){n.setDisabled(false);n.$progress.hide()}).on(u.uploadFileQueued,function(){n.$speed.html("0%");n.$progress.show()}).on(u.uploadProgress,function(e,t,a,i){n.$speed.html((i*100).toFixed(2)+"%")}).on(u.uploadComplete,function(e,t){t.reset()}).on(u.uploadError,function(e,t,a,i){C.dialog.tipError(i)}).on(u.uploadSuccess,function(e,t,a,i){C.dialog.tipSuccess(r.locale.uploadSuccess);n.setValue(i.file_url)});t.uploader.on("beforeFileQueued",function(e){n.setDisabled(true);return true});n.setValue(r.value);n.setDisabled(r.disabled);A()},setSize:function e(t,a){var i=this;if(t===true){if(i.api.uploader)i.api.uploader.refresh();return}a=a<=0?t:a;var n=a/t*100;i.api.$element.css({width:t,height:a});i.$template.css({width:t,height:a});i.$block.css({width:"100%",paddingBottom:n+"%"});if(i.api.uploader)i.api.uploader.refresh();A()},setIcon:function e(t){this.$icon.removeAttr("class").addClass(t)},setValue:function e(t){this.api.options.value=t;this.showPreview(t)},setPlaceholder:function e(t){this.$placeholder.html(t)},setSelectFiles:function e(t){t=t||[];if(t.length<=0)return;var a=t[0];this.showPreview(a.url);this.api._triggerResult(a,false)},showPreview:function e(t){var a=this;var i=a.api;var n;t=(t||"").trim();a.$input.val(t).baTriggerEvent("input").baTriggerEvent("change");i._triggerChange(t);if(t.length===0){a.$preview.empty().hide();a.$delete.hide();return}i._previewHandler(t,function(){var e="";if(i.options.previewPlaceholder===true)e='data-avatar="true"';else if(i.options.previewPlaceholder)e='data-placeholder="'+i.options.previewPlaceholder+'"';a.$preview.html(n=_('<img src="'+t+'" data-title="false" '+e+' class="cursor-zoom-in"/>')).show();n.baImageViewer()},function(){a.$preview.html(n=_('<video><source src="'+t+'"/></video>')).show();n.baVideoViewer({previewSize:false})});if(n)n.css("object-fit",i.options.objectFit);a.$delete.show()},setDisabled:function e(t){this.api._changeDisabled(t);this.$template.toggleClass("disabled",t)},destroy:function e(){var t=this;t.$input.off(u.validateErrorPlacement);if(t.api.isInput)t.$input.removeClass("input-hidden").insertBefore(t.$template);t.$template.remove()}};var g=function e(t){this.api=t;this.pending=null;this.init()};function t(e){return D.pluginFn(this,m,e,arguments,"module")}return g.prototype={init:function(){var n=this,r=n.api,o=r.options;o.upload=!0,o.select=!0,n.$uploadBtn=_(r.element),n.$selectBtn=null,o.useSelect&&(n.$selectBtn=_(o.useSelect)),n.$dnd=null,o.useDnd&&(n.$dnd=_(o.useDnd),o.dnd=!0),r._initUploader(n.$uploadBtn,n.$dnd,n.$selectBtn,!1),r.$element.on(u.uploadFileError,function(e,t,a,i){t.reset(),o.useError||C.dialog.tipError(i)}).on(u.uploadReset,function(){n.setDisabled(!1),n.pending&&n.pending.close()}).on(u.uploadFileQueued,function(){o.useProgress||(n.pending=C.dialog.pending("0%"))}).on(u.uploadProgress,function(e,t,a,i){n.pending&&n.pending.update((100*i).toFixed(2)+"%")}).on(u.uploadComplete,function(e,t){t.reset()}).on(u.uploadError,function(e,t,a,i){o.useError||C.dialog.tipError(i)}).on(u.uploadSuccess,function(e,t,a,i){r._triggerResult(i,!0),r._triggerChange(i.file_url)}),r.uploader.on("beforeFileQueued",function(e){return n.setDisabled(!0),!0}),n.setDisabled(o.disabled),A()},setSelectFiles:function(e){(e=e||[]).length<=0||(this.api._triggerResult(e[0],!1),this.api._triggerChange(e[0].url))},setDisabled:function(e){this.api._changeDisabled(e)},destroy:function(){}},_.fn.baUpload=t,_.fn.baUpload.Constructor=m,C.plugins.Upload=m,u.uploadInitialized=e("Initialized",I),u.uploadAsyncInit=e("init",I),u.uploadReady=e("ready",I),u.uploadFileError=e("file-error",I),u.uploadFileQueued=e("file-queued",I),u.uploadFilesQueued=e("files-queued",I),u.uploadFileDequeued=e("files-dequeued",I),u.uploadAsyncBeforeSendFile=e("async-before-send-file",I),u.uploadBeforeSend=e("before-send",I),u.uploadAsyncBeforeSend=e("async-before-send",I),u.uploadAccept=e("accept",I),u.uploadAsyncAfterSendFile=e("async-after-send-file",I),u.uploadBegin=e("begin",I),u.uploadStop=e("stop",I),u.uploadFinished=e("finished",I),u.uploadStart=e("start",I),u.uploadComplete=e("complete",I),u.uploadProgress=e("progress",I),u.uploadSuccess=e("success",I),u.uploadError=e("error",I),u.uploadReset=e("reset",I),u.uploadResult=e("result",I),u.uploadChange=e("change",I),C.autoInit(I,D.pluginAttrs(I),function(){t.call(this)}),m}),define("./ba/plug/validate",["busyAdmin","jquery"],function(u,p){"use strict";var c=u.helper,d=u.e,n="validate",e=c.pluginKey(n);d.validateErrorPlacement=u.ee("error-placement",n),d.validateInitialized=u.ee("initialized",n),d.validateInvalid=u.ee("invalid",n);var r=function e(t,a,i,n){var r=p(a);var o=r.closest(".form-group");if(o.length>0)o.toggleClass("has-error",!t)},o=function e(t,a){var i=[];t.split(a).map(function(e){e=e.trim();if(e.length)i.push(e)});return i},s=function e(t,a){var i;try{i=JSON.parse(t)}catch(e){i=o(t,a)}return p.isArray(i)?i:[]},f="validateErrorContainer",l="validateContainerBackups",h="validateRemotePending",m=function e(t){if(t.length&&!t.data(l))t.data(l,t.html())},g=function e(t,a,i){i.addClass("help-block");var n=c.scope(a.data("errorTarget"));if(n){if(typeof n==="function"&&!(n instanceof jQuery))n(i);else p(n).html(i);return}var r=".help-block",o;if(false===c.execCallback(t.api,null,a[0],[i],a,d.validateErrorPlacement,true,false)){o=i.next(r);m(o);if(o.length){a.data(f,o);o.html(i)}return}var s=a.closest(".input-group");o=s.next(r);m(o);if(s.length){if(o.length){a.data(f,o);o.html(i)}else i.insertAfter(s);return}if(a.is(":checkbox")||a.is(":radio")){var l=a.closest(".checkbox-inline,.checkbox,.radio-inline,.radio,.checkbox-group,.radio-group");if(l.length)l.parent().append(i)}else{o=a.next(r);m(o);if(o.length){a.data(f,o);o.html(i)}else i.insertAfter(a)}},v,a=function e(){if(v)return;v=true;var t=p.validator;var a=b.DEFAULTS.locale;t.messages=a;t.addMethod("regex",function(e,t,a){return this.optional(t)||new RegExp(a).test(e)},a.regex);t.addMethod("phone",function(e,t){return this.optional(t)||/^(\+?86-?)?(18|15|13|14|17|16|19)[0-9]{9}$/.test(e)},a.phone);t.addMethod("cardNo",function(e,t){return this.optional(t)||c.checkCardNo(e)},a.cardNo);t.addMethod("tel",function(e,t){return this.optional(t)||/^(010|02\d{1}|0[3-9]\d{2})-\d{7,9}(-\d+)?$/.test(e)},a.tel);t.addMethod("decimal",function(e,t){return this.optional(t)||/^\d+(\.\d+)?$/.test(e)},a.decimal);t.addMethod("zip",function(e,t){return this.optional(t)||/^\d{6}$/.test(e)},a.zip);t.addMethod("en",function(e,t){return this.optional(t)||/^[A-Za-z]+$/.test(e)},a.en);t.addMethod("enNumLine",function(e,t){return this.optional(t)||/^[A-Za-z0-9_]+$/.test(e)},a.enNumLine);t.addMethod("minArray",function(e,t,a){if(a<=0)return this.optional(t);var i=p(t).data()||{};var n=i.optArraySpace||",";return this.optional(t)||s(e,n).length>=a},a.minArray);t.addMethod("maxArray",function(e,t,a){if(a<=0)return this.optional(t);var i=p(t).data()||{};var n=i.optArraySpace||",";return this.optional(t)||s(e,n).length<=a},a.maxArray);var n=c.extends(t.prototype,{init:function e(){c.override(n,"init",this,arguments);var r=this.currentForm;p(this.currentForm).on("change.validate","input,select,textarea",function(e){var t=typeof p(this).attr("contenteditable")!=="undefined"&&p(this).attr("contenteditable")!=="false";if(!this.form&&t){this.form=p(this).closest("form")[0];this.name=p(this).attr("name")}if(r!==this.form)return;var a=p.data(this.form,"validator"),i="on"+e.type.replace(/^validate/,""),n=a.settings;if(n[i]&&!p(this).is(n.ignore))n[i].call(a,this,e)})},idOrName:function e(t){var a=p(t);var i="validateErrorId";var n=a.data(i);if(!n){n="ba-validate-error-"+b.INDEX++;a.data(i,n)}return n},startRequest:function e(t){var a=this;c.override(n,"startRequest",a,arguments);if(!a.pending[t.name])return;var i=p(t);if(i.data("optRemotePendingStatus")===false)return;a.pendingElements=a.pendingElements||{};if(!a.pendingElements[t.name])a.pendingElements[t.name]=p('<span class="ba-validate-pending"><i class="fa fa-circle-o-notch fa-spin"></i>'+(i.data("optRemotePendingMessage")||"请稍后...")+"</span>");g(a,i.data(h,true),a.pendingElements[t.name])},stopRequest:function e(t,a){var i=this;c.override(n,"stopRequest",i,arguments);i.pendingElements=i.pendingElements||{};if(i.pendingElements[t.name])i.pendingElements[t.name].remove();p(t).data(h,false)}});var i=c.extends(t.methods,{remote:function e(a,n,r,o){var s=this,l;if(s.optional(n))return"dependency-mismatch";o=typeof o==="string"&&o||"remote";var c=s.previousValue(n,o);var t=s.settings;if(!t.messages[n.name])t.messages[n.name]={};c.originalMessage=c.originalMessage||t.messages[n.name][o];t.messages[n.name][o]=c.message;r=typeof r==="string"?{url:r}:r;var i=p.param(p.extend({data:a},r.data));if(c.old===i)return c.valid;c.old=i;s.startRequest(n);s._ajaxMap=s._ajaxMap||{};s._ajaxMap[n.name]=s._ajaxMap[n.name]||{};l=s._ajaxMap[n.name];var d=function e(){var t=p(n).data();var i=s.defaultMessage(n,{method:o,parameters:a});l.task=u.request(t.optRemoteModel?u.getConfig("validate").remote:r.url).addHeader("Busy-Admin-Plugin","ValidateRemote").params({field:t.optRemoteField||n.name,value:a,model:t.optRemoteModel||"",exclude_field:t.optRemoteExcludeField||"id",exclude_value:t.optRemoteExcludeValue||"",error_message:i}).pending(false).before(function(e,t){t.context=s.currentForm}).complete(function(){s.settings.messages[n.name][o]=c.originalMessage}).success(function(){var e=s.formSubmitted;s.resetInternals();s.toHide=s.errorsFor(n);s.formSubmitted=e;s.successList.push(n);s.invalid[n.name]=false;s.stopRequest(n,true);s.showErrors();c.valid=true;return false}).error(function(e,t){var a={};a[n.name]=c.message=e.message||i;s.invalid[n.name]=true;s.stopRequest(n,false);s.showErrors(a);c.valid=false;return false}).exec()};l.task&&l.task.abort();clearTimeout(l.taskTimeId);l.taskTimeId=setTimeout(d,200);return"pending"}})},b=function e(t,a){var i=this;i.element=t;i.$element=p(t);i.options=p.extend(true,{},e.DEFAULTS,i.$element.baData(n)||{},a||{});i.ready(i._init)};function t(e){return c.pluginFn(this,b,e,arguments,"api")}return b.prototype={ready:function(e){var t=this;v?e.call(t):requirejs([u.lib.validate],function(){a(),e.call(t)})},_init:function(){var e,a=this,t=a.$element,i={},n=p.proxy(a.destroy,a);p(document).one(d.appRenderBefore,n),(e=t.closestBaModal())&&e.$element.one(d.modalHide,n),t.find(":input").each(function(){var e=p(this),t=e.data(),a=e.attr("placeholder")||t.placeholder,e=e.attr("name")||t.name;if(!a||!e||t.msg)return!0;i[e]={required:a}}),t.on("invalid-form",function(){a.api.errorList.length&&a.options.toast&&u.dialog.toast(a.api.errorList[0].message),c.execCallback(a,a.options.onInvalid,a.element,[a],a.$element,d.validateInvalid)}),t.validate({messages:i,errorClass:"ba-validate-error text-danger",ignoreTitle:!0,ignore:'[data-rule-ignore],[validate="false"],[data-validate="false"]',errorElement:"span",submitHandler:c.scope(a.options.onSubmit),onchange:function(e){this.checkable(e)||!(e.name in this.submitted)&&this.optional(e)||this.element(e)},highlight:function(e,t,a){return r(!1,e,t,a),p.validator.defaults.highlight.call(this,e,t,a)},unhighlight:function(e,t,a){r(!0,e,t,a);var i=p(e).data(f);return i&&!p(e).data(h)&&i.html(i.data(l)),p.validator.defaults.unhighlight.call(this,e,t,a)},errorPlacement:function(e,t){g(a.api,t,e)}}),a.api=t.data("validator"),a.api.api=a,c.triggerPluginReady(t,a,"",d.validateInitialized)},valid:function(){return!!v&&this.$element.valid()},rules:function(e,t){if(v)return this.$element.rules(e,t)},destroy:function(){var e=this.api;if(e){if(e._ajaxMap){var t,a,i=e._ajaxMap;for(a in i)(t=i[a]).task&&(t.task.abort(),t.task=null),clearTimeout(t.taskTimeId)}this.api=null}}},b.INDEX=0,b.KEY=e,b.DEFAULTS={toast:!0,locale:p.extend({required:"必选项",remote:"请检测该项",email:"请输入有效邮件",url:"请输入有效的网址",date:"请输入有效的日期",dateISO:"请输入有效的日期(ISO)",number:"请输入数字",digits:"请输入整数",equalTo:"请再次输入相同的值",maxlength:"最多允许输入{0}个字符",minlength:"至少需要输入{0}个字符",rangelength:"输入的字符长度必须在{0}~{1}个字符内",range:"输入的数字必须在{0}~{1}之间",max:"不能超过{0}",min:"不能小于{0}",step:"输入的数值必须是{0}的倍数",phone:"请输入有效的手机号",decimal:"请输入有效的数值(可包涵小数)",zip:"请输入有效的邮编",en:"只能包涵英文字母",enNumLine:"只能包涵英文、数字、下划线",tel:"请输入有效的电话号码",minArray:"至少需要{0}项",maxArray:"最多允许{0}项",cardNo:"身份证格式错误",regex:"输入的内容无效"},((u.locale||{}).plugin||{}).formVerify||{})},p.fn.baValidate=t,p.fn.baValidate.Constructor=b,u.plugins.Validate=b,u.autoInit(n,c.pluginAttrs(n),function(){t.call(this)}),b}),define("./ba/plug/videoViewer",["busyAdmin","jquery"],function(s,l){var c=s.helper,n="video-viewer",d=c.pluginKey(n);s.e.videoViewerInitialized=s.ee("initialized",n);var t=function e(t,a){var i=this;i.element=t;i.$element=l(t);i.options=l.extend(true,{},e.DEFAULTS,i.$element.baData(n)||{},a||{});i._init()};function e(e){return c.pluginFn(this,t,e,arguments,"video",function(){if(!this.options.clickHandler&&!this.isVideo)this.show()})}return t.prototype={_init:function(){var a=this,t=a.options,e=a.$element;a.sources=[];function i(e){return e.preventDefault(),a.show(),!1}var n,r;"video"===a.element.tagName.toLowerCase()?(a.isVideo=!0,e.find("source").each(function(){var e=l(this),t=e.attr("src");t&&a.sources.push({src:t,type:e.attr("type")})}),n=l('<div class="ba-video-viewer"/>'),a.options.previewSize&&n.css({width:e.outerWidth(!0),height:e.outerHeight(!0)}),e.wrap(n),a.$template=e.parent(),a.$template.append('<div class="player fa fa-play-circle fa-3x"/>'),a.$template.off("click."+d).on("click."+d,i)):a.options.clickHandler&&e.off("click."+d).on("click."+d,i),t.src=t.src||e.attr("src")||"",t.type=t.type||e.attr("type")||"",t.poster=t.poster||e.attr("poster")||"",t.src&&(r=!1,a.sources.map(function(e){e.src==t.src&&(r=!0)}),r||a.sources.push({src:t.src,type:t.type})),!t.vertical&&0<t.width&&0<t.height&&(t.vertical=t.width<t.height);var o="";a.sources.map(function(e){o+='<source src="'+e.src+'" type="'+(e.type||"")+'"/>'}),e.baModal({show:!1,className:"ba-video-viewer-dialog"+(t.vertical?" ba--vertical":""),content:'<div class="ba--content"><video class="video-js">'+o+"</video></div>",size:t.vertical?"sm":"",padding:0,footer:!1,title:t.title||"预览视频",ok:!1,cancel:"关闭",type:"page",onReady:function(e){e.$dialogBody.find("video").baVideo(l.extend({controls:t.controls,preload:t.preload,autoplay:t.autoplay,muted:t.muted,poster:t.poster,loop:t.loop,fluid:!1,objectFit:t.objectFit},t.options||{})).baVideo("ready",function(){a.video=this,e.resetView()})}},!0),c.triggerPluginReady(e,a,"",s.e.videoViewerInitialized)},show:function(){this.$element.baModal("show")},hide:function(){this.$element.baModal("close")},getVideo:function(){return this.video},destroy:function(){this.isVideo?(this.$template.after(this.$element),this.$template.remove()):this.options.clickHandler&&this.$element.off("click."+d),this.video=null}},t.KEY=d,t.DEFAULTS={clickHandler:!0,src:"",type:"",autoplay:!0,muted:!1,controls:!0,loop:!1,preload:"auto",poster:"",objectFit:"",options:{},title:"",vertical:!1,width:0,height:0,previewSize:!0},l.fn.baVideoViewer=e,l.fn.baVideoViewer.Constructor=t,s.plugins.VideoViewer=t,s.autoInit(n,c.pluginAttrs(n),function(){e.call(this)}),t}),define("./ba/plug/video",["busyAdmin","jquery"],function(s,l){var c=null,d=s.helper,u=s.ee,p="video",f="ready,loadstart,progress,loadedmetadata,canplaythrough,waiting,play,playing,pause,ended,error,seeking,seeked,ratechange,timeupdate,volumechange,stalled".split(","),h=l.baIsEmpty,e=d.pluginKey(p);s.e.videoInitialized=u("initialized",p),l.map(f,function(e){s.e[d.camel("video_"+e)]=u(e,p)});var n=function e(){var a=d.extends(videojs.getComponent("Player").prototype,{createEl:function e(){var t=d.override(a,"createEl",this,arguments);["data-toggle","busy-video"].map(function(e){t.removeAttribute(e)});return t}})},t=function e(t,a){var i=this;i.element=t;i.$element=l(t);i.options=l.extend(true,{},e.DEFAULTS,i.$element.baData(p)||{},a||{});i.ready(i._init)};function a(e){return d.pluginFn(this,t,e,arguments,"api")}return t.prototype={ready:function(a){var i=this;c?a.call(i):requirejs([s.lib.videojs],function(e){window.videojs=e;function t(){c=e,n(),a.call(i)}i.options.locale?requirejs(["video-js/lang/"+i.options.locale+".min"],t):t()})},_init:function(){var a=this,i=a.options,n=a.$element,e=a.element,t=l.proxy(a.destroy,a);l(document).one(s.e.appRenderBefore,t);var r=n.closestBaModal();r&&r.$element.one(s.e.modalHided,t),n.wrap('<div class="ba-video" />'),a.$wrap=n.parent(),a.sources=[],"video"===e.tagName.toLowerCase()?(a.isVideo=!0,a.$video=n,h(i.autoplay)&&(i.autoplay=!!e.hasAttribute("autoplay")||null),h(i.loop)&&(i.loop=!!e.hasAttribute("loop")||null),h(i.muted)&&(i.muted=!!e.hasAttribute("muted")||null),h(i.preload)&&(i.preload=e.getAttribute("preload")),h(i.controls)&&(i.controls=!!e.hasAttribute("controls")||null)):(a.$video=l("<video />"),a.$wrap.append(a.$video)),i.src=i.src||n.attr("src")||"",i.type=i.type||n.attr("type")||"",i.poster=i.poster||n.attr("poster")||"",i.width=i.width||n.attr("width")||"",i.height=i.height||n.attr("height")||"",i.preload=i.preload||"auto";var o,e="boolean";_typeof(i.loop)!==e&&(i.loop=!1),_typeof(i.autoplay)!==e&&(i.autoplay=!1),_typeof(i.muted)!==e&&(i.muted=!1),_typeof(i.controls)!==e&&(i.controls=!0),_typeof(i.fluid)!==e&&(i.fluid=!(i.width||i.height)),i.src&&(o=!1,i.sources.map(function(e){e.src==i.src&&(o=!0)}),o||i.sources.push({src:i.src,poster:i.poster,type:i.type}));e="";i.objectFit&&(e="object-fit: "+i.objectFit),a.$video.addClass("video-js").attr({style:e,"x-webkit-airplay":"allow","webkit-playsinlin":"true","x5-playsinline":"true",playsinline:"true"}),a.api=c(a.$video[0],l.extend({src:i.src,controls:i.controls,poster:i.poster,preload:i.preload,autoplay:i.autoplay,loop:i.loop,fluid:i.fluid,muted:i.muted,sources:i.sources,width:i.width,height:i.height,aspectRatio:i.aspectRatio,playbackRates:i.playbackRates},i.options||{}),function(){i.autoplay&&setTimeout(function(){a.api.play()})}),a.api.on(f,function(e){var t=e.type;"play"===t?a.playing=!0:"pause"===t&&(a.playing=!1);e=Array.prototype.slice.call(arguments);e.shift(),e.unshift(a.api),d.execCallback(a,i[d.camel("on_"+t)],a.element,e,n,u(t,p))}),d.triggerPluginReady(n,a,"",s.e.videoInitialized)},getApi:function(){return this.api},isPlaying:function(){return this.playing},destroy:function(){var e=this,t=e.api;t&&(t.isInPictureInPicture()&&t.exitPictureInPicture(),e.playing&&t.pause(),t.isDisposed_||t.dispose(),e.api=null),e.playing=!1,e.isVideo&&(e.isVideo=!1,e.$element.removeClass("video-js")),e.$wrap.after(e.$element),e.$wrap.remove()}},t.KEY=e,t.DEFAULTS={src:"",type:"",autoplay:null,muted:null,controls:null,loop:null,preload:null,fluid:null,poster:"",objectFit:"",width:0,height:0,sources:[],aspectRatio:void 0,playbackRates:[.5,1,1.25,1.5,2],options:{},locale:"zh-CN"},l.fn.baVideo=a,l.fn.baVideo.Constructor=t,s.plugins.Video=t,s.autoInit(p,d.pluginAttrs(p),function(){a.call(this)}),t}),define("./ba/plug/vue",["busyAdmin","jquery"],function(e,o){var s=e.helper,l=e.e,t=e.ee,n="vue",a=s.pluginKey(n),c="data,watch,computed,template,methods,beforeCreate,created,beforeMount,mounted,beforeUpdate,updated,activated,deactivated,beforeDestroy,destroyed,errorCaptured,directives,filters,components,mixins,parent,extends,provide,inject".split(","),d="methods,computed,template,directives,filters,components,parent,mixins,provide".split(",");l.vueInitialized=t("initialized",n);var u=function e(t,a){var i=this;i.element=t;i.$element=o(t);i.options=o.extend(true,{},e.DEFAULTS,i.$element.baData(n)||{},a||{});e.ready(o.proxy(i._init,i))};function i(e){return s.pluginFn(this,u,e,arguments,"api")}return u.prototype={_init:function(){var e=this,a=e.options,t=e.$element,i=e.element,n={};c.forEach(function(e){var t=s.scope(a[e]);o.baIsEmpty(t)||(-1<d.indexOf(e)&&"function"==typeof t&&(t=t()),n[e]=t)}),n.el=i,n.data=n.data||{};var r=n.mounted;n.mounted=function(){e.$element=o(this.$el).data(u.KEY,e),e.element=this.$el;try{"function"==typeof r&&r.call(this)}catch(e){console.error(e)}s.triggerPluginReady(t,e,"",l.vueInitialized)},e.vueOptions=n,e.api=new u.Vue(n)},getApi:function(){return this.api},destroy:function(){this.api&&this.api.$destroy()}},u.Vue=null,u.ready=function(t){window._BaVue&&(u.Vue=window._BaVue),u.Vue?t():e.require([e.lib.vue],function(e){u.Vue=e,t()})},u.KEY=a,u.DEFAULTS={data:{},element:!0},o.fn.baVue=i,o.fn.baVue.Constructor=u,e.plugins.Vue=u,e.autoInit("vue",s.pluginAttrs("vue"),function(){this.each(function(){this.__vue__||i.call(o(this))})}),u}),define("./ba/plug/appWatermark",["busyAdmin","jquery"],function(n,i){var r,o,e=n.helper,s=e.int,l=e.float,a=function e(){return n.getConfig("watermark",{})},c=function e(){var t=this;t.options=a();t.ready(t.init)};function t(e){e=e||{};var t=n.app;if(t.isLogin()&&e.status){if(!t.watermark)t.watermark=new c;t.watermark.ready(function(){this.create(e)})}else if(t.watermark)t.watermark.ready(function(){this.cancel()})}c.prototype={ready:function e(a){var i=this;if(r&&o)a.call(i);else requirejs([n.lib.gwm,n.lib.moment],function(e,t){r=e;o=t;a.call(i)})},init:function e(){},create:function e(t){var a=i.extend({},this.options,t||{});a.txt=(a.txt||"").replace(/\{username\}/g,n.app.getUsername());a.txt=a.txt.replace(/\{time\}/g,o().format(a.timeFormat||"YYYY-MM-DD HH:ii:ss"));r.creation({mode:"svg",watch:true,fontSize:a.fontSize,color:a.color,font:a.font||"sans-serif",alpha:l(a.alpha||0),angle:s(a.angle||0),imageWidth:s(a.imageWidth||0),imageHeight:s(a.imageHeight||0),imageX:s(a.imageX||0),imageY:s(a.imageY||0),image:a.image||"",width:s(a.width||0),height:s(a.height||0),x:s(a.x||0),y:s(a.y||0),txt:a.txt})},cancel:function e(){r.cancel()}},c.create=t,n.plugins.AppWatermark=c,i(document).on(n.e.appReadies,function(){t(a())}).on(n.e.appReqSuccess,function(){t(a())})});